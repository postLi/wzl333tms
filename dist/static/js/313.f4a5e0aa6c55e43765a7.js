webpackJsonp([313],{"/v6R":function(e,t,r){"use strict";var i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("pop-right",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"addTruckPop",attrs:{title:t.popTitle,isShow:t.popVisible},on:{close:t.closeMe}},[r("template",{staticClass:"addTruckPop-content",slot:"content"},[r("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-width":t.formLabelWidth,inline:!0,"label-position":"right",size:"mini"}},[r("el-form-item",{attrs:{label:"车牌号码",prop:"truckIdNumber"}},[r("el-input",{attrs:{maxlength:8,"auto-complete":"off"},model:{value:t.form.truckIdNumber,callback:function(e){t.$set(t.form,"truckIdNumber",e)},expression:"form.truckIdNumber"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆来源",prop:"truckSource"}},[r("SelectType",{attrs:{type:"truck_source",placeholder:"请选择"},model:{value:t.form.truckSource,callback:function(e){t.$set(t.form,"truckSource",e)},expression:"form.truckSource"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车型",prop:"truckType"}},[r("SelectType",{attrs:{type:"truck_type",placeholder:"请选择"},model:{value:t.form.truckType,callback:function(e){t.$set(t.form,"truckType",e)},expression:"form.truckType"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"可载重",prop:"truckLoad"}},[r("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{maxlength:6,"auto-complete":"off"},model:{value:t.form.truckLoad,callback:function(e){t.$set(t.form,"truckLoad",t._n(e))},expression:"form.truckLoad"}},[r("template",{slot:"append"},[t._v("千克")])],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"可载体积",prop:"truckVolume"}},[r("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{maxlength:18,"auto-complete":"off"},model:{value:t.form.truckVolume,callback:function(e){t.$set(t.form,"truckVolume",t._n(e))},expression:"form.truckVolume"}},[r("template",{slot:"append"},[t._v("方")])],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"车长",prop:"truckLength"}},[r("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{maxlength:18,"auto-complete":"off"},model:{value:t.form.truckLength,callback:function(e){t.$set(t.form,"truckLength",t._n(e))},expression:"form.truckLength"}},[r("template",{slot:"append"},[t._v("米")])],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"车宽",prop:"truckWidth"}},[r("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{maxlength:20,"auto-complete":"off"},model:{value:t.form.truckWidth,callback:function(e){t.$set(t.form,"truckWidth",t._n(e))},expression:"form.truckWidth"}},[r("template",{slot:"append"},[t._v("米")])],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"车高",prop:"truckHeight"}},[r("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{maxlength:20,"auto-complete":"off"},model:{value:t.form.truckHeight,callback:function(e){t.$set(t.form,"truckHeight",t._n(e))},expression:"form.truckHeight"}},[r("template",{slot:"append"},[t._v("米")])],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"归属网点",prop:"orgid"}},[r("SelectTree",{attrs:{orgid:t.otherinfo.orgid},on:{change:t.getTreeOrgid},model:{value:t.form.orgid,callback:function(e){t.$set(t.form,"orgid",e)},expression:"form.orgid"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆品牌",prop:"truckBrand"}},[r("el-input",{attrs:{maxlength:20,"auto-complete":"off"},model:{value:t.form.truckBrand,callback:function(e){t.$set(t.form,"truckBrand",e)},expression:"form.truckBrand"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆注册时间",prop:"truckRegisterDate"}},[r("el-date-picker",{attrs:{align:"right",type:"date","picker-options":t.pickOption,placeholder:"选择日期","value-format":"timestamp"},model:{value:t.form.truckRegisterDate,callback:function(e){t.$set(t.form,"truckRegisterDate",e)},expression:"form.truckRegisterDate"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆报废时间",prop:"truckScrapDate"}},[r("el-date-picker",{attrs:{align:"right",type:"date","picker-options":t.pickOption2,placeholder:"选择日期","value-format":"timestamp"},model:{value:t.form.truckScrapDate,callback:function(e){t.$set(t.form,"truckScrapDate",e)},expression:"form.truckScrapDate"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车架号",prop:"frameNum"}},[r("el-input",{attrs:{maxlength:30,"auto-complete":"off"},model:{value:t.form.frameNum,callback:function(e){t.$set(t.form,"frameNum",e)},expression:"form.frameNum"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"发动机号",prop:"engineNum"}},[r("el-input",{attrs:{maxlength:30,"auto-complete":"off"},model:{value:t.form.engineNum,callback:function(e){t.$set(t.form,"engineNum",e)},expression:"form.engineNum"}})],1),t._v(" "),r("el-form-item",{staticClass:"truckRemarks",attrs:{label:"备注",prop:"truckRemarks"}},[r("el-input",{attrs:{type:"textarea",maxlength:300},model:{value:t.form.truckRemarks,callback:function(e){t.$set(t.form,"truckRemarks",e)},expression:"form.truckRemarks"}})],1),t._v(" "),r("div",{staticClass:"hr"}),t._v(" "),r("el-form-item",{attrs:{label:"车辆单位",prop:"truckUnit"}},[r("el-input",{attrs:{maxlength:20,"auto-complete":"off"},model:{value:t.form.truckUnit,callback:function(e){t.$set(t.form,"truckUnit",e)},expression:"form.truckUnit"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"单位电话",prop:"truckUnitMobile"}},[r("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{maxlength:20,"auto-complete":"off"},model:{value:t.form.truckUnitMobile,callback:function(e){t.$set(t.form,"truckUnitMobile",e)},expression:"form.truckUnitMobile"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"司机",prop:"driverId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择司机",clearable:""},on:{change:t.getDriverPhone},model:{value:t.form.driverId,callback:function(e){t.$set(t.form,"driverId",e)},expression:"form.driverId"}},t._l(t.DriverList,function(e){return r("el-option",{key:e.id,attrs:{label:e.driverName,value:e.id}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"司机电话",prop:"dirverMobile"}},[r("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{maxlength:20,"auto-complete":"off",disabled:""},model:{value:t.form.dirverMobile,callback:function(e){t.$set(t.form,"dirverMobile",e)},expression:"form.dirverMobile"}})],1),t._v(" "),r("div",{staticClass:"hr"}),t._v(" "),r("el-form-item",{staticClass:"clearfix uploadcard"},[r("div",{staticClass:"idcard"},[r("upload",{attrs:{title:"行驶证"},model:{value:t.form.drivingLicense,callback:function(e){t.$set(t.form,"drivingLicense",e)},expression:"form.drivingLicense"}})],1),t._v(" "),r("div",{staticClass:"drviercard"},[r("upload",{attrs:{title:"营运执照"},model:{value:t.form.operatingLicense,callback:function(e){t.$set(t.form,"operatingLicense",e)},expression:"form.operatingLicense"}})],1),t._v(" "),r("div",{staticClass:"certcard"},[r("upload",{attrs:{title:"车辆照片"},model:{value:t.form.vehiclePic,callback:function(e){t.$set(t.form,"vehiclePic",e)},expression:"form.vehiclePic"}})],1)])],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.isModify?t._e():r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm",!0)}}},[t._v("保存并添加")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保 存")]),t._v(" "),r("el-button",{on:{click:t.closeMe}},[t._v("取 消")])],1)],2)},staticRenderFns:[]};t.a=i},"5F+j":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("voDd"),o=r("/v6R");var a=function(e){r("sNUZ")},n=r("VU/8")(i.a,o.a,a,null,null);t.default=n.exports},sNUZ:function(e,t){},voDd:function(e,t,r){"use strict";var i=r("woOf"),o=r.n(i),a=r("Dd8w"),n=r.n(a),l=r("E4LH"),s=r("QBRH"),c=r("9ani"),u=r("P5Di"),m=r("QbVN"),f=r("o9X6"),p=r("NYxO"),d=r("9UCZ");t.a={components:{popRight:u.a,Upload:m.a,SelectTree:f.a,SelectType:d.a},props:{popVisible:{type:Boolean,default:!1},orgid:{required:!0},isModify:{type:Boolean,default:!1},info:{type:Object,default:function(){}},truckTypes:{type:Array,default:function(){return[]}},truckSources:{type:Array,default:function(){return[]}}},computed:n()({},Object(p.mapGetters)(["otherinfo"])),data:function(){var t=this,e=function(i,o){return function(e,t,r){i<t?r(new Error(o)):r()}};return{form:{dirverMobile:"",driverId:"",orgid:"",truckBrand:"",truckHeight:"",truckIdNumber:"",truckLength:"",truckLoad:"",truckRegisterDate:"",truckRemarks:"",truckScrapDate:"",truckSource:"",truckType:"",truckUnit:"",truckUnitMobile:"",truckVolume:"",truckWidth:"",drivingLicense:"",operatingLicense:"",vehiclePic:"",frameNum:"",engineNum:""},formLabelWidth:"100px",tooltip:!1,rules:{truckIdNumber:[{required:!0,message:"请输入车牌号码",trigger:"blur"}],orgid:[{required:!0,message:"请选择所属机构"}],driverMobile:[{message:"请输入手机号码",trigger:"blur",pattern:l.a.MOBILE}],truckLoad:[{validator:e(1e5,"不能超过100000千克"),type:"number"}],truckVolume:[{validator:e(1e3,"体积不能超过1000方"),type:"number"}],truckLength:[{validator:e(100,"车长不能超过100米"),type:"number"}],truckHeight:[{validator:e(20,"车高不能超过20米"),type:"number"}],truckWidth:[{validator:e(10,"车宽不能超过10米"),type:"number"}]},popTitle:"新增车辆",orgArr:[],rolesArr:[],departmentArr:[],loading:!1,roles:[],departments:[],groups:[],inited:!1,cacheDriverList:{},DriverList:[],pickOption:{firstDayOfWeek:1,disabledDate:function(e){return!!t.form.truckScrapDate&&e.getTime()>t.form.truckScrapDate}},pickOption2:{firstDayOfWeek:1,disabledDate:function(e){return!!t.form.truckRegisterDate&&e.getTime()<t.form.truckRegisterDate}}}},mounted:function(){this.form.orgid=this.otherinfo.orgid,this.inited||(this.inited=!0,this.initInfo(),this.getDriverPhone()),this.isModify&&this.initPanel()},watch:{popVisible:function(e,t){this.inited||(this.inited=!0,this.initInfo(),this.getDriverPhone())},orgid:function(e,t){this.form.orgid=e},info:{handler:function(){this.initPanel()},deep:!0}},activated:function(){this.initDriverList()},methods:{initDriverList:function(){this.DriverList=this.$options.data().DriverList,this.cacheDriverList=[],this.getTreeOrgid(this.orgid)},getDriverPhone:function(t){var e=this.DriverList.filter(function(e){return e.id===t});e[0]&&(this.form.dirverMobile=e[0].driverMobile)},initPanel:function(){if(this.isModify){this.popTitle="修改车辆";var e=o()({},this.info);for(var t in this.form)this.form[t]=e[t];this.form.truckRegisterDate&&(this.form.truckRegisterDate=+new Date(this.form.truckRegisterDate)),this.form.truckScrapDate&&(this.form.truckScrapDate=+new Date(this.form.truckScrapDate)),this.form.truckId=e.truckId}else{for(var r in this.popTitle="新增车辆",this.form)this.form[r]=(this.form[r],"");delete this.form.truckId,this.form.orgid=this.orgid,this.form.truckSource=143}},getTreeOrgid:function(e){this.getDriverList(e)},initInfo:function(){this.loading=!1,this.getTreeOrgid(this.orgid)},getOrgid:function(e){this.form.orgid=e},submitForm:function(e,r){var i=this;this.$refs[e].validate(function(e){if(!e)return!1;i.loading=!0;var t=o()({},i.form);(i.isModify?Object(s.f)(t):Object(s.e)(t)).then(function(e){i.loading=!1,i.$message.success("保存成功"),i.reset(),r||i.closeMe(),i.$emit("success")}).catch(function(e){i._handlerCatchMsg(e),i.loading=!1})})},reset:function(){var e=this.form.orgid;this.$refs.ruleForm.resetFields(),this.form.orgid=e,this.form.drivingLicense="",this.form.operatingLicense="",this.form.vehiclePic=""},closeMe:function(e){this.reset(),this.$emit("update:popVisible",!1),"function"==typeof e&&e()},getDriverList:function(t){var r=this;this.cacheDriverList[t]?this.DriverList=this.cacheDriverList[t]:(this.loading=!0,Object(c.b)({currentPage:1,pageSize:200,vo:{orgid:t}}).then(function(e){r.DriverList=e.list,r.cacheDriverList[t]=e.list,r.loading=!1}).catch(function(e){r.loading=!1,r._handlerCatchMsg(e)}))}}}}});