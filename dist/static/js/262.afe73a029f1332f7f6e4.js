webpackJsonp([262],{"4gcN":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("a43a"),s=t("TyQf");var o=function(e){t("r2Kh")},a=t("VU/8")(i.a,s.a,o,null,null);r.default=a.exports},TyQf:function(e,r,t){"use strict";var i={render:function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],staticClass:"createOrder-main",class:{"creatBatch-main":i.output.isbatch}},[i.output.isbatch?s("div",{staticClass:"batchlist"},i._l(i.output.ordernum,function(r){return s("span",{key:r,staticClass:"batchNum",class:{on:r===i.currentBatch},on:{click:function(e){i.changeBatch(r)}}},[i._v("第"+i._s(r)+"票")])})):i._e(),i._v(" "),s("div",{staticClass:"createOrderWrapper"},[i._m(0),i._v(" "),s("el-form",{ref:"ruleForm",attrs:{model:i.form,"label-width":"100px",rules:i.rules2,"show-message":!1,"status-icon":"",inline:"","label-position":"right",size:"mini"}},[s("div",{staticClass:"createOrder-info clearfix"},[s("div",{staticClass:"order-num required"},[i._v("运单号： "),s("span",{staticClass:"order-num-info"},[s("el-form-item",{attrs:{prop:"tmsOrderShip.shipSn"}},[s("el-input",{directives:[{name:"onlyNumberAndLetter",rawName:"v-onlyNumberAndLetter"}],ref:"tmsOrderShipshipSn",attrs:{size:"mini",maxlength:20,disabled:!i.canChangeOrderNum},model:{value:i.form.tmsOrderShip.shipSn,callback:function(e){i.$set(i.form.tmsOrderShip,"shipSn",e)},expression:"form.tmsOrderShip.shipSn"}})],1)],1)]),i._v(" "),s("div",{staticClass:"create-num required"},[i._v("开单日期： "),s("span",{staticClass:"create-num-info"},[i.nowTime?s("el-date-picker",{attrs:{type:"date",clearable:!1,"value-format":"yyyy-MM-dd hh:mm:ss",disabled:!i.canChangeOrderDate,"picker-options":i.pickoption,size:"mini",placeholder:"选择日期"},model:{value:i.form.tmsOrderShip.createTime,callback:function(e){i.$set(i.form.tmsOrderShip,"createTime",e)},expression:"form.tmsOrderShip.createTime"}}):i._e()],1)])]),i._v(" "),s("div",{staticClass:"order-main"},[s("el-row",{staticClass:"firstline-order"},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item showFormInfo"},[s("span",{staticClass:"order-form-label"},[i._v("开单网点")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipFromOrgid"}},[s("SelectTree",{attrs:{disabled:"",filterable:!1,size:"mini"},model:{value:i.form.tmsOrderShip.shipFromOrgid,callback:function(e){i.$set(i.form.tmsOrderShip,"shipFromOrgid",e)},expression:"form.tmsOrderShip.shipFromOrgid"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipFromCityName}},[i._v("出发城市")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipFromCityName"}},[s("querySelect",{attrs:{show:"select",filterable:"",search:"longAddr",name:i.fromCityName,valuekey:"longAddr",type:"fromcity",remote:!0},on:{change:i.selectFromCity},nativeOn:{keydown:function(e){return"button"in e||!i._k(e.keyCode,"enter",13,e.key,"Enter")?i.goNextInput(e):null}},model:{value:i.form.tmsOrderShip.shipFromCityName,callback:function(e){i.$set(i.form.tmsOrderShip,"shipFromCityName",e)},expression:"form.tmsOrderShip.shipFromCityName"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label required"},[i._v("到达城市")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipToCityName"}},[s("querySelect",{ref:"tmsOrderShipshipToCityName",attrs:{show:"select",filterable:"",search:"longAddr",valuekey:"longAddr",type:"tocity",remote:!0},on:{change:i.selectToCity},nativeOn:{keydown:function(e){return"button"in e||!i._k(e.keyCode,"enter",13,e.key,"Enter")?i.goNextInput(e):null}},model:{value:i.form.tmsOrderShip.shipToCityName,callback:function(e){i.$set(i.form.tmsOrderShip,"shipToCityName",e)},expression:"form.tmsOrderShip.shipToCityName"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipToOrgid}},[i._v("目的网点")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipToOrgid"}},[s("SelectTree",{attrs:{size:"mini"},nativeOn:{keydown:function(e){return"button"in e||!i._k(e.keyCode,"enter",13,e.key,"Enter")?i.goNextInput(e):null}},model:{value:i.form.tmsOrderShip.shipToOrgid,callback:function(e){i.$set(i.form.tmsOrderShip,"shipToOrgid",e)},expression:"form.tmsOrderShip.shipToOrgid"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("交接方式")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipDeliveryMethod"}},[s("SelectType",{attrs:{size:"mini",type:"ship_delivery_method"},nativeOn:{keydown:function(e){return"button"in e||!i._k(e.keyCode,"enter",13,e.key,"Enter")?i.goNextInput(e):null}},model:{value:i.form.tmsOrderShip.shipDeliveryMethod,callback:function(e){i.$set(i.form.tmsOrderShip,"shipDeliveryMethod",e)},expression:"form.tmsOrderShip.shipDeliveryMethod"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item showFormInfo"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipGoodsSn}},[i._v("货号")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipGoodsSn"}},[s("el-input",{directives:[{name:"onlyNumberAndLetter",rawName:"v-onlyNumberAndLetter"}],attrs:{size:"mini",maxlength:20,disabled:!i.canChangeCargoNum},model:{value:i.form.tmsOrderShip.shipGoodsSn,callback:function(e){i.$set(i.form.tmsOrderShip,"shipGoodsSn",e)},expression:"form.tmsOrderShip.shipGoodsSn"}})],1)],1)])],1),i._v(" "),s("div",{staticClass:"customer-form clearfix"},[s("div",{staticClass:"sender-form"},[s("div",{staticClass:"form-title"},[i._v("\n          发货方\n        ")]),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("发货单位")]),i._v(" "),s("el-form-item",{attrs:{prop:"sender.customerUnit"}},[s("querySelect",{attrs:{search:"customerUnit",type:"sender",valuekey:"customerUnit"},on:{change:i.setSender},model:{value:i.form.sender.customerUnit,callback:function(e){i.$set(i.form.sender,"customerUnit",e)},expression:"form.sender.customerUnit"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label ",class:{required:i.shipFieldValue.shipSenderId}},[i._v("发 货 人")]),i._v(" "),s("el-form-item",{attrs:{prop:"sender.customerName"}},[s("querySelect",{attrs:{suffix:"el-icon-search",search:"customerName",type:"sender",valuekey:"customerName"},on:{change:i.setSender},model:{value:i.form.sender.customerName,callback:function(e){i.$set(i.form.sender,"customerName",e)},expression:"form.sender.customerName"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label ",class:{required:i.shipFieldValue.shipSenderId}},[i._v("联系电话")]),i._v(" "),s("el-form-item",{attrs:{prop:"sender.customerMobile"}},[s("querySelect",{attrs:{search:"customerMobile",type:"sender",valuekey:"customerMobile"},on:{change:i.setSender},model:{value:i.form.sender.customerMobile,callback:function(e){i.$set(i.form.sender,"customerMobile",e)},expression:"form.sender.customerMobile"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipSenderAddress}},[i._v("发货地址")]),i._v(" "),s("el-form-item",{attrs:{prop:"sender.detailedAddress"}},[s("querySelect",{attrs:{search:"detailedAddress",type:"sender",valuekey:"detailedAddress"},on:{change:i.setSender},model:{value:i.form.sender.detailedAddress,callback:function(e){i.$set(i.form.sender,"detailedAddress",e)},expression:"form.sender.detailedAddress"}})],1)],1)]),i._v(" "),s("div",{staticClass:"receiver-form"},[s("div",{staticClass:"form-title"},[i._v("\n          收货方\n        ")]),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("收货单位")]),i._v(" "),s("el-form-item",{attrs:{prop:"receiver.customerUnit"}},[s("querySelect",{attrs:{search:"customerUnit",type:"receiver",valuekey:"customerUnit"},on:{change:i.setReceiver},model:{value:i.form.receiver.customerUnit,callback:function(e){i.$set(i.form.receiver,"customerUnit",e)},expression:"form.receiver.customerUnit"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipReceiverId}},[i._v("收 货 人")]),i._v(" "),s("el-form-item",{attrs:{prop:"receiver.customerName"}},[s("querySelect",{attrs:{suffix:"el-icon-search",search:"customerName",type:"receiver",valuekey:"customerName"},on:{change:i.setReceiver},model:{value:i.form.receiver.customerName,callback:function(e){i.$set(i.form.receiver,"customerName",e)},expression:"form.receiver.customerName"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipReceiverId}},[i._v("联系电话")]),i._v(" "),s("el-form-item",{attrs:{prop:"receiver.customerMobile"}},[s("querySelect",{attrs:{search:"customerMobile",type:"receiver",valuekey:"customerMobile"},on:{change:i.setReceiver},model:{value:i.form.receiver.customerMobile,callback:function(e){i.$set(i.form.receiver,"customerMobile",e)},expression:"form.receiver.customerMobile"}})],1)],1),i._v(" "),s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipReceiverAddress}},[i._v("收货地址")]),i._v(" "),s("el-form-item",{attrs:{prop:"receiver.detailedAddress"}},[s("querySelect",{attrs:{search:"detailedAddress",type:"receiver",valuekey:"detailedAddress"},on:{change:i.setReceiver},model:{value:i.form.receiver.detailedAddress,callback:function(e){i.$set(i.form.receiver,"detailedAddress",e)},expression:"form.receiver.detailedAddress"}})],1)],1)])]),i._v(" "),s("div",{staticClass:"order-cargo-form"},[s("el-table",{key:i.cargoKey,ref:"cargoListTable",staticStyle:{width:"100%"},attrs:{data:i.form.cargoList,border:"","tooltip-effect":"dark",triped:"",width:"100%"}},[s("el-table-column",{staticClass:"addButtonTh",attrs:{fixed:"","render-header":i.setHeader,width:"50"},scopedSlots:i._u([{key:"default",fn:function(r){return[0!==r.$index?s("span",{staticClass:"minusButton",on:{click:function(e){i.deleteCargoList(r.$index)}}},[s("i",{staticClass:"el-icon-minus"})]):i._e()]}}])}),i._v(" "),i._l(i.theFeeConfig,function(t,e){return s("el-table-column",{key:e,attrs:{width:-1!==t.fieldProperty.indexOf("cargoName")?120:"auto","label-class-name":i.shipFieldValue[t.fieldProperty]||/(cargoName|cargoAmount|cargoWeight|cargoVolume)/.test(t.fieldProperty)?"required":"",label:t.fieldName},scopedSlots:i._u([{key:"default",fn:function(r){return[-1!==t.fieldProperty.indexOf("cargoName")?[s("el-form-item",{attrs:{prop:"cargoList."+r.$index+".cargoName",rules:{validator:0===r.$index?i.validateIsEmpty2(t.fieldProperty,r.$index,"货品名不能为空！"):""}}},[s("querySelect",{attrs:{getinput:"",size:"mini",search:"value",type:"cargoName",valuekey:"value"},model:{value:i.form.cargoList[r.$index].cargoName,callback:function(e){i.$set(i.form.cargoList[r.$index],"cargoName",e)},expression:"form.cargoList[scope.$index].cargoName"}})],1)]:-1!==t.fieldProperty.indexOf("cargoPack")?[s("querySelect",{attrs:{size:"mini",search:"value",type:"cargoPack",valuekey:"value"},model:{value:i.form.cargoList[r.$index].cargoPack,callback:function(e){i.$set(i.form.cargoList[r.$index],"cargoPack",e)},expression:"form.cargoList[scope.$index].cargoPack"}})]:-1!==t.fieldProperty.indexOf("cargoAmount")?[s("el-form-item",{attrs:{prop:"cargoList."+r.$index+".cargoAmount",rules:{validator:0===r.$index?i.validateIsEmptyOr0(t.fieldProperty,r.$index,"货品件数不能小于0！"):"",trigger:"blur"}}},[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only"}],attrs:{size:"mini",maxlength:20},on:{change:i.detectCargoNumChange},model:{value:i.form.cargoList[r.$index].cargoAmount,callback:function(e){i.$set(i.form.cargoList[r.$index],"cargoAmount",e)},expression:"form.cargoList[scope.$index].cargoAmount"}})],1)]:-1!==t.fieldProperty.indexOf("shipFee")?[s("el-form-item",{attrs:{prop:"cargoList."+r.$index+".shipFee"}},[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{size:"mini",maxlength:20},on:{change:function(e){return i.changeFee(r.$index,t.fieldProperty,e)}},model:{value:i.form.cargoList[r.$index].shipFee,callback:function(e){i.$set(i.form.cargoList[r.$index],"shipFee",e)},expression:"form.cargoList[scope.$index].shipFee"}})],1)]:/(cargoWeight|cargoVolume)/.test(t.fieldProperty)?[s("el-form-item",{attrs:{prop:"cargoList."+r.$index+"."+t.fieldProperty,rules:{validator:0===r.$index?i.validateWeightAndVolume(t.fieldProperty,r.$index):"",trigger:"blur"}}},[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{size:"mini",maxlength:20},model:{value:i.form.cargoList[r.$index][t.fieldProperty],callback:function(e){i.$set(i.form.cargoList[r.$index],t.fieldProperty,e)},expression:"form.cargoList[scope.$index][item.fieldProperty]"}})],1)]:/(fee|price|agency|tax)/i.test(t.fieldProperty)?[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{size:"mini",maxlength:20,value:i.form.cargoList[r.$index][t.fieldProperty]},on:{change:function(e){return i.changeFee(r.$index,t.fieldProperty,e)}}})]:[s("el-input",{attrs:{size:"mini",maxlength:20,value:i.form.cargoList[r.$index][t.fieldProperty]},on:{change:function(e){return i.changeFee(r.$index,t.fieldProperty,e)}}})]]}}])})})],2)],1),i._v(" "),s("div",{staticClass:"order-other-form clearfix"},[s("el-row",{staticClass:"firstline-order-other"},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("运费合计")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipTotalFee"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:""},model:{value:i.form.tmsOrderShip.shipTotalFee,callback:function(e){i.$set(i.form.tmsOrderShip,"shipTotalFee",e)},expression:"form.tmsOrderShip.shipTotalFee"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("付款方式")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipPayWay"}},[s("SelectType",{attrs:{size:"mini",type:"ship_pay_way"},model:{value:i.form.tmsOrderShip.shipPayWay,callback:function(e){i.$set(i.form.tmsOrderShip,"shipPayWay",e)},expression:"form.tmsOrderShip.shipPayWay"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("现付")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipNowpayFee"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:i.shipNowpayFeeDisabled},on:{blur:i.formatShipFee,focus:function(e){i.setOtherFee("shipNowpayFee")}},model:{value:i.form.tmsOrderShip.shipNowpayFee,callback:function(e){i.$set(i.form.tmsOrderShip,"shipNowpayFee",e)},expression:"form.tmsOrderShip.shipNowpayFee"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("到付")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipArrivepayFee"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:i.shipArrivepayFeeDisabled},on:{blur:i.formatShipFee,focus:function(e){i.setOtherFee("shipArrivepayFee")}},model:{value:i.form.tmsOrderShip.shipArrivepayFee,callback:function(e){i.$set(i.form.tmsOrderShip,"shipArrivepayFee",e)},expression:"form.tmsOrderShip.shipArrivepayFee"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("回单付")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipReceiptpayFee"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:i.shipReceiptpayFeeDisabled},on:{blur:i.formatShipFee,focus:function(e){i.setOtherFee("shipReceiptpayFee")}},model:{value:i.form.tmsOrderShip.shipReceiptpayFee,callback:function(e){i.$set(i.form.tmsOrderShip,"shipReceiptpayFee",e)},expression:"form.tmsOrderShip.shipReceiptpayFee"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("月结")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipMonthpayFee"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:i.shipMonthpayFeeDisabled},on:{blur:i.formatShipFee,focus:function(e){i.setOtherFee("shipMonthpayFee")}},model:{value:i.form.tmsOrderShip.shipMonthpayFee,callback:function(e){i.$set(i.form.tmsOrderShip,"shipMonthpayFee",e)},expression:"form.tmsOrderShip.shipMonthpayFee"}})],1)],1)])],1),i._v(" "),s("el-row",{staticClass:"second-order-other"},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("回单类型")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipReceiptRequire"}},[s("SelectType",{attrs:{size:"mini",type:"ship_receipt_require"},model:{value:i.form.tmsOrderShip.shipReceiptRequire,callback:function(e){i.$set(i.form.tmsOrderShip,"shipReceiptRequire",e)},expression:"form.tmsOrderShip.shipReceiptRequire"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label other-form-shipReceiptNum"},[s("el-form-item",{attrs:{prop:"tmsOrderShip.shipReceiptNum"}},[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only"}],attrs:{size:"mini",maxlength:3},model:{value:i.form.tmsOrderShip.shipReceiptNum,callback:function(e){i.$set(i.form.tmsOrderShip,"shipReceiptNum",e)},expression:"form.tmsOrderShip.shipReceiptNum"}},[s("template",{slot:"append"},[i._v("份")])],2)],1)],1),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipReceiptSn"}},[s("el-input",{directives:[{name:"onlyNumberAndLetter",rawName:"v-onlyNumberAndLetter"}],attrs:{size:"mini",maxlength:20,placeholder:"回单号"},model:{value:i.form.tmsOrderShip.shipReceiptSn,callback:function(e){i.$set(i.form.tmsOrderShip,"shipReceiptSn",e)},expression:"form.tmsOrderShip.shipReceiptSn"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("打印标签")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipPrintLib"}},[s("el-input",{directives:[{name:"number-only",rawName:"v-number-only"}],attrs:{size:"mini",maxlength:3},model:{value:i.form.tmsOrderShip.shipPrintLib,callback:function(e){i.$set(i.form.tmsOrderShip,"shipPrintLib",e)},expression:"form.tmsOrderShip.shipPrintLib"}},[s("template",{slot:"append"},[i._v("份")])],2)],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label ",class:{required:i.shipFieldValue.shipCustomerNumber}},[i._v("客户单号")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipCustomerNumber"}},[s("el-input",{directives:[{name:"onlyNumberAndLetter",rawName:"v-onlyNumberAndLetter"}],attrs:{size:"mini",maxlength:20},model:{value:i.form.tmsOrderShip.shipCustomerNumber,callback:function(e){i.$set(i.form.tmsOrderShip,"shipCustomerNumber",e)},expression:"form.tmsOrderShip.shipCustomerNumber"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("运输方式")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipShippingType"}},[s("SelectType",{attrs:{size:"mini",type:"ship_shipping_type"},model:{value:i.form.tmsOrderShip.shipShippingType,callback:function(e){i.$set(i.form.tmsOrderShip,"shipShippingType",e)},expression:"form.tmsOrderShip.shipShippingType"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("业务类型")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipBusinessType"}},[s("SelectType",{attrs:{size:"mini",type:"ship_business_type"},model:{value:i.form.tmsOrderShip.shipBusinessType,callback:function(e){i.$set(i.form.tmsOrderShip,"shipBusinessType",e)},expression:"form.tmsOrderShip.shipBusinessType"}})],1)],1)])],1),i._v(" "),s("el-row",{staticClass:"third-order-other"},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("时效")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipEffective"}},[s("SelectType",{attrs:{size:"mini",type:"ship_effective"},model:{value:i.form.tmsOrderShip.shipEffective,callback:function(e){i.$set(i.form.tmsOrderShip,"shipEffective",e)},expression:"form.tmsOrderShip.shipEffective"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("提货批次")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipBatchId"}},[s("querySelect",{key:"batchid",attrs:{size:"mini",search:"batchNumber",placeholder:"请选择",type:"batch",show:"select",valuekey:"bathId"},on:{change:i.getBatch},model:{value:i.form.tmsOrderShip.shipBatchId,callback:function(e){i.$set(i.form.tmsOrderShip,"shipBatchId",e)},expression:"form.tmsOrderShip.shipBatchId"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("车牌号")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipTruckIdNumber"}},[s("el-input",{attrs:{size:"mini",maxlength:20,disabled:""},model:{value:i.form.tmsOrderShip.shipTruckIdNumber,callback:function(e){i.$set(i.form.tmsOrderShip,"shipTruckIdNumber",e)},expression:"form.tmsOrderShip.shipTruckIdNumber"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label",class:{required:i.shipFieldValue.shipUserid}},[i._v("业务员")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipUserid"}},[s("querySelect",{attrs:{show:"select",filterable:"",orgid:i.otherinfo.orgid,size:"mini",name:i.otherinfo.name,search:"name"},model:{value:i.form.tmsOrderShip.shipUserid,callback:function(e){i.$set(i.form.tmsOrderShip,"shipUserid",e)},expression:"form.tmsOrderShip.shipUserid"}})],1)],1)]),i._v(" "),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("其他")]),i._v(" "),s("el-checkbox-group",{model:{value:i.shipOther,callback:function(e){i.shipOther=e},expression:"shipOther"}},[s("el-checkbox",{attrs:{label:"168"}},[i._v("控货")]),i._v(" "),s("el-checkbox",{attrs:{label:"169"}},[i._v("贵重物品")]),i._v(" "),s("el-checkbox",{attrs:{label:"170"}},[i._v("现付尚欠")]),i._v(" "),s("el-checkbox",{attrs:{label:"171"}},[i._v("回扣已返")])],1)],1)])],1),i._v(" "),s("el-row",{staticClass:"fouth-order-other"},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"order-form-item"},[s("span",{staticClass:"order-form-label"},[i._v("备注")]),i._v(" "),s("el-form-item",{attrs:{prop:"tmsOrderShip.shipRemarks"}},[s("el-button",{staticClass:"remarks-btn",attrs:{size:"mini",icon:"el-icon-date",plain:""},on:{click:function(e){i.popVisible=!0}}},[i._v("常用备注")]),i._v(" "),s("querySelect",{attrs:{size:"mini",search:"value",type:"remark",valuekey:"value",maxlength:250},model:{value:i.form.tmsOrderShip.shipRemarks,callback:function(e){i.$set(i.form.tmsOrderShip,"shipRemarks",e)},expression:"form.tmsOrderShip.shipRemarks"}})],1)],1)])],1)],1),i._v(" "),i.shouldInputTransfer?s("div",{staticClass:"order-transfer-form"},[s("el-collapse",{model:{value:i.activeNames,callback:function(e){i.activeNames=e},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"中转信息",name:"1"}},[s("table",{staticClass:"order-transfer-table"},[s("thead",[s("tr",[s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转日期")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转单号")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("承运商")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("承运商电话")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转到站电话")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转费")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转送货费")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转其它费")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转费合计")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转付款方式")]),i._v(" "),s("th",{staticStyle:{"min-width":"100px"}},[i._v("中转备注")])])]),i._v(" "),s("tbody",[s("tr",[s("td",[i.nowTime?s("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd hh:mm:ss","picker-options":i.pickoption2,size:"mini",tabindex:"-1",placeholder:"选择日期"},model:{value:i.form.tmsOrderTransfer.transferTime,callback:function(e){i.$set(i.form.tmsOrderTransfer,"transferTime",e)},expression:"form.tmsOrderTransfer.transferTime"}}):i._e()],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"onlyNumberAndLetter",rawName:"v-onlyNumberAndLetter"}],attrs:{size:"mini",maxlength:20},on:{change:i.setOddNumbers},model:{value:i.form.tmsOrderTransfer.oddNumbers,callback:function(e){i.$set(i.form.tmsOrderTransfer,"oddNumbers",e)},expression:"form.tmsOrderTransfer.oddNumbers"}})],1),i._v(" "),s("td",[s("querySelect",{attrs:{size:"mini",search:"carrierName",type:"carrier",valuekey:"carrierId",filterable:!0,show:"select"},on:{change:i.getCarrier},model:{value:i.form.tmsOrderTransfer.carrierId,callback:function(e){i.$set(i.form.tmsOrderTransfer,"carrierId",e)},expression:"form.tmsOrderTransfer.carrierId"}})],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{size:"mini",maxlength:20},model:{value:i.form.tmsOrderTransfer.carrierMobile,callback:function(e){i.$set(i.form.tmsOrderTransfer,"carrierMobile",e)},expression:"form.tmsOrderTransfer.carrierMobile"}})],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{size:"mini",maxlength:13},model:{value:i.form.tmsOrderTransfer.arrivalMobile,callback:function(e){i.$set(i.form.tmsOrderTransfer,"arrivalMobile",e)},expression:"form.tmsOrderTransfer.arrivalMobile"}})],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],attrs:{size:"mini",maxlength:8},model:{value:i.form.tmsOrderTransfer.transferCharge,callback:function(e){i.$set(i.form.tmsOrderTransfer,"transferCharge",i._n(e))},expression:"form.tmsOrderTransfer.transferCharge"}})],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],attrs:{size:"mini",maxlength:8},model:{value:i.form.tmsOrderTransfer.deliveryExpense,callback:function(e){i.$set(i.form.tmsOrderTransfer,"deliveryExpense",i._n(e))},expression:"form.tmsOrderTransfer.deliveryExpense"}})],1),i._v(" "),s("td",[s("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],attrs:{size:"mini",maxlength:20},model:{value:i.form.tmsOrderTransfer.codService,callback:function(e){i.$set(i.form.tmsOrderTransfer,"codService",e)},expression:"form.tmsOrderTransfer.codService"}})],1),i._v(" "),s("td",[s("el-input",{attrs:{size:"mini",maxlength:8,disabled:""},model:{value:i.form.tmsOrderTransfer.totalCost,callback:function(e){i.$set(i.form.tmsOrderTransfer,"totalCost",e)},expression:"form.tmsOrderTransfer.totalCost"}})],1),i._v(" "),s("td",[s("SelectType",{attrs:{size:"mini",type:"payment_type"},model:{value:i.form.tmsOrderTransfer.paymentId,callback:function(e){i.$set(i.form.tmsOrderTransfer,"paymentId",e)},expression:"form.tmsOrderTransfer.paymentId"}})],1),i._v(" "),s("td",[s("el-input",{attrs:{size:"mini",maxlength:250},model:{value:i.form.tmsOrderTransfer.remark,callback:function(e){i.$set(i.form.tmsOrderTransfer,"remark",e)},expression:"form.tmsOrderTransfer.remark"}})],1)])])])])],1)],1):i._e()],1)]),i._v(" "),s("FooterBtns",{attrs:{isChange:i.changeFlag},on:{doAction:i.doAction,doCommand:i.handleCommand}}),i._v(" "),s("FeeDialog",{attrs:{dialogVisible:i.dialogVisible},on:{success:function(e){i.feeConfig=e},"update:dialogVisible":function(e){i.dialogVisible=e}}}),i._v(" "),s("PersonDialog",{attrs:{dialogVisiblePerson:i.dialogVisiblePerson},on:{success:i.getKeySetup,"update:dialogVisiblePerson":function(e){i.dialogVisiblePerson=e}}}),i._v(" "),s("ManageRemarks",{attrs:{popVisible:i.popVisible},on:{success:i.setRemark,"update:popVisible":function(e){i.popVisible=e}}})],1)])},staticRenderFns:[function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"createOrder-title"},[r("span",[this._v("收发货凭证")])])}]};r.a=i},a43a:function(e,r,t){"use strict";var i=t("woOf"),o=t.n(i),s=t("mvHQ"),m=t.n(s),a=t("//Fk"),n=t.n(a),h=t("O6e2"),d=t("E4LH"),p=t("0xDb"),c=t("t5DY"),l=t("i7Ou"),f=t("OHys"),u=t("NoOq"),v=t("9UCZ"),O=t("o9X6"),g=t("66wn"),S=t("pAQG"),y=t("Rc2O"),b=t("9HOd"),C=t("tB0l"),F=t("ax6A"),T=t("UQm2"),N=t("6ThG"),_=t("T8y6");r.a={components:{FeeDialog:y.default,PersonDialog:b.default,FooterBtns:C.default,SelectType:v.a,SelectTree:O.a,SelectCity:g.a,querySelect:S.a,ManageRemarks:F.default},props:{ispop:{type:Boolean,default:!1},orderobj:{type:Object,default:function(){}}},data:function(){var i=this,s=this,e=function(e,r,t){d.a.MOBILE.test(r)?t():(i.showMessage("请输入正确的联系号码~"),t(new Error))},r=function(e,r,t){console.log("rule:",e),d.a.ONLY_NUMBER_AND_LETTER.test(r)||"tmsOrderShip.shipCustomerNumber"===e.field&&!r?t():(i.showMessage(e.message||"只能输入数字或者字母"),t(new Error))};return{isChecked:!1,isCheckedShow:!1,currentBatch:1,lastEditBatch:1,batchSaveList:{},DELIVERY_METHODS:{},PAY_WAY:{},activeNames:["1"],shipFieldValue:{shipSn:!0,shipCreateTime:!0,shipToCityName:!0,amountFee:!1,brokerageFee:!1,cargoPack:!1,deliveryFee:!1,handlingFee:!1,insuranceFee:!1,packageFee:!1,pickupFee:!1,shipCustomerNumber:!1,shipFromCityName:!1,shipGoodsSn:!1,shipReceiptSn:!1,shipReceiverAddress:!1,shipReceiverId:!1,shipSenderAddress:!1,shipSenderId:!1,shipToOrgid:!1,shipUserid:!1,volumeFee:!1,weightFee:!1},rules2:{"tmsOrderShip.shipCustomerNumber":[{validator:r,trigger:"blur",message:"请输入客户单号"}],"tmsOrderShip.shipSn":[{validator:this.validateIsEmpty("运单号不能为空！")},{validator:r,message:"只能输入数字跟字母"},{validator:function(e,r,t){i.output.ismodify?t():s.detectOrderNum().then(function(e){e?(i.showMessage("重复的订单号"),t(new Error)):t()})}}],"tmsOrderShip.shipToCityName":[{validator:this.validateIsEmpty("到达城市不能为空"),trigger:"blur"}],"sender.customerName":[{validator:this.validateIsEmpty("发货人不能为空")}],"sender.customerMobile":[{validator:this.validateIsEmpty("发货人联系电话不能为空")},{validator:e,trigger:"blur"}],"receiver.customerName":[{validator:this.validateIsEmpty("收货人不能为空")}],"receiver.customerMobile":[{validator:this.validateIsEmpty("收货人联系电话不能为空")},{validator:e,trigger:"blur"}]},inputWOrV:{},shipNowpayFeeDisabled:!1,shipArrivepayFeeDisabled:!1,shipReceiptpayFeeDisabled:!1,shipMonthpayFeeDisabled:!1,dialogVisible:!1,dialogVisiblePerson:!1,popVisible:!1,changeFlag:Math.random(),pickoption:{disabledDate:function(e){var r=+e;if("34"===s.config.shipPageFunc.shipTimeRule)return r>+new Date(s.nowTime);if("33"===s.config.shipPageFunc.shipTimeRule){var t=+new Date(s.nowTime)-31536e6,i=+new Date(s.nowTime)+31536e6;return r<t||i<r}}},pickoption2:{disabledDate:function(e){return+e<new Date(s.form.tmsOrderShip.createTime).getTime()}},shipOther:[],cargoObject:{},cargoList:[{}],maxCargoLength:15,sender:{},receiver:{},form:{cargoList:[{}],sender:{customerUnit:"",customerType:"",customerName:"",customerMobile:"",detailedAddress:"",customerId:""},receiver:{customerUnit:"",customerType:"",customerName:"",customerMobile:"",detailedAddress:"",customerId:""},customerList:[],tmsOrderCargoList:[],tmsOrderPre:{},tmsOrderShip:{createTime:"",shipArrivepayFee:"",shipBusinessType:"",shipCustomerNumber:"",shipDelete:"",shipDeliveryMethod:"",shipDriverName:"",shipEffective:94,shipFromCityName:"",shipFromCityCode:"",shipFromOrgid:"",shipGoodsSn:"",shipIsAbnormal:0,shipIsControll:0,shipIsSeparate:0,shipIsTransfer:0,shipIsUpdate:0,shipMonthpayFee:"",shipNowpayFee:"",shipOther:"",shipPayWay:"",shipPrintLib:"",shipReceiptNum:"",shipReceiptRequire:"",shipReceiptSn:"",shipReceiptpayFee:"",shipReceiverId:"",shipRemarks:"",shipSenderId:"",shipShippingType:"",shipSn:"",shipToCityCode:"",shipToCityName:"",shipToOrgid:"",shipTotalFee:"0.00",shipTruckIdNumber:"",shipUserid:""},tmsOrderTransfer:{arrivalMobile:"",carrierId:"",carrierMobile:"",codService:"",createTime:"",deliveryExpense:"",oddNumbers:"",paymentId:"",remark:"",shipId:"",totalCost:"",transferCharge:"",transferTime:"",updateTime:""}},config:{},feeConfig:[],personConfig:{},orgInfo:{},loading:!1,canChangeOrderNum:!0,canChangeOrderDate:!0,shouldInputTransfer:!1,canChangeCargoNum:!0,nowTime:"",fromCityName:"",toCityName:"",output:{},dataCache:{},tmsOrderShipId:"",isSavePrint:!1,printDataObject:{},cargoKey:"init"}},computed:{transferTotalFee:function(){return p.tmsMath.add(this.form.tmsOrderTransfer.transferCharge,this.form.tmsOrderTransfer.deliveryExpense,this.form.tmsOrderTransfer.codService).result()},theFeeConfig:function(){var r=this;return this.feeConfig=this.feeConfig.filter(function(e){return e.fieldOrder=1===e.isfixed?e.fieldOrder-1e3:e.fieldOrder,0!==e.ischeck&&!(r.cargoObject[e.fieldProperty]="")}),this.feeConfig.sort(function(e,r){return e.fieldOrder<r.fieldOrder?-1:1}),this.feeConfig}},watch:{canChangeOrderNum:{handler:function(e){}},orderobj:{handler:function(e){console.log("3333333333333333333"),this.ispop&&this.initIndex()},deep:!0},transferTotalFee:function(e){this.form.tmsOrderTransfer.totalCost=e},shipOther:function(e){this.form.tmsOrderShip.shipOther=e.join(","),console.log("this.form.tmsOrderShip.shipOther:",this.form.tmsOrderShip.shipOther)},"form.tmsOrderShip.shipPrintLib":{handler:function(e){500<e&&(this.form.tmsOrderShip.shipPrintLib=500)},immediate:!0},"form.tmsOrderShip.shipSn":{handler:function(e){this.setCargoNum()}},"form.tmsOrderShip.shipReceiptRequire":{handler:function(e){console.log("form.tmsOrderShip.shipReceiptRequire",e);var r=1;80!==e&&"80"!==e&&null!==e||(r=0),this.form.tmsOrderShip.shipReceiptNum=r},immediate:!0},"form.tmsOrderShip.shipTotalFee":{handler:function(e){""===e&&(this.form.tmsOrderShip.shipTotalFee="0.00"),this.setShipFee("aaaaa")},immediate:!0},"form.tmsOrderShip.shipPayWay":{handler:function(e){this.setShipFee("bbbbb")},immediate:!0},$route:function(e,r){-1===e.path.indexOf("/operation/order/modifyOrder")||this.ispop||this.initIndex()}},activated:function(){this.initIndex()},deactivated:function(){},mounted:function(){this.loading=!0,this.initIndex(),this.getSelectType(),this.getShipPayWay(),this.form.tmsOrderTransfer.paymentId=16},methods:{showMessage:function(e){this.isChecked&&!this.isCheckedShow&&(this.isCheckedShow=!0),this.isCheckedShow},validateIsEmptyOr0:function(s,o){var a=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"不能为0";return function(e,r,t){var i=(r=a.form.cargoList[o][s])?parseInt(r,10):"";!i||i<0?(a.showMessage(n),t(new Error)):t()}},validateIsEmpty2:function(i,s){var o=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"不能为空！";return function(e,r,t){o.form.cargoList[s][i]?t():(o.showMessage(a),t(new Error))}},validateIsEmpty:function(){var i=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"不能为空！";return function(e,r,t){r?t():(i.showMessage(s),t(new Error))}},validateWeightAndVolume:function(e,i){var s=this;return function(e,r,t){s.form.cargoList[i].cargoWeight||s.form.cargoList[i].cargoVolume?t():(console.log("index：",s.form.cargoList[i].cargoWeight,s.form.cargoList[i].cargoVolume),s.showMessage("体积跟重量必填其一"),t(new Error))}},goNextInput:function(e){console.log("eeeee:",e);var r=e.srcElement,t=this.inputEles.indexOf(r),i=this.findNextInput(39,t);0<=t&&t!==this.inputEles.lenth-1&&i&&(e.preventDefault(),e.stopPropagation(),h.a.$emit("closepopbox"),i.focus())},findAllInput:function(){var e=Array.prototype.slice.call(document.querySelectorAll(".order-main input"));this.inputEles=e.filter(function(e){return null===Object(p.closest)(e,".el-table__fixed")});for(var r=this.inputEles.length,t=0;t<r;t++)this.inputEles[t].setAttribute("taborder",t++)},findNextInput:function(e,r){var t=37===e?r-1:r+1;if(t<0||t>=this.inputEles.length)return null;var i=this.inputEles[t];return i.disabled?this.findNextInput(e,t):i},bindTabWithArrow:function(){var s=this;this.isbindtab=!0;var e=document.querySelector(".order-main");if(this.findAllInput(),!e)return console.log("errorr parentEle:",e),!1;e.addEventListener("keydown",function(e){var r=e.target||e.srcElement;if("INPUT"===r.nodeName&&(37===e.keyCode||39===e.keyCode||13===e.keyCode)){var t=s.inputEles.indexOf(r),i=s.findNextInput(e.keyCode,t);console.log("nextEle:",t,r,i,s.inputEles.length,s.inputEles),0<=t&&t!==s.inputEles.lenth-1&&i&&(e.preventDefault(),e.stopPropagation(),h.a.$emit("closepopbox"),i.focus())}},!1)},setHeader:function(e,r){r.column;return e("span",{props:{},class:{addButton:!0},on:{click:this.addCargoList}},[e("i",{class:{"el-icon-plus":!0}})])},getPreOrder:function(e){return u.c(e)},getOrderInfo:function(e){return f.a.getOrderInfoById(e)},getAllSetting:function(){return Object(l.a)({orgid:this.otherinfo.orgid,type:"",module:"order"})},getOrgId:function(){return Object(_.e)(this.otherinfo.orgid).then(function(e){return e.data||{}})},getPersonSetting:function(e){return f.a.getPersonalSetup(this.otherinfo.id)},getCargoSetting:function(){return f.a.getCargoSetting(this.otherinfo.orgid)},getBaseSetting:function(){var r=this;return n.a.all([this.getAllSetting(),this.getCargoSetting(),this.getPersonSetting(),f.a.getCreateOrderDate(),this.getOrgId()]).then(function(e){r.config=e[0],r.feeConfig=e[1],r.personConfig=e[2],r.nowTime=e[3],r.orgInfo=e[4]})},setOrgCity:function(){this.form.tmsOrderShip.shipFromCityName=this.orgInfo.city},setRequired:function(){var e=this.config.shipPageFunc.shipFieldValue;for(var r in e)this.shipFieldValue[r]="1"===e[r]},init:function(){this.setRequired(),this.setOrderNum(),this.setCargoNum(),this.setOrderDate(),this.setOrderFee(),this.setOrderTransfer(),this.setOrgCity(),this.output.isOrder||this.setDefaultValue();var e=this;setTimeout(function(){e.isbindtab||e.bindTabWithArrow()},1e3)},setOrderNum:function(){var r=this;"1"!==this.config.shipNo.manualInput?(this.$refs.tmsOrderShipshipToCityName.$refs.myautocomplete.focus(),"1"===this.config.shipNo.systemNumberImmutable&&(this.canChangeOrderNum=!1),this.output.isOrder||f.a.getShipSn(this.otherinfo.orgid).then(function(e){r.form.tmsOrderShip.shipSn=e.data})):this.$refs.tmsOrderShipshipSn.focus()},setCargoNum:function(){var r=this;"1"===this.config.cargoNo.manualInput||("1"===this.config.cargoNo.systemNumberNotAllowUpdate&&(this.canChangeCargoNum=!1),!this.output.isOrder&&this.form.tmsOrderShip.shipSn&&f.a.postGenerateGoodsSn({tmsOrderShip:{shipSn:this.form.tmsOrderShip.shipSn},tmsOrderCargoList:this.form.cargoList.map(function(e){var r={};return r.cargoAmount=parseInt(e.cargoAmount1,10)||parseInt(e.cargoAmount,10)||0,r})}).then(function(e){r.form.tmsOrderShip.shipGoodsSn=e.data}))},setOrderDate:function(){this.form.tmsOrderShip.createTime=this.nowTime,"35"===this.config.shipPageFunc.shipTimeRule?this.canChangeOrderDate=!1:"34"===this.config.shipPageFunc.shipTimeRule||this.config.shipPageFunc.shipTimeRule,this.output.isOrder||(this.form.tmsOrderTransfer.transferTime=this.nowTime)},selectFromCity:function(e,r){console.log("selectFromCity:",e,r),e&&(this.form.tmsOrderShip.shipFromCityName=e.longAddr)},selectToCity:function(e,r){e&&(this.form.tmsOrderShip.shipToCityName=e.longAddr)},setOrderFee:function(){this.output.iscreate&&(this.$set(this.form.cargoList,0,Object(p.objectMerge2)(this.cargoList[0],this.cargoObject)),console.log("theFeeConfig:",this.cargoObject,this.cargoList))},setRemark:function(e){console.log("remarks:",e);var r=this.form.tmsOrderShip.shipRemarks;this.form.tmsOrderShip.shipRemarks=r?r+", "+e:e},setOrderTransfer:function(){this.shouldInputTransfer="1"===this.personConfig.shipDefault.openOrderAndTransferInfo},setDefaultValue:function(){this.form.tmsOrderShip.shipFromOrgid=this.otherinfo.orgid,this.form.tmsOrderShip.shipUserid=this.otherinfo.id,this.form.tmsOrderShip.shipPayWay=this.personConfig.shipSetKey.paymentMode,this.form.tmsOrderShip.shipReceiptRequire=this.personConfig.shipSetKey.receiptType,this.form.tmsOrderShip.shipReceiptNum=this.personConfig.shipSetKey.receiptNum,this.form.tmsOrderShip.shipShippingType=this.personConfig.shipSetKey.transportMode,this.form.tmsOrderShip.shipBusinessType=this.personConfig.shipSetKey.businessType,this.form.tmsOrderShip.shipDeliveryMethod=this.personConfig.shipSetKey.handoverMode},detectOrderNum:function(){return f.a.getJudgeShipSn(this.form.tmsOrderShip.shipSn,this.otherinfo.orgid).then(function(e){return 1<=e.data})},initIndex:function(){var t=this;this.loading=!0,this.reset(),this.getBaseSetting().then(function(e){console.log("base setting info:",e,t.$route);var r=void 0;t.ispop?(console.log("pop create order:",t.orderobj),r=t.orderobj):r=t.$route.query,r.orderid?(t.output.orderid=r.orderid,t.output.isOrder=!0,t.initOrder()):r.preid?(t.output.preId=r.preid,t.output.isPreOrder=!0,t.initPreOrder()):r.batchid?(t.output.batchid=r.batchid,t.output.ordernum=Math.min(parseInt(r.ordernum,10)||1,10),t.output.isbatch=!0,t.output.batchinfo=r.batchobj,t.initBatch()):(t.output.iscreate=!0,t.initCreate())}).catch(function(e){console.log("base setting error:",e),t.$message.error("获取信息失败："+e.text+" 请尝试重新刷新页面。")})},initCreate:function(){this.init(),this.loading=!1},initOrder:function(){var r=this;this.output.ismodify=!0;this.getOrderInfo(this.output.orderid).then(function(e){r.orderData=e.data,r.init(),r.setOrderData(e.data),r.modifyOrder(),r.loading=!1}).catch(function(e){console.log("initOrder err:",e),r.$confirm("查无此运单信息："+r.output.orderid,"提示",{confirmButtonText:"返回运单列表页",cancelButtonText:"创建运单",type:"warning"}).then(function(){r.eventBus.$emit("replaceCurrentView","/operation/order/orderManage")}).catch(function(){r.eventBus.$emit("replaceCurrentView","/operation/order/createOrder")})})},modifyOrder:function(){},initPreOrder:function(){var r=this;return this.getPreOrder(this.output.preId).then(function(e){r.form.tmsOrderPre=e.data,r.init(),r.setPreOrder(),213!==r.form.tmsOrderPre.orderStatus&&(r.$message.warning("此订单不是 非受理 状态，将不能关联创建的运单。"),r.form.tmsOrderPre={},r.output.isPreOrder=!1),r.loading=!1}).catch(function(e){r.$confirm("查无此订单信息："+r.output.preId,"提示",{confirmButtonText:"返回订单列表页",cancelButtonText:"创建运单",type:"warning"}).then(function(){r.eventBus.$emit("replaceCurrentView","/operation/order/manage")}).catch(function(){r.eventBus.$emit("replaceCurrentView","/operation/order/createOrder")})})},getBatchInfo:function(e){return this.ispop?n.a.resolve(this.output.batchinfo):f.a.getBatchInfo(e).then(function(e){return e.data?e.data:n.a.reject("查无此提货信息~~~~")})},initBatch:function(){var t=this;this.getBatchInfo(this.output.btachid).then(function(e){console.log("batch info：",t.output.batchinfo),t.output.batchinfo=e,t.batchSaveList={};for(var r=0;r<t.output.ordernum;r++)t.batchSaveList[r+1]={issave:!1,data:{},ischange:!1};t.gotoBatch(t.currentBatch)}).catch(function(e){console.log("getBatchInfo error:",e),t.$confirm("查无此提货批次信息："+t.output.batchid,"提示",{confirmButtonText:"返回提货列表页",cancelButtonText:"关闭",type:"warning"}).then(function(){t.eventBus.$emit("replaceCurrentView","/operation/order/pickUp")}).catch(function(){t.ispop?t.eventBus.$emit("hideCreateOrder"):t.eventBus.$emit("closeCurrentView")})})},setBatchInfo:function(e){if(this.output.ismodify)this.setOrderData(e);else{e=this.output.batchinfo,this.form.tmsOrderShip.shipToCityCode=e.toCityCode,this.toCityName=e.toCityName,this.form.sender.customerType=1,this.form.sender.customerName=e.customerName,this.form.sender.customerMobile=e.customerMobile,this.form.sender.detailedAddress=e.detailedAddress,this.form.sender.customerId=e.senderId;var r={};for(var t in this.cargoObject)void 0!==e[t]||(r[t]=this.cargoObject[t]),"cargoName"===t&&(r[t]=e.pickupName),"cargoAmount"===t&&(r[t]=e.pickupAmount),"cargoWeight"===t&&(r[t]=e.pickupWeight),"cargoVolume"===t&&(r[t]=e.pickupVolume),"shipFee"===t&&(r[t]=e.carriage);this.form.tmsOrderShip.shipTruckIdNumber=e.truckIdNumber,this.form.tmsOrderShip.shipBatchId=e.id,this.$set(this.form.cargoList,0,r),this.form.tmsOrderShip.shipPayWay=e.payMethod,this.form.tmsOrderShip.shipRemarks=e.remark}console.log("setBatchInfo data:",e)},gotoBatch:function(e){this.loading=!0,this.batchSaveList[e].issave?this.output.ismodify=!0:this.output.ismodify=!1,this.init(),this.setBatchInfo(this.batchSaveList[e].data),this.loading=!1},changeBatch:function(e){if(e===this.currentBatch)return!1;this.batchSaveList[this.currentBatch].issave||(this.lastEditBatch=this.currentBatch),this.batchSaveList[e].issave?(this.batchSaveList[this.currentBatch].issave||(this.batchSaveList[this.currentBatch].data=Object(p.objectMerge2)({},this.form)),this.currentBatch=e,this.gotoBatch(e)):this.batchSaveList[this.currentBatch].issave?e===this.lastEditBatch||this.lastEditBatch===this.currentBatch?(this.currentBatch=e,this.lastEditBatch=e,this.gotoBatch(e)):this.$message.warning("第"+this.lastEditBatch+"单还没保存，请先保存！"):this.$message.warning("第"+this.currentBatch+"单还没保存，请先保存！")},goNextEditBatch:function(){var e=this;this.currentBatch>=this.output.ordernum?this.$confirm("已经完成全票填写，下一步操作？","提示",{confirmButtonText:"查看运单列表页",cancelButtonText:"关闭",type:"warning"}).then(function(){e.ispop&&e.eventBus.$emit("hideCreateOrder"),e.eventBus.$emit("replaceCurrentView","/operation/order/orderManage")}).catch(function(){e.ispop?e.eventBus.$emit("hideCreateOrder"):e.eventBus.$emit("closeCurrentView")}):this.currentBatch===this.lastEditBatch?this.changeBatch(this.lastEditBatch+1):this.changeBatch(this.lastEditBatch)},setOrderData:function(e){var r=this;for(var t in e.tmsOrderShip=e.tmsOrderShipInfo||e.tmsOrderShip||{},this.form.tmsOrderShip)this.form.tmsOrderShip[t]=null===e.tmsOrderShip[t]?"":e.tmsOrderShip[t];if(this.form.tmsOrderShip.createTime=Object(p.parseTime)(this.form.tmsOrderShip.createTime),this.fromCityName=e.tmsOrderShip.shipFromCityName,this.toCityName=e.tmsOrderShip.shipToCityName,this.form.tmsOrderShip.shipFromCityName=e.tmsOrderShip.shipFromCityName,this.form.tmsOrderShip.shipToCityName=e.tmsOrderShip.shipToCityName,console.log("data.tmsOrderShip:::",e.tmsOrderShip,this.form.tmsOrderShip),this.form.cargoList=e.tmsOrderCargoList,e.customerList[0])for(var i in this.form.sender)this.sender[i]=null===e.customerList[0][i]?"":e.customerList[0][i],this.form.sender[i]=null===e.customerList[0][i]?"":e.customerList[0][i];if(e.customerList[1])for(var s in this.form.receiver)this.receiver[s]=null===e.customerList[1][s]?"":e.customerList[1][s],this.form.receiver[s]=null===e.customerList[1][s]?"":e.customerList[1][s];if(this.shipOther=this.form.tmsOrderShip.shipOther.split(",")||[],console.log("回显控货:",this.shipOther),this.form.customerList=e.customerList||[],console.log("setOrderInfo:",e,this.form),e.tmsOrderTransfer){for(var o in this.form.tmsOrderTransfer)this.form.tmsOrderTransfer[o]=null===e.tmsOrderTransfer[o]?"":e.tmsOrderTransfer[o];this.form.tmsOrderTransfer.transferTime=Object(p.parseTime)(this.form.tmsOrderTransfer.transferTime)}setTimeout(function(){r.form.tmsOrderShip.shipNowpayFee=e.tmsOrderShipInfo.shipNowpayFee,r.form.tmsOrderShip.shipArrivepayFee=e.tmsOrderShipInfo.shipArrivepayFee,r.form.tmsOrderShip.shipMonthpayFee=e.tmsOrderShipInfo.shipMonthpayFee,r.form.tmsOrderShip.shipReceiptpayFee=e.tmsOrderShipInfo.shipReceiptpayFee},300)},setPreOrder:function(){var e=this.form.tmsOrderPre;for(var r in e)e[r]=null===e[r]?"":e[r];this.form.tmsOrderShip.shipFromOrgid=e.orderFromOrgid,this.form.tmsOrderShip.shipToOrgid=e.orderToOrgid,this.form.tmsOrderShip.shipFromCityCode=e.orderFromCityCode,this.form.tmsOrderShip.shipToCityCode=e.orderToCityCode,this.form.tmsOrderShip.shipFromCityName=e.orderFromCityName,this.form.tmsOrderShip.shipToCityName=e.orderToCityName,this.form.sender.customerUnit=e.senderUnit,this.form.sender.customerType=1,this.form.sender.customerName=e.senderName,this.form.sender.customerMobile=e.senderMobile,this.form.sender.detailedAddress=e.senderAddr,this.form.sender.customerId=e.orderSenderId,this.form.receiver.customerUnit=e.receiverUnit,this.form.receiver.customerType=2,this.form.receiver.customerName=e.receiverName,this.form.receiver.customerMobile=e.receiverMobile,this.form.receiver.detailedAddress=e.receiverAddr,this.form.receiver.customerId=e.orderReceiverId;var t={};for(var i in this.cargoObject)void 0!==e[i]?t[i]=e[i]:t[i]=this.cargoObject[i],"agencyFund"===i&&(t[i]=e.agencyFund),"commissionFee"===i&&(t[i]=e.commissionFee),"productPrice"===i&&(t[i]=e.productPrice),"shipFee"===i&&(t[i]=e.shipFee),"description"===i&&(t[i]=e.description);this.$set(this.form.cargoList,0,t),this.form.tmsOrderShip.shipEffective=e.orderEffective,this.form.tmsOrderShip.shipPayWay=e.orderPayWay,this.form.tmsOrderShip.shipRemarks=e.orderRemarks,console.log("preOrderInfo:",this.form)},setSender:function(e,r){r=r||"sender",e&&(this.form[r].customerId=e.customerId||"",this.form[r].customerType="sender"===r?1:2,this.form[r].customerUnit=e.customerUnit,this.form[r].customerName=e.customerName,this.form[r].customerMobile=e.customerMobile,this.form[r].detailedAddress=e.detailedAddress,this[r]=e)},setReceiver:function(e){this.setSender(e,"receiver")},addCargoList:function(){var e=this;this.form.cargoList.length<this.maxCargoLength&&this.form.cargoList.push(Object(p.objectMerge2)({},this.cargoObject)),setTimeout(function(){e.findAllInput()},100)},deleteCargoList:function(e){var r=this;this.form.cargoList.splice(e,1),setTimeout(function(){r.findAllInput()},100)},detectCargoNumChange:function(){this.setCargoNum()},changeFee:function(e,r,t){this.form.cargoList[e][r]=t,this.getTotalFee()},getBatch:function(e){this.form.tmsOrderShip.shipTruckIdNumber=e.truckIdNumber||""},getTotalFee:function(){var t=this,i=0;this.form.cargoList.forEach(function(e){for(var r in e)"1"===t.config.shipFee[r]&&null!==e[r]&&(i=p.tmsMath.add(i,e[r]).result())}),this.form.tmsOrderShip.shipTotalFee=parseFloat(i,10).toFixed(2)},formatShipFee:function(){this.form.tmsOrderShip.shipNowpayFee=parseFloat(this.form.tmsOrderShip.shipNowpayFee,10)?parseFloat(this.form.tmsOrderShip.shipNowpayFee,10).toFixed(2):"0.00",this.form.tmsOrderShip.shipArrivepayFee=parseFloat(this.form.tmsOrderShip.shipArrivepayFee,10)?parseFloat(this.form.tmsOrderShip.shipArrivepayFee,10).toFixed(2):"0.00",this.form.tmsOrderShip.shipMonthpayFee=parseFloat(this.form.tmsOrderShip.shipMonthpayFee,10)?parseFloat(this.form.tmsOrderShip.shipMonthpayFee,10).toFixed(2):"0.00",this.form.tmsOrderShip.shipReceiptpayFee=parseFloat(this.form.tmsOrderShip.shipReceiptpayFee,10)?parseFloat(this.form.tmsOrderShip.shipReceiptpayFee,10).toFixed(2):"0.00"},setOtherFee:function(e){var r=parseFloat(this.form.tmsOrderShip[e],10)||0;if((0===r||""===r)&&0<this.form.tmsOrderShip.shipTotalFee){var t=p.tmsMath.sub(this.form.tmsOrderShip.shipTotalFee,this.form.tmsOrderShip.shipNowpayFee,this.form.tmsOrderShip.shipArrivepayFee,this.form.tmsOrderShip.shipMonthpayFee,this.form.tmsOrderShip.shipReceiptpayFee).result();0<t&&(this.form.tmsOrderShip[e]=t)}},setShipFee:function(e){var r=parseInt(this.form.tmsOrderShip.shipPayWay,10);switch(this.shipNowpayFeeDisabled=!0,this.shipArrivepayFeeDisabled=!0,this.shipReceiptpayFeeDisabled=!0,this.shipMonthpayFeeDisabled=!0,this.form.tmsOrderShip.shipNowpayFee="0.00",this.form.tmsOrderShip.shipArrivepayFee="0.00",this.form.tmsOrderShip.shipMonthpayFee="0.00",this.form.tmsOrderShip.shipReceiptpayFee="0.00",103===r?this.form.tmsOrderShip.shipTotalFee=0:this.getTotalFee(),console.log("this.form.tmsOrderShip.shipTotalFee:",this.form.tmsOrderShip.shipTotalFee),r){case 76:this.form.tmsOrderShip.shipNowpayFee=this.form.tmsOrderShip.shipTotalFee;break;case 77:this.form.tmsOrderShip.shipArrivepayFee=this.form.tmsOrderShip.shipTotalFee;break;case 78:this.form.tmsOrderShip.shipMonthpayFee=this.form.tmsOrderShip.shipTotalFee;break;case 79:this.form.tmsOrderShip.shipReceiptpayFee=this.form.tmsOrderShip.shipTotalFee;break;case 103:this.form.tmsOrderShip.shipTotalFee="0.00";break;case 104:this.shipNowpayFeeDisabled=!1,this.shipArrivepayFeeDisabled=!1,this.shipReceiptpayFeeDisabled=!1,this.shipMonthpayFeeDisabled=!1,this.form.tmsOrderShip.shipNowpayFee=this.form.tmsOrderShip.shipTotalFee}},setOddNumbers:function(e){this.form.tmsOrderTransfer.oddNumbers=e.replace(/\s/g,"")},getCarrier:function(e){e&&(this.form.tmsOrderTransfer.carrierMobile=e.carrierMobile)},resetObj:function(e){for(var r in e)e[r]="";return e},reset:function(e){var r=Object(p.objectMerge2)({},this.form);this.$refs.ruleForm.resetFields(),this.form.cargoList=[{}],this.cargoList=[{}],this.form.sender=this.resetObj(this.form.sender),this.form.receiver=this.resetObj(this.form.receiver),this.form.customerList=[],this.form.tmsOrderCargoList=[],this.sender={},this.receiver={},this.form.tmsOrderShip=this.resetObj(this.form.tmsOrderShip),this.form.tmsOrderShip.shipIsAbnormal=0,this.form.tmsOrderShip.shipIsControll=0,this.form.tmsOrderShip.shipIsSeparate=0,this.form.tmsOrderShip.shipIsTransfer=0,this.form.tmsOrderShip.shipIsUpdate=0,this.form.tmsOrderShip.shipTotalFee="0.00",this.form.tmsOrderTransfer=this.resetObj(this.form.tmsOrderTransfer),e&&(this.form.tmsOrderShip.shipSn=r.tmsOrderShip.shipSn,this.form.tmsOrderShip.createTime=r.tmsOrderShip.createTime,this.form.tmsOrderShip.shipFromOrgid=r.tmsOrderShip.shipFromOrgid,this.form.tmsOrderShip.shipDeliveryMethod=r.tmsOrderShip.shipDeliveryMethod,this.form.tmsOrderShip.shipGoodsSn=r.tmsOrderShip.shipGoodsSn,this.form.tmsOrderShip.shipPayWay=r.tmsOrderShip.shipPayWay,this.form.tmsOrderTransfer.transferTime=r.tmsOrderTransfer.transferTime,this.$set(this.form.cargoList,0,Object(p.objectMerge2)({},this.cargoObject)),this.cargoKey=Math.random(),this.setDefaultValue()),this.currentBatch=1,this.lastEditBatch=1,this.batchSaveList={},this.output={}},vaildateForm:function(){},submitForm:function(){var n=this;this.isChecked=!0,this.isCheckedShow=!1,console.log("提交前数据：",this.form),this.$refs.ruleForm.validate(function(e,r){if(n.isChecked=!1,n.isCheckedShow=!1,console.log("errlist:",r),e)if(p.tmsMath.add(n.form.tmsOrderShip.shipNowpayFee,n.form.tmsOrderShip.shipArrivepayFee,n.form.tmsOrderShip.shipMonthpayFee,n.form.tmsOrderShip.shipReceiptpayFee).result()!==parseFloat(n.form.tmsOrderShip.shipTotalFee,10))console.log(p.tmsMath.add(n.form.tmsOrderShip.shipNowpayFee,n.form.tmsOrderShip.shipArrivepayFee,n.form.tmsOrderShip.shipMonthpayFee,n.form.tmsOrderShip.shipReceiptpayFee).result(),n.form.tmsOrderShip.shipNowpayFee,n.form.tmsOrderShip.shipArrivepayFee,n.form.tmsOrderShip.shipMonthpayFee,n.form.tmsOrderShip.shipReceiptpayFee,n.form.tmsOrderShip.shipTotalFee),n.showMessage("各付款方式之和与合计运费不等~");else{var t=Object(p.objectMerge2)({},n.form);delete t.sender,delete t.receiver,delete t.cargoList,n.output.isPreOrder||(console.log("this.output.isPreOrder:",n.output.isPreOrder),delete t.tmsOrderPre),console.log("create submit data:",m()(t)),n.shouldInputTransfer?(t.tmsOrderTransfer.transferTime=new Date((t.tmsOrderTransfer.transferTime+"").trim()).getTime(),n.output.ismodify&&(t.tmsOrderTransfer.id=n.orderData.tmsOrderTransfer?n.orderData.tmsOrderTransfer.id:"")):(delete t.tmsOrderTransfer,t.tmsOrderTransfer={});var i=!1;for(var s in n.form.sender)n.sender[s]!==n.form.sender[s]&&(i=!0);var o=!1;for(var a in n.form.receiver)n.receiver[a]!==n.form.receiver[a]&&(o=!0);t.customerList[0]=n.form.sender,t.customerList[1]=n.form.receiver,i?t.customerList[0].customerId="":t.tmsOrderShip.shipSenderId=t.customerList[0].customerId,t.customerList[0].customerType=1,o?t.customerList[1].customerId="":t.tmsOrderShip.shipReceiverId=t.customerList[1].customerId,t.customerList[1].customerType=2,t.tmsOrderCargoList=n.form.cargoList.filter(function(e){return!!e.cargoName}).map(function(e){var r={};for(var t in e)""===e[t]?r[t]=0:r[t]=e[t];return r}),t.tmsOrderShip.createTime=new Date((t.tmsOrderShip.createTime+"").trim()).getTime(),t.tmsOrderShip.shipTotalFee=parseFloat(t.tmsOrderShip.shipTotalFee,10).toFixed(2),t.tmsOrderShip.shipNowpayFee=parseFloat(t.tmsOrderShip.shipNowpayFee,10).toFixed(2),t.tmsOrderShip.shipArrivepayFee=parseFloat(t.tmsOrderShip.shipArrivepayFee,10).toFixed(2),t.tmsOrderShip.shipReceiptpayFee=parseFloat(t.tmsOrderShip.shipReceiptpayFee,10).toFixed(2),t.tmsOrderShip.shipMonthpayFee=parseFloat(t.tmsOrderShip.shipMonthpayFee,10).toFixed(2),n.output.ismodify?(t.tmsOrderShip.id=n.orderData.tmsOrderShip.id,t.tmsOrderShip.shipStatus=n.orderData.tmsOrderShip.shipStatus,console.log("change Order:",t),f.a.putChangeOrder(t).then(function(e){n.$message.success("成功修改运单！"),n.eventBus.$emit("saveOrderSuccess"),n.output.isbatch?n.batchSaveList[n.currentBatch].data=t:n.ispop?(n.eventBus.$emit("hideCreateOrder"),n.eventBus.$emit("showOrderDetail",t.tmsOrderShip.id)):n.eventBus.$emit("replaceCurrentView","/operation/order/orderManage")}).catch(function(e){n.$message.error("修改失败，原因："+e.text)})):f.a.postNewOrder(t).then(function(e){n.$message.success("成功创建运单！"),n.eventBus.$emit("saveOrderSuccess"),t.tmsOrderShip.id=e.data,n.tmsOrderShipId=e.data,n.output.isbatch?(n.batchSaveList[n.currentBatch].data=t,n.batchSaveList[n.currentBatch].issave=!0,n.goNextEditBatch()):(n.output.isPreOrder&&n.eventBus.$emit("putAcceptOrder",n.output.preId),n.ispop?(n.eventBus.$emit("hideCreateOrder"),n.eventBus.$on("showOrderDetail",e.data)):n.eventBus.$emit("replaceCurrentView","/operation/order/orderDetail?orderid="+e.data+"&tab=查看"+t.tmsOrderShip.shipSn)),n.isSavePrint&&n.print()}).catch(function(e){n.$message.error("创建失败，原因："+e.text)})}})},doAction:function(e){switch(e){case"cleanKey":this.reset(!0);break;case"printLibkey":this.printLibkey();break;case"printShipKey":this.print();break;case"saveShipKey":this.submitForm(),this.isSavePrint=!1;break;case"savePrintKey":this.submitForm(),this.isSavePrint=!0}},printLibkey:function(){var s=this;Object(N.a)().then(function(e){console.log("getEnableLibSetting",e),s.setPrintData("lib");var r=o()([],e),t=function(t){r.forEach(function(e,r){e.filedValue===t&&(e.value=s.printDataObject[t])})};for(var i in s.printDataObject)t(i);Object(T.b)(r)})},print:function(){var s=this;Object(N.b)().then(function(e){console.log("getEnableOrderSetting",e),s.setPrintData("order");var r=o()([],e),t=function(t){r.forEach(function(e,r){e.filedValue===t&&(e.value=s.printDataObject[t])})};for(var i in s.printDataObject)t(i);Object(T.b)(e)})},getSelectType:function(){var r=this;Object(c.e)("ship_delivery_method",this.otherinfo.orgid).then(function(e){e.forEach(function(e){r.DELIVERY_METHODS[e.id]=e.dictName})})},getShipPayWay:function(){var r=this;Object(c.e)("ship_pay_way",this.otherinfo.orgid).then(function(e){console.log("ship_pay_way",e,parseInt(r.form.tmsOrderShip.shipPayWay)),e.forEach(function(e){r.PAY_WAY[e.id]=e.dictName})})},setPrintData:function(e){var r=new Object;if("lib"===e)this.$set(r,"goodsSn",this.form.tmsOrderShip.shipGoodsSn),this.$set(r,"createTime",this.form.tmsOrderShip.createTime),this.$set(r,"fromCity",this.form.tmsOrderShip.shipFromCityName),this.$set(r,"toCity",this.form.tmsOrderShip.shipToCityName),this.$set(r,"toOrgName",this.form.tmsOrderShip.shipToCityName),this.$set(r,"fromOrgName",this.otherinfo.name),this.$set(r,"senderUnit",this.form.sender.customerUnit),this.$set(r,"senderName",this.form.sender.customerName),this.$set(r,"senderMobile",this.form.sender.customerMobile),this.$set(r,"cargoPack",this.form.cargoList[0].cargoPack),this.$set(r,"companyName",this.otherinfo.companyName),this.$set(r,"deliveryMethod",this.DELIVERY_METHODS[parseInt(this.form.tmsOrderShip.shipDeliveryMethod)]);else if("order"===e){for(var t in this.$set(r,"shipSn",this.form.tmsOrderShip.shipSn),this.$set(r,"createTime",this.form.tmsOrderShip.createTime),this.$set(r,"fromCity",this.form.tmsOrderShip.shipFromCityName),this.$set(r,"toCity",this.form.tmsOrderShip.shipToCityName),this.$set(r,"deliveryMethod",this.DELIVERY_METHODS[parseInt(this.form.tmsOrderShip.shipDeliveryMethod)]),this.$set(r,"toOrgName",this.form.tmsOrderShip.shipToCityName),this.$set(r,"fromOrgName",this.otherinfo.name),this.$set(r,"goodsSn",this.form.tmsOrderShip.shipGoodsSn),this.$set(r,"senderUnit",this.form.sender.customerUnit),this.$set(r,"senderName",this.form.sender.customerName),this.$set(r,"senderMobile",this.form.sender.customerMobile),this.$set(r,"senderAddress",this.form.sender.detailedAddress),this.$set(r,"receiverUnit",this.form.receiver.customerUnit),this.$set(r,"receiverName",this.form.receiver.customerName),this.$set(r,"receiverMobile",this.form.receiver.customerMobile),this.$set(r,"receiverAddress",this.form.receiver.customerAddress),this.form.cargoList[0])r[t]=this.form.cargoList[0][t];console.log("this.form.cargoList[0]",this.form.cargoList[0]),this.$set(r,"description",this.form.cargoList[0].description?this.form.cargoList[0].description:""),this.$set(r,"otherfeeOut",this.form.cargoList[0].otherfeeOut?this.form.cargoList[0].otherfeeOut:""),this.$set(r,"otherfeeIn",this.form.cargoList[0].otherfeeIn?this.form.cargoList[0].otherfeeIn:""),this.$set(r,"taxRate",this.form.cargoList[0].taxRate?this.form.cargoList[0].taxRate:""),this.$set(r,"taxes",this.form.cargoList[0].taxes?this.form.cargoList[0].taxes:""),this.$set(r,"housingFee",this.form.cargoList[0].housingFee?this.form.cargoList[0].housingFee:""),this.$set(r,"stampTax",this.form.cargoList[0].stampTax?this.form.cargoList[0].stampTax:""),this.$set(r,"payWay",this.PAY_WAY[parseInt(this.form.tmsOrderShip.shipPayWay)]),this.$set(r,"totalFee",this.form.tmsOrderShip.shipTotalFee),this.$set(r,"receiptRequire",this.form.tmsOrderShip.shipReceiptRequire),this.$set(r,"customerNumber",this.form.tmsOrderShip.shipCustomerNumber),this.$set(r,"shippingType",this.form.tmsOrderShip.shipShippingType),this.$set(r,"businessType",this.form.tmsOrderShip.shipBusinessType),this.$set(r,"effective",this.form.tmsOrderShip.shipEffective),this.$set(r,"userName",this.form.tmsOrderShip.shipUserid),this.$set(r,"controlGoods",this.shipOther),this.$set(r,"valuables",this.shipOther),this.$set(r,"remarks",this.form.tmsOrderShip.shipRemarks)}this.printDataObject=o()({},r),r={},console.log("printDataObject",this.printDataObject)},handleCommand:function(e){switch(e){case"feeSetup":this.dialogVisible=!0;break;case"personalSetup":this.dialogVisiblePerson=!0;break;case"orderSetup":this.$router.push("/company/systemSetup");break;case"openInNewWindow":this.$message("暂不支持新开窗口创建运单~")}},getKeySetup:function(){var r=this;this.changeFlag=Math.random(),this.getPersonSetting(!0).then(function(e){r.personConfig=e,r.setOrderTransfer(),r.output.isOrder||r.setDefaultValue()})}},beforeRouteUpdate:function(e,r,t){t(),console.log("beforeRouteUpdate:",e,r)}}},r2Kh:function(e,r){}});