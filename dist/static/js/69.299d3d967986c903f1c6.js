webpackJsonp([69,390,391,393,394],{"7tLi":function(e,t,i){"use strict";var a=i("mvHQ"),o=i.n(a),l=i("woOf"),n=i.n(l),r=i("Dd8w"),s=i.n(r),c=i("i7Ou"),d=i("0xDb"),f=i("9UCZ"),u=i("NYxO"),p=i("UQm2"),m=i("t5DY"),h=i("rxpl"),g=i("RCWJ"),v=i("aCZp"),b=i("CWnj"),_=i("QbVN");t.a={name:"systemSetup",components:{SelectType:f.a,printSetOrder:h.default,printSetLi:g.default,printLoadInfo:v.default,printContract:b.default,Upload:_.a},computed:s()({},Object(u.mapGetters)(["otherinfo"])),data:function(){return{loading:!0,printers:[],shipNo:"",cargoNo:"",printSetOrderVisible:!1,printSetLiVisible:!1,printLoadInfoVisible:!1,printContractVisible:!1,nochange:!0,tooltip1:!1,tooltip2:!1,tooltip3:!1,fieldSetup:[],activeNames:["setup1","setup2","setup3","setup4","setup5","setup6","setup7","setup8","setup9"],shipField:[{key:"shipFromCityName",value:"0",name:"发站"},{key:"shipToOrgid",value:"0",name:"目的网点"},{key:"shipGoodsSn",value:"0",name:"货号"},{key:"shipSenderId",value:"0",name:"发货方"},{key:"shipSenderName",value:"0",name:"发货人"},{key:"shipSenderMobile",value:"0",name:"发货人电话"},{key:"shipSenderAddress",value:"0",name:"发货地址"},{key:"shipReceiverId",value:"0",name:"收货方"},{key:"shipReceiverName",value:"0",name:"收货人"},{key:"shipReceiverMobile",value:"0",name:"收货人电话"},{key:"shipReceiverAddress",value:"0",name:"收货地址"},{key:"cargoWeight",value:"0",name:"重量"},{key:"cargoVolume",value:"0",name:"体积"},{key:"cargoPack",value:"0",name:"包装"},{key:"brokerageFee",value:"0",name:"回扣"},{key:"deliveryFee",value:"0",name:"送货费"},{key:"insuranceFee",value:"0",name:"保险费"},{key:"handlingFee",value:"0",name:"装卸费"},{key:"packageFee",value:"0",name:"包装费"},{key:"pickupFee",value:"0",name:"提货费"},{key:"amountFee",value:"0",name:"件数单价"},{key:"weightFee",value:"0",name:"重量单价"},{key:"volumeFee",value:"0",name:"体积单价"},{key:"shipReceiptSn",value:"0",name:"回单号"},{key:"shipCustomerNumber",value:"0",name:"客户单号"},{key:"shipUserid",value:"0",name:"业务员"}],vouchers:[{value:"1",label:"需要"},{value:"2",label:"不需要"}],canSwitchs:[{value:"0",label:"不可以"},{value:"1",label:"可以"}],trackSigns:[{value:"0",label:"追货宝"},{value:"1",label:"中交兴路"}],deliverContacts:[{value:"driver",label:"司机名称"},{value:"carno",label:"车牌号"}],form:{track:{trackSign:"0"},switchUser:{canSwitch:""},uploadLogo:{logoUrl:""},financeSetting:{voucher:"2"},grossMargin:{shipFeeAmount:"1",brokerageFee:"1"},listTemplate:{templateSign:"1"},printSetting:{ship:"0",label:"0",inventory:"0"},shipNo:{manualInput:"0",companyNumberAutoIncrementSign:"0",companyNumberAutoIncrementByTwoYMSign:"1",companyNumberAutoIncrementByTwoYMDSign:"0",systemNumberImmutable:"0",companyNumberAutoIncrementValue:"",companyNumberAutoIncrementByTwoYMValue:"",companyNumberAutoIncrementByTwoYMDValue:""},shipPermission:{onlyInvalidOwnShip:"0",onlyUpdateOwnShip:"0",onlyDeleteOwnShip:"0",selectOrderSetting:"1",controlgoodsVisibleRule:"1"},module:"order",cargoNo:{orgIdAndShipNoAndNumberOfUnitsSign:"0",manualInput:"0",systemNumberNotAllowUpdate:"0",orgIdAndShipNoAndNumberOfUnitsValue:"",shipNoAndNumberOfUnits:"1"},shipFee:{customsFee:"0",commissionFee:"0",handlingFee:"1",otherfeeIn:"0",brokerageFee:"1",goupstairsFee:"0",taxes:"0",shipFee:"1",housingFee:"0",deliveryFee:"1",insuranceFee:"0",forkliftFee:"1",pickupFee:"1",stampTax:"0",packageFee:"0"},shipPageFunc:{shipFieldValue:{cargoPack:"0",shipReceiptSn:"0",shipGoodsSn:"0",amountFee:"0",shipToOrgid:"0",handlingFee:"0",brokerageFee:"0",volumeFee:"0",weightFee:"0",shipFromCityName:"0",cargoVolume:"0",shipCustomerNumber:"0",shipSenderId:"0",shipSenderAddress:"0",shipUserid:"0",deliveryFee:"0",insuranceFee:"0",shipReceiverId:"0",shipReceiverName:"0",shipReceiverMobile:"0",shipSenderName:"0",shipSenderMobile:"0",cargoWeight:"0",pickupFee:"0",shipReceiverAddress:"0",packageFee:"0"},insurancePremiumIsDeclaredValue:3,toCityByAdministrativeRegion:"0",notifyCargoRule:"",shipTimeRule:"",shipFieldSign:"1",orderName:"收发货凭证",decimalPlaces:"2",printLabelIsAmount:"1"},loadSetting:{carrier:"driver"},orgid:1}}},mounted:function(){this.initOrder()},methods:{infoFinance:function(){var i=this,e={orgid:this.otherinfo.orgid,type:"",module:"finance"};return Object(c.a)(e).then(function(e){if(console.log("financeSetting",e),e.financeSetting&&i.$set(i.form.financeSetting,"voucher",e.financeSetting.voucher),e.grossMargin)for(var t in e.grossMargin)i.$set(i.form.grossMargin,t,e.grossMargin[t]);i.loading=!1}).catch(function(e){i.loading=!1,i._handlerCatchMsg(e)})},initBase:function(){var t=this,e={orgid:this.otherinfo.orgid,type:"",module:"base"};return Object(c.a)(e).then(function(e){console.log("uploadLogo",e),e.uploadLogo&&(e.uploadLogo.logoUrl="null"!==e.uploadLogo.logoUrl&&e.uploadLogo.logoUrl?e.uploadLogo.logoUrl:"",t.$set(t.form.uploadLogo,"logoUrl",e.uploadLogo.logoUrl)),e.switchUser&&t.$set(t.form.switchUser,"canSwitch",e.switchUser.canSwitch),t.loading=!1}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},initOrder:function(){var e=this;this.getInfo("order").then(function(){e.setShipNo(),e.setCargoNo(),e.initField(),e.initPrinter(),e.infoFinance(),e.initBase(),e.nochange=!1})},initPrinter:function(){for(var e in this.printers=n()([],Object(p.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},doAction:function(e){switch(e){case"printSetOrder":this.printSetOrder();break;case"printSetLi":this.printSetLi();break;case"printLoadInfo":this.printLoadInfoVisible=!0;break;case"printContract":this.printContractVisible=!0}},printSetOrder:function(){this.printSetOrderVisible=!0},printSetLi:function(){this.printSetLiVisible=!0},closePrintSetOrder:function(){this.printSetOrderVisible=!1},closePrintSetLi:function(){this.printSetLiVisible=!1},getInfo:function(e){var i=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return Object(c.a)({orgid:this.otherinfo.orgid,type:t,module:e}).then(function(e){for(var t in i.form=Object(d.objectMerge2)({},e),i.form.shipPageFunc.shipTimeRule=parseInt(i.form.shipPageFunc.shipTimeRule,10),i.form.shipPageFunc.notifyCargoRule=parseInt(i.form.shipPageFunc.notifyCargoRule,10),i.form.printSetting)i.form.printSetting[t]=i.form.printSetting[t].replace(/%\^/g,"\\");i.$set(i.form,"switchUser",{canSwitch:""}),i.$set(i.form,"financeSetting",{voucher:""}),i.$set(i.form,"grossMargin",{shipFeeAmount:"1",brokerageFee:"1"}),i.$set(i.form,"uploadLogo",{logoUrl:""}),i.form.loadSetting||i.$set(i.form,"loadSetting",{carrier:""})}).catch(function(e){i.loading=!1,i._handlerCatchMsg(e)})},setShipNo:function(){"1"===this.form.shipNo.manualInput&&(this.shipNo="1"),"1"===this.form.shipNo.companyNumberAutoIncrementByTwoYMDSign&&(this.shipNo="2"),"1"===this.form.shipNo.companyNumberAutoIncrementByTwoYMSign&&(this.shipNo="3"),"1"===this.form.shipNo.companyNumberAutoIncrementSign&&(this.shipNo="4")},setCargoNo:function(){"1"===this.form.cargoNo.manualInput&&(this.cargoNo="1"),"1"===this.form.cargoNo.shipNoAndNumberOfUnits&&(this.cargoNo="2"),"1"===this.form.cargoNo.orgIdAndShipNoAndNumberOfUnitsSign&&(this.cargoNo="3")},resetShipNo:function(){this.form.shipNo.manualInput="0",this.form.shipNo.companyNumberAutoIncrementByTwoYMDSign="0",this.form.shipNo.companyNumberAutoIncrementByTwoYMSign="0",this.form.shipNo.companyNumberAutoIncrementSign="0"},resetCargoNo:function(){this.form.cargoNo.manualInput="0",this.form.cargoNo.shipNoAndNumberOfUnits="0",this.form.cargoNo.orgIdAndShipNoAndNumberOfUnitsSign="0"},saveDatePrint:function(){var t=this;this.loading=!0;var e=n()({},this.form.printSetting);for(var i in e)e[i]=e[i].replace(/\\/g,"%^");var a=n()({},this.form);a.printSetting=n()({},e),console.warn("提交 form,base",a),a.shipPageFunc.insurancePremiumIsDeclaredValue&&"null"!==a.shipPageFunc.insurancePremiumIsDeclaredValue||(a.shipPageFunc.insurancePremiumIsDeclaredValue=3),this.putSetting(a).then(function(){var e=localStorage.getItem("TMS-userinfo");e&&(e=JSON.parse(e)).systemSetup&&(e.systemSetup.printFontSetting=Object(d.objectMerge2)({},a.printFontSetting),e.systemSetup.printSetting=Object(d.objectMerge2)({},a.printSetting)),localStorage.setItem("TMS-userinfo",o()(e)),t.initOrder(),t.loading=!1})},saveData:function(){var e=this;this.loading=!0;var t=n()({},this.form.printSetting);for(var i in t)t[i]=t[i].replace(/\\/g,"%^");var a=n()({},this.form);a.printSetting=n()({},t);var o={orgid:a.orgid,module:"finance",financeSetting:a.financeSetting,grossMargin:a.grossMargin},l={orgid:a.orgid,module:"base",upLoadLogo:a.uploadLogo,switchUser:a.switchUser};console.warn("提交 form,finance,base",a,o,l),a.shipPageFunc.insurancePremiumIsDeclaredValue&&"null"!==a.shipPageFunc.insurancePremiumIsDeclaredValue||(a.shipPageFunc.insurancePremiumIsDeclaredValue=3),this.putSetting(a).then(function(){e.putSetting(o).then(function(){e.putSetting(l).then(function(){e.$message({message:"保存成功",type:"success"}),e.initOrder(),e.loading=!1})})})},putSetting:function(e){var t=this;return Object(c.b)(e).then(function(e){t.otherinfo.systemSetup=t.form}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},changeSystem:function(e){e.ship&&(this.$set(this.form.printSetting,"ship",e.ship),this.$set(this.form.printFontSetting,"ship",e.shipFont)),e.label&&(this.$set(this.form.printSetting,"label",e.label),this.$set(this.form.printFontSetting,"label",e.labelFont)),e.loadFont&&this.$set(this.form.printFontSetting,"load",e.loadFont),e.contractFont&&this.$set(this.form.printFontSetting,"contract",e.contractFont),this.saveDatePrint()},initField:function(){for(var e in this.fieldSetup=[],this.form.shipPageFunc.shipFieldValue)"1"===this.form.shipPageFunc.shipFieldValue[e]&&this.fieldSetup.push(e)},setField:function(){for(var e in this.form.shipPageFunc.shipFieldValue)-1!==this.fieldSetup.indexOf(e)?this.form.shipPageFunc.shipFieldValue[e]="1":this.form.shipPageFunc.shipFieldValue[e]="0"},downloadFile:function(e){window.open(Object(m.c)(e))}},watch:{fieldSetup:function(e){this.setField()},shipNo:function(e){switch(this.resetShipNo(),e){case"1":this.form.shipNo.manualInput="1";break;case"2":this.form.shipNo.companyNumberAutoIncrementByTwoYMDSign="1";break;case"3":this.form.shipNo.companyNumberAutoIncrementByTwoYMSign="1";break;case"4":this.form.shipNo.companyNumberAutoIncrementSign="1"}},cargoNo:function(e){switch(this.resetCargoNo(),e){case"1":this.form.cargoNo.manualInput="1";break;case"2":this.form.cargoNo.shipNoAndNumberOfUnits="1";break;case"3":this.form.cargoNo.orgIdAndShipNoAndNumberOfUnitsSign="1"}}}}},CWnj:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("P5E9"),o=i("Z2is"),l=i("VU/8")(a.a,o.a,null,null,null);t.default=l.exports},EvzS:function(e,t,i){"use strict";var a={render:function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],staticClass:"tms_dialog_print_drag",attrs:{title:"打印运单设置 (单位:毫米mm)",visible:o.dialogVisible,fullscreen:"","before-close":o.closeMe,"close-on-press-escape":!1},on:{"update:visible":function(e){o.dialogVisible=e}}},[l("div",{key:o.viewKey,staticClass:"print_aside"},[l("div",{staticClass:"print_aside_head"},[l("span",[l("i",{staticClass:"el-icon-menu"}),o._v(" 字段列表 "+o._s(o.formModel.labelList.length)+" ")]),o._v(" "),l("el-popover",{staticStyle:{float:"right","margin-top":"0px","margin-left":"10px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[l("span",[o._v("可将信息项手动拖拽到右边纸张中显示及设置位置和宽高；"),l("br"),o._v("(单位：毫米mm)")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("【快捷键：】")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("按↑ ↓ ← →移动编辑项，")]),o._v(" "),l("br"),l("span",[o._v("按ctrl+↑↓控制高度变化，")]),o._v(" "),l("br"),l("span",[o._v("按ctrl+←→控制宽度变化 ")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("按tab键切换编辑项，")]),o._v(" "),l("br"),l("span",[o._v("shift+tab切换回上一个编辑项")]),o._v(" "),l("i",{staticClass:"el-icon-warning",attrs:{slot:"reference"},slot:"reference"})]),o._v(" "),l("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"success",icon:"el-icon-document",size:o.btnsize},on:{click:function(e){o.submitForm("formModel")}}},[o._v("保存")]),o._v(" "),l("el-button",{staticStyle:{float:"right","margin-top":"10px","margin-right":"10px"},attrs:{icon:"el-icon-refresh",size:o.btnsize},on:{click:o.review}},[o._v("刷新")])],1),o._v(" "),l("div",{staticClass:"print_aside_search"},[l("el-autocomplete",{attrs:{"fetch-suggestions":o.querySearch,placeholder:"查找非自定义字段","popper-class":"popperHide",size:"mini",clearable:""},on:{select:o.handleSelect},model:{value:o.currentSearch,callback:function(e){o.currentSearch=e},expression:"currentSearch"}},[l("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),o._v(" "),l("el-form",{ref:"formModel",staticClass:"print_aside_form",attrs:{model:o.formModel,rules:o.rules,"label-width":"0px"}},[l("div",{staticClass:"print_aside_content_form"},[l("label",[o._v("模板名称")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 6===t.type?l("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[l("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入模板名称(最多128个字符)",clearable:"",maxlength:128},nativeOn:{keyup:function(e){if(!("button"in e)&&o._k(e.keyCode,"enter",13,e.key,"Enter"))return null;o.addItemDrag(t,i)}},model:{value:o.modelNameSelf,callback:function(e){o.modelNameSelf=e},expression:"modelNameSelf"}})],1):o._e()})),o._v(" "),l("label",[o._v("发货人信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 1===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("收货人信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 2===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("运单主要信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 3===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("货物主要信息\n          "),l("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"circle",title:"添加一套货物信息"},on:{click:o.showCargoPlus}})],1),o._v(" "),l("ul",{key:o.cargoKey,staticClass:"print_aside_content"},[o._l(o.formModel.labelList,function(t,i){return 4===t.type&&t.showCargo&&"2"!==t.filedName.slice(-1)&&"3"!==t.filedName.slice(-1)?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()}),o._v(" "),3===o.cargoNum||2===o.cargoNum?l("hr"):o._e(),o._v(" "),o._l(o.formModel.labelList,function(t,i){return 4===t.type&&t.showCargo&&"2"===t.filedName.slice(-1)?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()}),o._v(" "),3===o.cargoNum?l("hr"):o._e(),o._v(" "),o._l(o.formModel.labelList,function(t,i){return 4===t.type&&t.showCargo&&"3"===t.filedName.slice(-1)?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})],2),o._v(" "),l("label",[o._v("自定义信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 5===t.type?l("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[l("el-input",{attrs:{size:"mini",placeholder:"自定义标签(最多128个字符)",clearable:"",maxlength:128},nativeOn:{keyup:function(e){if(!("button"in e)&&o._k(e.keyCode,"enter",13,e.key,"Enter"))return null;o.addItemDrag(t,i)}},model:{value:o.labelSelf,callback:function(e){o.labelSelf=e},expression:"labelSelf"}}),o._v(" "),l("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(e){o.addItemDrag(t,i)}}},[o._v("添加")])],1):o._e()}))]),o._v(" "),l("div",{staticClass:"prinit_aside_paper"},[l("label",[l("i",{staticClass:"el-icon-edit"}),o._v(" 打印字体")]),o._v(" "),l("el-select",{attrs:{size:"mini"},model:{value:o.formPrint.printFontSetting.ship,callback:function(e){o.$set(o.formPrint.printFontSetting,"ship",e)},expression:"formPrint.printFontSetting.ship"}},o._l(o.$const.PRINT_FONT,function(e,t){return l("el-option",{key:t,attrs:{value:e,label:e}})}))],1),o._v(" "),l("div",{staticClass:"prinit_aside_paper"},[l("span",[l("i",{staticClass:"el-icon-document"}),o._v(" 纸张设置")]),o._v(" "),l("br"),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.width,callback:function(e){o.$set(o.formModel.paper,"width",e)},expression:"formModel.paper.width"}},[l("template",{slot:"prepend"},[o._v("宽")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.height,callback:function(e){o.$set(o.formModel.paper,"height",e)},expression:"formModel.paper.height"}},[l("template",{slot:"prepend"},[o._v("高")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.leftx,callback:function(e){o.$set(o.formModel.paper,"leftx",e)},expression:"formModel.paper.leftx"}},[l("template",{slot:"prepend"},[o._v("左偏移")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.topy,callback:function(e){o.$set(o.formModel.paper,"topy",e)},expression:"formModel.paper.topy"}},[l("template",{slot:"prepend"},[o._v("上偏移")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1)],1),o._v(" "),l("el-collapse-transition",[o.showDragDetail?l("div",[l("div",{staticClass:"prinit_aside_detail"},[l("span",[l("i",{staticClass:"el-icon-setting"}),o._v(" "+o._s(o.dragDetailInfo.filedName))]),o._v(" "),l("el-form-item",{staticClass:"print_itemSet_switch"},[l("el-switch",{attrs:{"active-color":"#67c23a","active-text":o.dragDetailInfo.isshow?"显示":"隐藏"},on:{change:o.handleSwitch},model:{value:o.dragDetailInfo.isshow,callback:function(e){o.$set(o.dragDetailInfo,"isshow",e)},expression:"dragDetailInfo.isshow"}})],1),o._v(" "),l("br"),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.width,callback:function(e){o.$set(o.dragDetailInfo,"width",e)},expression:"dragDetailInfo.width"}},[l("template",{slot:"prepend"},[o._v("宽")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.height,callback:function(e){o.$set(o.dragDetailInfo,"height",e)},expression:"dragDetailInfo.height"}},[l("template",{slot:"prepend"},[o._v("高")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.fontsize,callback:function(e){o.$set(o.dragDetailInfo,"fontsize",e)},expression:"dragDetailInfo.fontsize"}},[l("template",{slot:"prepend"},[o._v("字号")])],2)],1),o._v(" "),l("el-form-item",{staticClass:"print_itemSet_col"},[l("el-checkbox",{attrs:{label:"文字加粗",border:"",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.bold,callback:function(e){o.$set(o.dragDetailInfo,"bold",e)},expression:"dragDetailInfo.bold"}}),o._v(" "),l("el-radio-group",{attrs:{size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.alignment,callback:function(e){o.$set(o.dragDetailInfo,"alignment",e)},expression:"dragDetailInfo.alignment"}},o._l(o.alignmentOptions,function(e){return l("el-radio-button",{key:e.value,attrs:{label:e.value,border:""}},[o._v(o._s(e.label))])}))],1)],1)]):o._e()]),o._v(" "),l("div",{staticClass:"prinit_aside_setpreview"},[l("div",{staticClass:"prinit_aside_setpreview_head"},[l("span",[l("i",{staticClass:"el-icon-picture"}),o._v(" 打印背景图片效果预览")]),o._v(" "),o.imageUrl?l("el-button",{staticStyle:{float:"right","margin-left":"10px","margin-top":"5px"},attrs:{icon:o.isShowBkimg?"el-icon-news":"el-icon-view",size:o.btnsize},on:{click:o.toggleShowBkimg}},[o._v(o._s(o.isShowBkimg?"隐藏背景图":"显示背景图"))]):o._e(),o._v(" "),o.imageUrl?l("el-button",{staticStyle:{float:"right","margin-top":"5px"},attrs:{icon:"el-icon-delete",size:o.btnsize},on:{click:o.clearImgUrl}},[o._v("清除背景")]):o._e()],1),o._v(" "),l("Upload",{attrs:{title:"本地上传",listtype:"picture"},model:{value:o.imageUrl,callback:function(e){o.imageUrl=e},expression:"imageUrl"}})],1),o._v(" "),l("div",{staticClass:"prinit_aside_info"},[l("el-button",{attrs:{type:"warning",icon:"el-icon-document",size:o.btnsize},on:{click:function(e){o.resetForm("formModel")}}},[o._v("全部重置为默认值")])],1)],1)],1),o._v(" "),l("div",{staticClass:"print_main",on:{click:o.clickPanel}},[l("div",{staticClass:"print_main_head"},[l("b",[o._v("预览展示:")]),o._v(" "),l("span",[o._v(" 纸张(宽×高)："+o._s(this.formModel.paper.width+"(mm) × "+this.formModel.paper.height+"(mm)"))]),o._v(" "),l("div",{staticClass:"print_main_head_btns"},[l("label",{attrs:{for:""}},[o._v("默认打印机：")]),o._v(" "),l("el-select",{attrs:{size:"mini"},model:{value:o.formPrint.printSetting.ship,callback:function(e){o.$set(o.formPrint.printSetting,"ship",e)},expression:"formPrint.printSetting.ship"}},o._l(o.printers,function(e){return l("el-option",{key:e,attrs:{value:e,label:e}})})),o._v(" "),l("el-button",{attrs:{icon:"el-icon-printer",size:"mini",title:"打印测试"},on:{click:function(e){o.print("test")}}}),o._v(" "),l("el-button",{attrs:{icon:"el-icon-view",size:"mini",title:"打印预览"},on:{click:function(e){o.print("preview")}}}),o._v(" "),l("el-button",{attrs:{icon:"el-icon-view",size:"mini",title:"打印预览(包含背景图)"},on:{click:function(e){o.print("preview",!0)}}},[o._v("+ "),l("i",{staticClass:"el-icon-picture-outline"})])],1)]),o._v(" "),l("div",{key:o.viewKey,staticClass:"print_main_content",style:o.printPreviewContent,on:{drop:function(e){o.drop(e)},dragover:function(e){o.allowDrop(e)}}},o._l(o.labelListView,function(i,a){return l("div",{key:a,staticClass:"previewBlock",class:{isActiveDrag:o.classItem[a]},style:{cursor:o.dragCursor,transform:"translate("+i.leftx+"px,"+i.topy+"px)",width:i.width/o.prxvalue+"px",height:i.height/o.prxvalue+"px",fontSize:i.fontsize+"pt",whiteSpace:"nowrap",fontStyle:"Simsun",fontFamily:o.formPrint.printFontSetting.ship,fontWeight:i.bold?700:400,textAlign:o.alignmentValue[i.alignment]},attrs:{draggable:"true","data-fileName":i.filedValue,"data-index":i._index},on:{dragstart:function(e){return o.dragStart(e,i,a)},dragend:function(e){return o.dragEnd(e,i,a)},click:function(e){o.editDragItem(i,a,e)}}},[o.showDragTips[a]?l("div",{staticClass:"dragTips"},[o._v("\n          "+o._s("(x :"+Math.round(i.leftx*o.prxvalue)+" mm, y :"+Math.round(i.topy*o.prxvalue)+" mm)")+" "+o._s("(宽: "+i.width+" mm, 高: "+i.height+" mm)")+"\n          ")]):o._e(),o._v(" "),l("div",{staticClass:"dragSizeControler"},[l("span",[o._v(o._s(("customFields"===i.filedValue?"":"{")+i.filedName+("customFields"===i.filedValue?"":"}")))]),o._v(" "),l("div",{staticClass:"conrigth",on:{dragstart:function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"right");var t}}}),o._v(" "),l("div",{staticClass:"conbottom",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"bottom");var t}}}),o._v(" "),l("div",{staticClass:"conbottomright",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"bottomright");var t}}})])])})),o._v(" "),o.classItem.length?l("div",{staticClass:"print_main_foot"},[l("br"),o._v(" 按↑ ↓ ← →移动编辑项，按ctrl+↑↓控制高度变化，按ctrl+←→控制宽度变化\n      "),l("br"),o._v("按tab键切换编辑项，shift+tab切换回上一个编辑项\n    ")]):o._e()])])},staticRenderFns:[]};t.a=a},HtfE:function(e,t,i){"use strict";var a={render:function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],staticClass:"tms_dialog_print_drag",attrs:{title:"打印标签设置 (单位:毫米mm)",visible:o.dialogVisible,fullscreen:"","before-close":o.closeMe,"close-on-press-escape":!1},on:{"update:visible":function(e){o.dialogVisible=e}}},[l("div",{key:o.viewKey,staticClass:"print_aside"},[l("div",{staticClass:"print_aside_head"},[l("span",[l("i",{staticClass:"el-icon-menu"}),o._v(" 字段列表 "+o._s(o.formModel.labelList.length)+" ")]),o._v(" "),l("el-popover",{staticStyle:{float:"right","margin-top":"0px","margin-left":"10px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[l("span",[o._v("可将信息项手动拖拽到右边纸张中显示及设置位置和宽高；"),l("br"),o._v("(单位：毫米mm)")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("【快捷键：】")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("按↑ ↓ ← →移动编辑项，")]),o._v(" "),l("br"),l("span",[o._v("按ctrl+↑↓控制高度变化，")]),o._v(" "),l("br"),l("span",[o._v("按ctrl+←→控制宽度变化 ")]),o._v(" "),l("br"),o._v(" "),l("span",[o._v("按tab键切换编辑项，")]),o._v(" "),l("br"),l("span",[o._v("shift+tab切换回上一个编辑项")]),o._v(" "),l("i",{staticClass:"el-icon-warning",attrs:{slot:"reference"},slot:"reference"})]),o._v(" "),l("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"success",icon:"el-icon-document",size:o.btnsize},on:{click:function(e){o.submitForm("formModel")}}},[o._v("保存")]),o._v(" "),l("el-button",{staticStyle:{float:"right","margin-top":"10px","margin-right":"10px"},attrs:{icon:"el-icon-refresh",size:o.btnsize},on:{click:o.review}},[o._v("刷新")])],1),o._v(" "),l("div",{staticClass:"print_aside_search"},[l("el-autocomplete",{attrs:{"fetch-suggestions":o.querySearch,placeholder:"查找非自定义字段","popper-class":"popperHide",size:"mini",clearable:""},on:{select:o.handleSelect},model:{value:o.currentSearch,callback:function(e){o.currentSearch=e},expression:"currentSearch"}},[l("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),o._v(" "),l("el-form",{ref:"formModel",attrs:{model:o.formModel,rules:o.rules,"label-width":"0px"}},[l("div",{staticClass:"print_aside_content_form"},[l("label",[o._v("模板名称")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 6===t.type?l("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[l("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入模板名称(最多128个字符)",clearable:"",maxlength:128},nativeOn:{keyup:function(e){if(!("button"in e)&&o._k(e.keyCode,"enter",13,e.key,"Enter"))return null;o.addItemDrag(t,i)}},model:{value:o.modelNameSelf,callback:function(e){o.modelNameSelf=e},expression:"modelNameSelf"}})],1):o._e()})),o._v(" "),l("label",[o._v("发货人信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 1===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("收货人信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 2===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("标签主要信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 3===t.type?l("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){o.drag(e)},click:function(e){o.addItemDrag(t,i)}}},[l("el-tag",{attrs:{type:"info",size:o.tagSize}},[t.isshow?l("i",{staticClass:"el-icon-circle-check showLabel"}):o._e(),o._v(" "),l("b",[o._v(o._s(t.filedName))])])],1):o._e()})),o._v(" "),l("label",[o._v("自定义信息")]),o._v(" "),l("ul",{staticClass:"print_aside_content"},o._l(o.formModel.labelList,function(t,i){return 5===t.type?l("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[l("el-input",{attrs:{size:"mini",placeholder:"自定义标签(最多128个字符)",clearable:"",maxlength:128},nativeOn:{keyup:function(e){if(!("button"in e)&&o._k(e.keyCode,"enter",13,e.key,"Enter"))return null;o.addItemDrag(t,i)}},model:{value:o.labelSelf,callback:function(e){o.labelSelf=e},expression:"labelSelf"}}),o._v(" "),l("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(e){o.addItemDrag(t,i)}}},[o._v("添加")])],1):o._e()}))]),o._v(" "),l("div",{staticClass:"prinit_aside_paper"},[l("label",[l("i",{staticClass:"el-icon-edit"}),o._v(" 打印字体")]),o._v(" "),l("el-select",{attrs:{size:"mini"},model:{value:o.formPrint.printFontSetting.label,callback:function(e){o.$set(o.formPrint.printFontSetting,"label",e)},expression:"formPrint.printFontSetting.label"}},o._l(o.$const.PRINT_FONT,function(e,t){return l("el-option",{key:t,attrs:{value:e,label:e}})}))],1),o._v(" "),l("div",{staticClass:"prinit_aside_paper"},[l("span",[l("i",{staticClass:"el-icon-document"}),o._v(" 纸张设置")]),o._v(" "),l("br"),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.width,callback:function(e){o.$set(o.formModel.paper,"width",e)},expression:"formModel.paper.width"}},[l("template",{slot:"prepend"},[o._v("宽")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.height,callback:function(e){o.$set(o.formModel.paper,"height",e)},expression:"formModel.paper.height"}},[l("template",{slot:"prepend"},[o._v("高")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.leftx,callback:function(e){o.$set(o.formModel.paper,"leftx",e)},expression:"formModel.paper.leftx"}},[l("template",{slot:"prepend"},[o._v("左偏移")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.formModel.paper.topy,callback:function(e){o.$set(o.formModel.paper,"topy",e)},expression:"formModel.paper.topy"}},[l("template",{slot:"prepend"},[o._v("上偏移")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1)],1),o._v(" "),l("div",{staticClass:"prinit_aside_rotate"},[l("span",[l("i",{staticClass:"el-icon-refresh"}),o._v(" 内容-打印输出方向")]),o._v(" "),l("br"),o._v(" "),l("el-form-item",[l("el-radio-group",{attrs:{size:"mini"},on:{change:o.changePrintRotate},model:{value:o.printRotate.width,callback:function(e){o.$set(o.printRotate,"width",e)},expression:"printRotate.width"}},o._l(o.printRotateRule,function(e){return l("el-radio-button",{key:e.value,attrs:{label:e.value,border:""}},[o._v(o._s(e.label))])}))],1)],1),o._v(" "),l("el-collapse-transition",[o.showDragDetail?l("div",[l("div",{staticClass:"prinit_aside_detail"},[l("span",[l("i",{staticClass:"el-icon-setting"}),o._v(" "+o._s(o.dragDetailInfo.filedName))]),o._v(" "),l("el-form-item",{staticClass:"print_itemSet_switch"},[l("el-switch",{attrs:{"active-color":"#67c23a","active-text":o.dragDetailInfo.isshow?"显示":"隐藏"},on:{change:o.handleSwitch},model:{value:o.dragDetailInfo.isshow,callback:function(e){o.$set(o.dragDetailInfo,"isshow",e)},expression:"dragDetailInfo.isshow"}})],1),o._v(" "),l("br"),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.width,callback:function(e){o.$set(o.dragDetailInfo,"width",e)},expression:"dragDetailInfo.width"}},[l("template",{slot:"prepend"},[o._v("宽")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.height,callback:function(e){o.$set(o.dragDetailInfo,"height",e)},expression:"dragDetailInfo.height"}},[l("template",{slot:"prepend"},[o._v("高")]),o._v(" "),l("template",{slot:"append"},[o._v("mm")])],2)],1),o._v(" "),l("el-form-item",[l("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.fontsize,callback:function(e){o.$set(o.dragDetailInfo,"fontsize",e)},expression:"dragDetailInfo.fontsize"}},[l("template",{slot:"prepend"},[o._v("字号")])],2)],1),o._v(" "),l("el-form-item",{staticClass:"print_itemSet_col"},[l("el-checkbox",{attrs:{label:"文字加粗",border:"",size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.bold,callback:function(e){o.$set(o.dragDetailInfo,"bold",e)},expression:"dragDetailInfo.bold"}}),o._v(" "),l("el-radio-group",{attrs:{size:"mini"},on:{change:o.changeDragDetailInfo},model:{value:o.dragDetailInfo.alignment,callback:function(e){o.$set(o.dragDetailInfo,"alignment",e)},expression:"dragDetailInfo.alignment"}},o._l(o.alignmentOptions,function(e){return l("el-radio-button",{key:e.value,attrs:{label:e.value,border:""}},[o._v(o._s(e.label))])}))],1)],1)]):o._e()]),o._v(" "),l("div",{staticClass:"prinit_aside_setpreview"},[l("div",{staticClass:"prinit_aside_setpreview_head"},[l("span",[l("i",{staticClass:"el-icon-picture"}),o._v(" 打印背景图片效果预览")]),o._v(" "),o.imageUrl?l("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{icon:"el-icon-delete",size:o.btnsize},on:{click:o.clearImgUrl}},[o._v("清除背景")]):o._e()],1),o._v(" "),l("Upload",{attrs:{title:"本地上传",listtype:"picture"},model:{value:o.imageUrl,callback:function(e){o.imageUrl=e},expression:"imageUrl"}})],1),o._v(" "),l("div",{staticClass:"prinit_aside_info"},[l("el-button",{attrs:{type:"warning",icon:"el-icon-document",size:o.btnsize},on:{click:function(e){o.resetForm("formModel")}}},[o._v("全部重置为默认值")])],1)],1)],1),o._v(" "),l("div",{staticClass:"print_main",on:{click:o.clickPanel}},[l("div",{staticClass:"print_main_head"},[l("b",[o._v("预览展示:")]),o._v(" "),l("span",[o._v(" 纸张(宽×高)："+o._s(this.formModel.paper.width+"(mm) × "+this.formModel.paper.height+"(mm)"))]),o._v(" "),l("div",{staticClass:"print_main_head_btns"},[l("label",{attrs:{for:""}},[o._v("默认打印机：")]),o._v(" "),l("el-select",{attrs:{size:"mini"},model:{value:o.formPrint.printSetting.label,callback:function(e){o.$set(o.formPrint.printSetting,"label",e)},expression:"formPrint.printSetting.label"}},o._l(o.printers,function(e){return l("el-option",{key:e,attrs:{value:e,label:e}})})),o._v(" "),l("el-button",{attrs:{icon:"el-icon-printer",size:"mini",title:"打印测试"},on:{click:function(e){o.print("test")}}}),o._v(" "),l("el-button",{attrs:{icon:"el-icon-view",size:"mini",title:"打印预览"},on:{click:function(e){o.print("preview")}}})],1)]),o._v(" "),l("div",{key:o.viewKey,staticClass:"print_main_content",style:o.printPreviewContent,on:{drop:function(e){o.drop(e)},dragover:function(e){o.allowDrop(e)}}},o._l(o.labelListView,function(i,a){return l("div",{key:a,staticClass:"previewBlock",class:{isActiveDrag:o.classItem[a]},style:{cursor:o.dragCursor,transform:"translate("+i.leftx+"px,"+i.topy+"px)",width:i.width/o.prxvalue+"px",height:i.height/o.prxvalue+"px",fontSize:i.fontsize+"pt",whiteSpace:"nowrap",fontFamily:o.formPrint.printFontSetting.label,fontWeight:i.bold?800:400,textAlign:o.alignmentValue[i.alignment]},attrs:{draggable:"true","data-fileName":i.filedValue,"data-index":i._index},on:{dragstart:function(e){return o.dragStart(e,i,a)},dragend:function(e){return o.dragEnd(e,i,a)},click:function(e){o.editDragItem(i,a,e)}}},[o.showDragTips[a]?l("div",{staticClass:"dragTips"},[o._v("\n          "+o._s("(x :"+Math.round(i.leftx*o.prxvalue)+" mm, y :"+Math.round(i.topy*o.prxvalue)+" mm)")+" "+o._s("(宽: "+i.width+" mm, 高: "+i.height+" mm)")+"\n          ")]):o._e(),o._v(" "),l("div",{staticClass:"dragSizeControler"},[l("span",[o._v(o._s("{ "+i.filedName+" }"))]),o._v(" "),l("div",{staticClass:"conrigth",on:{dragstart:function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"right");var t}}}),o._v(" "),l("div",{staticClass:"conbottom",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"bottom");var t}}}),o._v(" "),l("div",{staticClass:"conbottomright",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,o.conrigthStart(t,i,a,"bottomright");var t}}})])])})),o._v(" "),o.classItem.length?l("div",{staticClass:"print_main_foot"},[l("br"),o._v(" 按↑ ↓ ← →移动编辑项，按ctrl+↑↓控制高度变化，按ctrl+←→控制宽度变化\n      "),l("br"),o._v("按tab键切换编辑项，shift+tab切换回上一个编辑项\n    ")]):o._e()])])},staticRenderFns:[]};t.a=a},P5E9:function(e,t,i){"use strict";var a=i("woOf"),o=i.n(a),l=i("UQm2"),n=i("6ThG"),r=i("0xDb");t.a={components:{},props:{popVisible:{type:Boolean,default:!1},formInfo:{type:[Object,Array],default:function(){}}},data:function(){return{btnsize:"mini",formModel:{heading_content:"",heading_word_size:"",content_word_size:"",print_page_num:"",content_wrap:"",printer:"",paper_width:"",left_distance:"",printing_direction:"",paper_height:"",top_distance:""},formPrint:{printFontSetting:{contract:""}},printers:[],fontSizes:[12,13,14,15,16,18,20,22,24,26,28,32,40,60],orgData:[]}},watch:{popVisible:function(){this.popVisible?(this.dialogVisible=!0,this.getPrintSetting(),this.formPrint=Object(r.objectMerge2)({},this.formInfo),console.log("formPrint",this.formPrint)):this.dialogVisible=!1}},computed:{dialogVisible:{get:function(){return this.popVisible},set:function(){}}},mounted:function(){this.getPrintSetting(),this.initPrinter()},methods:{initPrinter:function(){for(var e in this.printers=o()([],Object(l.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},savePrinter:function(){this.formInfo.printFontSetting.contract!==this.formPrint.printFontSetting.contract&&this.$emit("success",{contractFont:this.formPrint.printFontSetting.contract})},getPrintSetting:function(){var i=this;this.orgData=[],Object(n.c)({companyId:this.otherinfo.companyId,printType:1}).then(function(e){var t=e.data;t?(i.orgData=t).forEach(function(e){void 0!==i.formModel[e.fieldName]&&(i.formModel[e.fieldName]=e.fieldValue||"")}):i._handlerCatchMsg(e)}).catch(function(e){i._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},submitForm:function(e){var t=this,i=[];this.savePrinter(),this.orgData.forEach(function(e){void 0!==t.formModel[e.fieldName]&&(e.fieldValue=t.formModel[e.fieldName]),i.push(e)}),Object(n.f)({companyId:this.otherinfo.companyId,printType:1,settingList:i}).then(function(e){t.$message({type:"success",message:"打印设置成功！"}),t.closeMe()}).catch(function(e){t._handlerCatchMsg(e)})}}}},QMRQ:function(e,t,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"tms_dialog_print2",attrs:{title:"打印配载单设置",width:"990px",visible:t.dialogVisible,"before-close":t.closeMe,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"formModel",staticClass:"tms_dialog_print2-ruleForm",attrs:{inline:"",model:t.formModel,size:t.btnsize,"label-width":"100px"}},[i("h3",[t._v("打印内容")]),t._v(" "),i("el-form-item",{staticClass:"tms_dialog_print2-title",attrs:{label:"标题"}},[i("el-input",{attrs:{maxlength:30,autocomplete:"off"},model:{value:t.formModel.heading_content,callback:function(e){t.$set(t.formModel,"heading_content",e)},expression:"formModel.heading_content"}})],1),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"标题字号"}},[i("el-select",{model:{value:t.formModel.heading_word_size,callback:function(e){t.$set(t.formModel,"heading_word_size",e)},expression:"formModel.heading_word_size"}},t._l(t.fontSizes,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"内容字号"}},[i("el-select",{model:{value:t.formModel.content_word_size,callback:function(e){t.$set(t.formModel,"content_word_size",e)},expression:"formModel.content_word_size"}},t._l(t.fontSizes,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"其它："}},[i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",label:"打印页码"},model:{value:t.formModel.print_page_num,callback:function(e){t.$set(t.formModel,"print_page_num",e)},expression:"formModel.print_page_num"}}),t._v(" "),i("el-checkbox",{attrs:{"true-label":"1","false-label":"0",label:"内容是否换行"},model:{value:t.formModel.content_wrap,callback:function(e){t.$set(t.formModel,"content_wrap",e)},expression:"formModel.content_wrap"}})],1),t._v(" "),i("h3",[t._v("打印参数")]),t._v(" "),i("el-form-item",{attrs:{label:"默认打印机"}},[i("el-select",{model:{value:t.formModel.printer,callback:function(e){t.$set(t.formModel,"printer",e)},expression:"formModel.printer"}},t._l(t.printers,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"纸张宽度(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.paper_width,callback:function(e){t.$set(t.formModel,"paper_width",e)},expression:"formModel.paper_width"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"左边距(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.left_distance,callback:function(e){t.$set(t.formModel,"left_distance",e)},expression:"formModel.left_distance"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"打印方向"}},[i("el-select",{model:{value:t.formModel.printing_direction,callback:function(e){t.$set(t.formModel,"printing_direction",e)},expression:"formModel.printing_direction"}},[i("el-option",{key:"2",attrs:{value:"2",label:"横向"}}),t._v(" "),i("el-option",{key:"1",attrs:{value:"1",label:"竖向"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"纸张高度(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.paper_height,callback:function(e){t.$set(t.formModel,"paper_height",e)},expression:"formModel.paper_height"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"上边距(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.top_distance,callback:function(e){t.$set(t.formModel,"top_distance",e)},expression:"formModel.top_distance"}})],1),t._v(" "),i("h3",[t._v("其他设置")]),t._v(" "),i("el-form-item",{attrs:{label:"打印字体"}},[i("el-select",{attrs:{size:"mini"},model:{value:t.formPrint.printFontSetting.load,callback:function(e){t.$set(t.formPrint.printFontSetting,"load",e)},expression:"formPrint.printFontSetting.load"}},t._l(t.$const.PRINT_FONT,function(e,t){return i("el-option",{key:t,attrs:{value:e,label:e}})}))],1),t._v(" "),i("div",{staticClass:"tms_dialog_print2-footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm2")}}},[t._v("保存")]),t._v(" "),i("el-button",{on:{click:t.closeMe}},[t._v("关闭")])],1)],1)],1)},staticRenderFns:[]};t.a=a},RCWJ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("oSqW"),o=i("HtfE"),l=i("VU/8")(a.a,o.a,null,null,null);t.default=l.exports},SAxw:function(e,t,i){"use strict";var a=i("woOf"),d=i.n(a),o=i("DAYN"),l=i.n(o),r=i("oagj"),f=i("0xDb"),n=i("6ThG"),s=i("Zjyc"),c=i("UQm2"),u=(i("i7Ou"),"");t.a={components:{draggable:l.a,Upload:s.a},props:{popVisible:{type:Boolean,default:!1},formInfo:{type:[Object,Array],default:function(){}}},data:function(){return{isShowBkimg:!0,tagSize:"mini",bgLabelObj:{width:0,height:0,topy:0,leftx:0},formPrint:{printSetting:{ship:""},printFontSetting:{ship:""}},cargoLabelList:[[],[],[]],cargoNum:1,maxCargo:3,printers:[],currentSearch:"",labelSelf:"",labelIndex:0,loading:!0,imageUrl:"",btnsize:"mini",bgprop:{scale:1,x:0,y:0},formModel:{labelList:[],paper:{width:0,height:0,leftx:0,topy:0}},defaultLabelWidth:150,defaultLabelHeight:30,defaultLabelFontSize:12,defaultPaperWidth:240,defaultPaperHeight:140,imgNameStr:"预览图片TMS,",prxvalue:.264,mm2px:3.779,maxLabel:3,maxLabelSelf:19,classItem:[],orgLabelList:[],labelListView:[],rules:{},viewKey:0,flags:!1,isDragView:!1,isMove:!1,showDragDetail:!1,showDragTips:[],isShowDragTips:!0,isHiddenDragDetail:!0,isDrag:null,dragDetailInfo:{},dragCursor:"move",alignmentValue:["","left","center","right"],alignmentOptions:[{value:1,label:"文字靠左"},{value:2,label:"文字居中"},{value:3,label:"文字靠右"}],dialogVisible:!1,commonLabelList:[],cargoKey:0,modelNameSelf:""}},watch:{imageUrl:{handler:function(e,t){console.log("图片",e,t),e!==t&&(this.isShowBkimg=!0)},deep:!0},formInfo:{handler:function(e,t){},deep:!0},popVisible:function(){this.popVisible?(this.dialogVisible=!0,this.loading=!0,this.init(),this.bindKey()):(this.dialogVisible=!1,this.unbindKey())},bgprop:{handler:function(e,t){e&&(this.imageUrl&&this.isShowBkimg&&(this.bgLabelObj.width=Math.round(this.printPreviewContent.width.slice(0,-2)*this.prxvalue*this.bgprop.scale),this.bgLabelObj.height=Math.round(this.printPreviewContent.height.slice(0,-2)*this.prxvalue*this.bgprop.scale),this.bgLabelObj.leftx=e.x,this.bgLabelObj.topy=e.y),console.log("bgprop",e,e.scale,e.x,e.y,this.printPreviewContent,this.bgLabelObj,this.isShowBkimg))},deep:!0}},computed:{printPreviewContent:function(){var e=300,t=150,i=this.isShowBkimg?this.imageUrl:"";return this.formModel&&(e=this.formModel.paper.width,t=this.formModel.paper.height),{width:e/this.prxvalue+"px",height:t/this.prxvalue+"px",backgroundImage:"url("+i+")",backgroundRepeat:"no-repeat",backgroundSize:100*this.bgprop.scale+"% auto",backgroundPosition:this.bgLabelObj.leftx+"px "+this.bgLabelObj.topy+"px"}},printPreviewPaper:function(){},isActiveDrag:function(){return{}}},mounted:function(){},destroyed:function(){this.unbindKey(),this.closeMe()},methods:{toggleShowBkimg:function(){this.imageUrl&&(this.isShowBkimg=!this.isShowBkimg)},showCargoPlus:function(){var a=this,e=function(e){a.cargoLabelList[e].forEach(function(i){a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&(i._index=++a.labelIndex,i.showCargo=!0,a.$set(a.formModel.labelList,t,i))}),a.orgLabelList.forEach(function(e,t){i.filedValue===e.filedValue&&(i.showCargo=!0,a.$set(a.orgLabelList,t,i))})})};this.cargoNum<this.maxCargo?(this.cargoNum=this.cargoNum+1,e(this.cargoNum-1),this.cargoKey=(new Date).getTime()):(3===this.cargoNum&&e(1),this.$message({type:"warning",message:"最多添加"+this.maxCargo+"套货物信息"}))},init:function(){this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.initPrinter(),this.formPrint=Object(f.objectMerge2)({},this.formInfo),this.loading=!0,this.isShowBkimg=!0,this.getCommonSettingOrder(),console.log("formInfo init",this.formPrint)},print:function(e){var t=this,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=Object(f.objectMerge2)([],this.labelListView),o={};a.push(Object(f.objectMerge2)({},this.formModel.paper)),a.forEach(function(e){e.width=Math.round(e.width/t.prxvalue),e.height=Math.round(e.height/t.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,e.isshow=e.isshow?1:0,e.value=e.filedName,"setting"===e.filedValue&&(e.bold=0,e.fontsize=null,e.alignment=null,e.value=""),t.imageUrl&&i&&(console.log("要预览背景图片"),(o=Object(f.objectMerge2)({},e)).filedName=t.imgNameStr+t.imageUrl,o.isshow=0)}),this.imageUrl&&i&&a.push(o),Object(c.a)({orderdata:a,number:1,printer:this.formPrint.printSetting.ship,fontFamily:this.formPrint.printFontSetting.ship,printSetup:a,type:"order",preview:"preview"===e,mock:!0,bkimg:i})},initPrinter:function(){for(var e in this.printers=d()([],Object(c.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},clearImgUrl:function(){this.imageUrl="",this.bgLabelObj=this.$options.data().bgLabelObj},querySearch:function(t,e){this.currentSearch=t;var i=Object(f.objectMerge2)([],this.orgLabelList),a=t?i.filter(function(e){return-1!==e.filedName.indexOf(t)}):i;this.formModel.labelList=Object(f.objectMerge2)([],a),e(a)},handleSelect:function(e){console.log("handleSelect item",e)},bindKey:function(){document.addEventListener("mousemove",this.conrightMove,!0),document.addEventListener("mouseup",this.conrightEnd,!0),document.addEventListener("keyup",this.deleteEditIndex,!0),document.addEventListener("keydown",this.controlEditIndex,!0)},unbindKey:function(){document.removeEventListener("mousemove",this.conrightMove),document.removeEventListener("mouseup",this.conrightEnd),document.removeEventListener("keyup",this.deleteEditIndex),document.removeEventListener("keydown",this.controlEditIndex)},startSetBg:function(e){var t=this;clearInterval(this.bgtimer),this.bgtimer=setInterval(function(){t.setBg(e)},100)},stopSetBg:function(e){clearInterval(this.bgtimer)},setBg:function(e){var t=this.bgprop.scale;switch(e){case"zoomOut":t=2<(t+=.05)?2:t,this.bgprop.scale=t;break;case"zoomIn":t=(t-=.05)<.5?.5:t,this.bgprop.scale=t;break;case"moveLeft":this.bgprop.x-=1;break;case"moveRight":this.bgprop.x+=1;break;case"moveUp":this.bgprop.y-=1;break;case"moveDown":this.bgprop.y+=1;break;case"reset":this.bgprop={scale:1,x:0,y:0}}},conrigthStart:function(e,t,i,a){this.isHiddenDragDetail=!1,t.x=e.pageX,t.y=e.pageY,t.orgwidth=Math.round(t.width/this.prxvalue),t.orgheight=Math.round(t.height/this.prxvalue),t.mousetype=a,this.isDrag=t},conrightMove:function(e){if(this.isDrag){var t=this.isDrag,i=t.mousetype,a=e.pageX-t.x,o=e.pageY-t.y;this.calcWH(t,a,o,i)}},calcWH:function(e,t,i,a){var o=e.orgwidth,l=e.orgheight;"right"!==a&&"bottomright"!==a||(o+=t),"bottom"!==a&&"bottomright"!==a||(l+=i),o=o<15?15:1e3<o?1e3:o,l=l<20?20:1e3<l?1e3:l,e.width=Math.round(o*this.prxvalue),e.height=Math.round(l*this.prxvalue)},conrightEnd:function(e){if(this.isDrag){var t=this.isDrag;t.x=e.pageX,t.y=e.pageY,this.isDrag=null}},addItemDrag:function(i,e){var a=this,t=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;"customFields"===i.filedValue&&((i=Object(f.objectMerge2)({},i)).topy=0,i.leftx=0,i.filedName=this.labelSelf,setTimeout(function(){a.labelSelf=""},300));var o=function(){i.isshow=!0,i.fontsize=a.defaultLabelFontSize,a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&a.$set(a.formModel.labelList,t,i)}),console.log("row::::",i);var e=Object(f.objectMerge2)({},i);e._index=a.labelIndex++,e.width=Math.round(a.defaultLabelWidth*a.prxvalue),e.height=Math.round(a.defaultLabelHeight*a.prxvalue),e.fontsize=a.defaultLabelFontSize,e.bold=0,e.alignment=1,a.labelListView.push(Object(f.objectMerge2)({},e)),a.orgLabelList.forEach(function(e,t){e.filedValue===i.filedValue&&a.$set(a.orgLabelList,t,Object(f.objectMerge2)({},i))}),a.editDragItem(e,a.labelListView.length-1)};"customFields"===i.filedValue&&t<this.maxLabelSelf?o():t<this.maxLabel?o():this.$notify.info({title:"消息",message:"【 "+i.filedName+" 】最多添加"+("customFields"===i.filedValue?this.maxLabelSelf:this.maxLabel)+"次"})},clickPanel:function(e){var i=0;e.path.forEach(function(e,t){e.className&&-1!==e.className.indexOf("previewBlock")&&(i+=1)}),i||(this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.isHiddenDragDetail=!0),i=0},editDragItem:function(e,t,i){this.dragDetailInfo={},this.dragDetailInfo=Object(f.objectMerge2)({},e),console.log("编辑显示项",this.dragDetailInfo,e,e._index,t,i),this.classItem=[],this.showDragTips=[],this.classItem[t]&&i&&this.isHiddenDragDetail?(this.showDragDetail=!1,this.isHiddenDragDetail=!1):(this.isHiddenDragDetail=!0,this.classItem[t]=!0,this.showDragDetail=!0),this.showDragTips[t]=!0},changeDragDetailInfo:function(e){var i=this;e&&(this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.$set(i.labelListView,t,i.dragDetailInfo)}),this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList,t,i.dragDetailInfo),"setting"===e.filedValue&&(i.$set(i.formModel.labelList,t,i.formModel.paper),console.log("this.formModel.paper:",i.formModel.paper))}))},review:function(){this.showDragDetail=!1,this.viewKey=(new Date).getTime(),this.formModel.labelList=[],this.orgLabelList=[],this.labelListView=[],this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.initPrinter(),this.getCommonSettingOrder(),this.dragDetailInfo={},this.isDrag=null},dragStart:function(i,e,t){if(console.log("dragStart",i,e,t),this.showDragTips[t]=!0,this.isDrag)return console.log("dragStart"),!1;this.isDragView=!0;(u=i.currentTarget).getAttribute("data-fileName");var a=Number(u.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e,t){e._index===a&&(e.x=i.pageX,e.y=i.pageY)})},dragEnd:function(t,e,i){if(this.isDrag)return console.log("dragEnd"),!1;this.isDragView=!0;(u=t.currentTarget).getAttribute("data-fileName");var a=Number(u.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e){e._index===a&&(e.leftx+=t.pageX-e.x,e.topy+=t.pageY-e.y)}),console.log(e.leftx,e.width),Math.round(e.leftx*this.prxvalue)+e.width<0||Math.round(e.topy*this.prxvalue)+e.height<0||e.leftx>Math.round(this.formModel.paper.width/this.prxvalue)||e.topy>Math.round(this.formModel.paper.height/this.prxvalue)?(this.dragCursor="not-allowed",this.deleteItemByIndex(e,i)):this.editDragItem(e,i),this.dragCursor="move",this.showDragTips=[]},deleteItemByIndex:function(i,a){var o=this;i.isshow=!1,this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.labelListView=Object(f.objectMerge2)([],this.labelListView).filter(function(e,t){return t!==a});var e=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;console.log("删除的"+i.filedValue+"还有"+e+"个"),0===e&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.filedValue&&(o.$set(e,"isshow",!1),console.log("labelList上的row",e.filedValue,e.isshow))}),this.orgLabelList=Object(f.objectMerge2)([],this.formModel.labelList))},handleKeyEvent:function(e,t,i){var a=this,o=r.a.getPressedKey(e),l=event.target.tagName||event.srcElement.tagName;if("INPUT"!==l&&"SELECT"!==l&&"TEXTAREA"!==l&&-1!==t.indexOf(o)&&this.dragDetailInfo.filedValue){var n={};this.labelListView.filter(function(e,t){return a.dragDetailInfo._index===e._index&&(n.el=e,n.index=t,!0)}),n.el&&i(n,o,e)}},deleteEditIndex:function(e){var i=this;this.handleKeyEvent(e,["delete","backspace"],function(e,t){i.deleteItemByIndex(e.el,e.index)})},controlEditIndex:function(e){var l=this;this.handleKeyEvent(e,["tab","shift+tab"],function(e,t,i){i.preventDefault();var a=e.index;"tab"===t?a++:a--,a=a>=l.labelListView.length?0:a<0?l.labelListView.length-1:a,l.editDragItem(l.labelListView[a],a,i)}),this.handleKeyEvent(e,["<ctrl></ctrl><up></up>","ctrl+down","ctrl+left","ctrl+right"],function(e,t,i){i.preventDefault();var a=/(up|down)/.test(t)?"height":"width",o=e.el[a];switch(t){case"ctrl+up":case"ctrl+left":o-=1;break;case"ctrl+down":case"ctrl+right":o+=1}o=o<5?5:o>l.formModel.paper.width?l.formModel.paper.width:o,e.el[a]=o}),this.handleKeyEvent(e,["up","down","left","right"],function(e,t){var i=/(up|down)/.test(t)?"topy":"leftx",a=e.el[i];console.log("val",e,e.el,a,i);var o=0;switch(o=Math.round(a/l.mm2px)*l.mm2px,t){case"up":case"left":o-=l.mm2px;break;case"down":case"right":o+=l.mm2px}e.el[i]=o})},drag:function(e){this.isDragView=!1,this.isMove=!1,u=e.currentTarget},drop:function(t){var i=this;t.preventDefault();var a=u.getAttribute("data-fileName");this.isMove||this.orgLabelList.filter(function(e){e.filedValue!==a||i.isDragView||(e.leftx=t.offsetX,e.topy=t.offsetY,i.addItemDrag(e))})},allowDrop:function(e){e.preventDefault()},sortLabel:function(e,o){return e.sort(function(e,t){var i=e[o],a=t[o];return i.length-a.length})},getCommonSettingOrder:function(){var a=this;this.loading=!0,this.commonLabelList=[],Object(n.b)().then(function(e){e&&(Object(f.objectMerge2)([],e).forEach(function(e,t){var i={id:e.id,filedValue:e.fieldValue,filedName:e.fieldName||"",topy:0,leftx:0,width:0,height:0,companyId:a.otherinfo.companyId,isshow:0,fontsize:10,alignment:1,bold:0,type:e.type};a.commonLabelList.push(i)}),a.sortLabel(a.commonLabelList,"filedName"),a.$nextTick(function(){a.getSettingCompanyOrder()}))}).catch(function(e){a.loading=!1,a._handlerCatchMsg(e)})},getSettingCompanyOrder:function(){var r=this;this.labelListView=[],this.orgLabelList=[],this.viewKey=(new Date).getTime();var s=!1,c=!1;this.isShowBkimg=!0,this.bgprop.scale=this.$options.data().bgprop.scale,this.loading=!0,Object(n.e)().then(function(a){var o=d()([],a||[]);r.cargoNum=r.$options.data().cargoNum;var l=[],n=Object(f.objectMerge2)([],r.commonLabelList);o.forEach(function(i){n.forEach(function(e,t){e.filedValue===i.filedValue&&(i.isshow||"setting"===e.filedValue||(i.width=r.defaultLabelWidth,i.height=r.defaultLabelHeight),"setting"===e.filedValue&&(r.$set(r.formModel.labelList,t,i),r.formModel.labelList[t]=i),r.$set(i,"type",e.type),4===i.type&&("2"===i.filedName.slice(-1)&&(s=!0,r.cargoNum=2),"3"===i.filedName.slice(-1)&&(c=!0,r.cargoNum=3)),n.splice(t,1),l.push(i))})}),r.formModel.labelList=Object(f.objectMerge2)([],l.concat(n)),r.formModel.labelList.forEach(function(t,e){if(t.width=Math.round((t.width?t.width:r.defaultLabelWidth)*r.prxvalue),t.height=Math.round((t.height?t.height:r.defaultLabelHeight)*r.prxvalue),"setting"===t.filedValue){var i=d()({},t);a||(i.width=r.defaultPaperWidth,i.height=r.defaultPaperHeight),i.leftx=Math.round(i.leftx*r.prxvalue),i.topy=Math.round(i.topy*r.prxvalue),r.formModel.paper=i}else o.forEach(function(e){e.filedValue===t.filedValue&&(e.isshow?(e.width=Math.round((e.width?e.width:r.defaultLabelWidth)*r.prxvalue),e.height=Math.round((e.height?e.height:r.defaultLabelHeight)*r.prxvalue),e.fontsize=e.fontsize?e.fontsize:10,e.isshow=1===e.isshow,e.bold=2===e.bold,e.alignment=e.alignment||1,e._index=r.labelIndex++,r.labelListView.push(e)):-1!==e.filedName.indexOf(r.imgNameStr)&&(console.log("11111111111111111",e.isshow,e.filedName,r.imgNameStr),r.imageUrl=e.filedName.split(",")[1],console.log("22222222222222",r.imageUrl),r.bgLabelObj.width=e.width,r.bgLabelObj.height=e.height,r.bgLabelObj.topy=e.topy,r.bgLabelObj.leftx=e.leftx,r.bgprop.scale=e.width?Math.round(e.width/r.formModel.paper.width):1,r.bgprop.x=e.leftx,r.bgprop.y=e.topy,console.log("放大%",e,r.bgprop.scale)))}),t.fontsize=t.fontsize?t.fontsize:10,t.isshow=1===t.isshow,t.bold=2===t.bold,t.alignment=t.alignment||1;if(4===t.type)switch(t.showCargo=!1,t.filedName.slice(-1)){case"2":s&&(t.showCargo=!0),r.cargoLabelList[1].push(t);break;case"3":c&&(t.showCargo=!0),r.cargoLabelList[2].push(t);break;default:t.showCargo=!0,r.cargoLabelList[0].push(t)}6===t.type&&(r.modelNameSelf=t.filedName)}),r.orgLabelList=Object(f.objectMerge2)([],r.formModel.labelList),r.loading=!1}).catch(function(e){r.loading=!1,r._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},checkNull:function(e){return null!=e&&""!==e&&void 0},resetForm:function(e){var i=this;this.$refs[e].validate(function(e){e&&i.$confirm("此操作将所有设置重置为0,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.formModel.labelList.forEach(function(e,t){"setting"!==e.filedValue&&(e.topy=0,e.leftx=0,e.isshow=0,e.width=Math.round(i.defaultLabelWidth*i.prxvalue),e.height=Math.round(i.defaultLabelHeight*i.prxvalue),e.fontsize=10,e.bold=0,e.alignment=1)}),i.formModel.paper.width=i.defaultPaperWidth,i.formModel.paper.height=i.defaultPaperHeight,i.formModel.paper.topy=0,i.formModel.paper.leftx=0,i.labelListView=[],i.showDragDetail=!1,i.currentSearch=""}).catch(function(e){})})},canDragStart:function(e){},handleSwitch:function(e){var i=this,a=0;this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.labelListView.splice(t,1),e.filedValue===i.dragDetailInfo.filedValue&&(a+=1)}),1===a&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList[t],"isshow",!1)}),this.orgLabelList=Object(f.objectMerge2)([],this.formModel.labelList)),this.$nextTick(function(){i.showDragDetail=!1})},changeValue:function(e,t,i){this.viewKey=(new Date).getTime()},savePrinter:function(){this.formInfo.printSetting.ship===this.formPrint.printSetting.ship&&this.formInfo.printFontSetting.ship===this.formPrint.printFontSetting.ship||this.$emit("success",{ship:this.formPrint.printSetting.ship,shipFont:this.formPrint.printFontSetting.ship})},submitForm:function(e){var o=this;this.$refs[e].validate(function(e){if(e){o.savePrinter(),o.loading=!0,o.showDragDetail=!1;var t=Object(f.objectMerge2)([],o.labelListView),i={},a={};t.push(Object(f.objectMerge2)({},o.formModel.paper)),o.formModel.labelList.forEach(function(e){"customFields"===e.filedValue&&o.imageUrl&&((i=Object(f.objectMerge2)({},e)).width=o.bgLabelObj.width,i.height=o.bgLabelObj.height,i.topy=o.bgLabelObj.topy,i.leftx=o.bgLabelObj.leftx,i.filedName=o.imgNameStr+o.imageUrl,i.isshow=!1,console.log(" 提交的时候 imageUrl1",o.imageUrl,i)),6===e.type&&((a=Object(f.objectMerge2)({},e)).filedName=o.modelNameSelf+"",a.isshow=!1,t.push(a))}),o.imageUrl&&t.push(i),t=Object(f.objectMerge2)([],t).filter(function(e){var t=function(){e.width=Math.round(e.width/o.prxvalue),e.height=Math.round(e.height/o.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,"setting"===e.filedValue&&(console.log("this.formModel.paper::",o.formModel.paper,e),e.leftx=Math.round(o.formModel.paper.leftx/o.prxvalue),e.topy=Math.round(o.formModel.paper.topy/o.prxvalue))};return"setting"!==e.filedValue&&"modelName"!==e.filedValue?!(Math.round(e.leftx*o.prxvalue)+e.width<0||Math.round(e.topy*o.prxvalue)+e.height<0||e.leftx>Math.round(o.formModel.paper.width/o.prxvalue)||e.topy>Math.round(o.formModel.paper.height/o.prxvalue))&&(t(),!0):(t(),!0)}),Object(n.h)(t).then(function(e){o.loading=!1,o.$message({type:"success",message:"运单打印设置成功！"}),o.getCommonSettingOrder(),o.viewKey=(new Date).getTime()}).catch(function(e){o.loading=!1,o._handlerCatchMsg(e)})}})}}}},Z2is:function(e,t,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"tms_dialog_print2",attrs:{title:"打印合同设置",width:"990px",visible:t.dialogVisible,"before-close":t.closeMe,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"formModel",staticClass:"tms_dialog_print2-ruleForm",attrs:{inline:"",model:t.formModel,size:t.btnsize,"label-width":"100px"}},[i("h3",[t._v("打印内容")]),t._v(" "),i("el-form-item",{staticClass:"tms_dialog_print2-title",attrs:{label:"标题"}},[i("el-input",{attrs:{maxlength:30,autocomplete:"off"},model:{value:t.formModel.heading_content,callback:function(e){t.$set(t.formModel,"heading_content",e)},expression:"formModel.heading_content"}})],1),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"标题字号"}},[i("el-select",{model:{value:t.formModel.heading_word_size,callback:function(e){t.$set(t.formModel,"heading_word_size",e)},expression:"formModel.heading_word_size"}},t._l(t.fontSizes,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"内容字号"}},[i("el-select",{model:{value:t.formModel.content_word_size,callback:function(e){t.$set(t.formModel,"content_word_size",e)},expression:"formModel.content_word_size"}},t._l(t.fontSizes,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("br"),t._v(" "),i("h3",[t._v("打印参数")]),t._v(" "),i("el-form-item",{attrs:{label:"默认打印机"}},[i("el-select",{model:{value:t.formModel.printer,callback:function(e){t.$set(t.formModel,"printer",e)},expression:"formModel.printer"}},t._l(t.printers,function(e){return i("el-option",{key:e,attrs:{value:e,label:e}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"纸张宽度(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.paper_width,callback:function(e){t.$set(t.formModel,"paper_width",e)},expression:"formModel.paper_width"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"左边距(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.left_distance,callback:function(e){t.$set(t.formModel,"left_distance",e)},expression:"formModel.left_distance"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"打印方向"}},[i("el-select",{model:{value:t.formModel.printing_direction,callback:function(e){t.$set(t.formModel,"printing_direction",e)},expression:"formModel.printing_direction"}},[i("el-option",{key:"2",attrs:{value:"2",label:"横向"}}),t._v(" "),i("el-option",{key:"1",attrs:{value:"1",label:"竖向"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"纸张高度(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.paper_height,callback:function(e){t.$set(t.formModel,"paper_height",e)},expression:"formModel.paper_height"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"上边距(mm)"}},[i("el-input",{attrs:{maxlength:5,autocomplete:"off"},model:{value:t.formModel.top_distance,callback:function(e){t.$set(t.formModel,"top_distance",e)},expression:"formModel.top_distance"}})],1),t._v(" "),i("h3",[t._v("其他设置")]),t._v(" "),i("el-form-item",{attrs:{label:"打印字体"}},[i("el-select",{attrs:{size:"mini"},model:{value:t.formPrint.printFontSetting.contract,callback:function(e){t.$set(t.formPrint.printFontSetting,"contract",e)},expression:"formPrint.printFontSetting.contract"}},t._l(t.$const.PRINT_FONT,function(e,t){return i("el-option",{key:t,attrs:{value:e,label:e}})}))],1),t._v(" "),i("div",{staticClass:"tms_dialog_print2-footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm2")}}},[t._v("保存")]),t._v(" "),i("el-button",{on:{click:t.closeMe}},[t._v("关闭")])],1)],1)],1)},staticRenderFns:[]};t.a=a},aCZp:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("zsRk"),o=i("QMRQ"),l=i("VU/8")(a.a,o.a,null,null,null);t.default=l.exports},oSqW:function(e,t,i){"use strict";var a=i("woOf"),d=i.n(a),o=i("DAYN"),l=i.n(o),r=i("oagj"),f=i("0xDb"),n=i("Zjyc"),s=i("UQm2"),u=(i("i7Ou"),i("6ThG")),c="";t.a={components:{draggable:l.a,Upload:n.a},props:{popVisible:{type:Boolean,default:!1},formInfo:{type:[Object,Array],default:function(){}}},data:function(){return{tagSize:"mini",formPrint:{printSetting:{label:""},printFontSetting:{label:""}},printRotate:{width:0,filedValue:"settingRotate",filedName:"打印方向"},printRotateRule:[{value:0,label:"还原"},{value:180,label:"旋转180°"}],cargoLabelList:[[],[],[]],cargoNum:1,maxCargo:3,printers:[],currentSearch:"",labelSelf:"",labelIndex:0,loading:!0,imageUrl:"",btnsize:"mini",bgprop:{scale:1,x:0,y:0},formModel:{labelList:[],paper:{width:0,height:0,leftx:0,topy:0}},defaultLabelWidth:150,defaultLabelHeight:30,defaultLabelFontSize:12,defaultPaperWidth:80,defaultPaperHeight:80,imgNameStr:"预览图片lyy,",prxvalue:.264,mm2px:3.779,maxLabel:3,maxLabelSelf:19,classItem:[],orgLabelList:[],labelListView:[],rules:{},viewKey:0,flags:!1,isDragView:!1,isMove:!1,showDragDetail:!1,showDragTips:[],isShowDragTips:!0,isHiddenDragDetail:!0,isDrag:null,dragDetailInfo:{},dragCursor:"move",alignmentValue:["","left","center","right"],alignmentOptions:[{value:1,label:"文字靠左"},{value:2,label:"文字居中"},{value:3,label:"文字靠右"}],dialogVisible:!1,commonLabelList:[],cargoKey:0,modelNameSelf:""}},watch:{imageUrl:{handler:function(e,t){console.log("图片",e,t)},deep:!0},formInfo:{handler:function(e,t){},deep:!0},popVisible:function(){this.popVisible?(this.dialogVisible=!0,this.loading=!0,this.init(),this.bindKey()):(this.dialogVisible=!1,this.unbindKey())}},computed:{printPreviewContent:function(){var e=300,t=150,i=this.imageUrl;return this.formModel&&(e=this.formModel.paper.width,t=this.formModel.paper.height),{width:e/this.prxvalue+"px",height:t/this.prxvalue+"px",backgroundImage:"url("+i+")",backgroundRepeat:"no-repeat",backgroundSize:100*this.bgprop.scale+"% auto",backgroundPosition:this.bgprop.x+"px "+this.bgprop.y+"px"}},printPreviewPaper:function(){},isActiveDrag:function(){return{}}},mounted:function(){},destroyed:function(){this.unbindKey(),this.closeMe()},methods:{changePrintRotate:function(e){this.printRotate.width=e,console.log(e,this.printRotate)},showCargoPlus:function(){var a=this;console.log("cargoNum",this.cargoNum),this.cargoNum<this.maxCargo?(this.cargoNum=this.cargoNum+1,this.cargoLabelList[this.cargoNum-1].forEach(function(i){a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&(i.showCargo=!0,a.$set(a.formModel.labelList,t,i))})}),this.cargoKey=(new Date).getTime()):this.$message({type:"warning",message:"最多添加"+this.maxCargo+"套货物信息"})},init:function(){this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.initPrinter(),this.formPrint=Object(f.objectMerge2)({},this.formInfo),this.getCommonSettingLib()},print:function(e){var t=this,i=Object(f.objectMerge2)([],this.labelListView);i.push(Object(f.objectMerge2)({},this.formModel.paper)),i.push(Object(f.objectMerge2)({},this.printRotate)),i.forEach(function(e){e.width=Math.round(e.width/t.prxvalue),e.height=Math.round(e.height/t.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,e.isshow=e.isshow?1:0,e.value=e.filedName,"setting"===e.filedValue&&(e.bold=0,e.fontsize=null,e.alignment=null,e.value="")}),Object(s.a)({orderdata:i,number:1,printer:this.formPrint.printSetting.label,printSetup:i,type:"order",fontFamily:this.formPrint.printFontSetting.label,preview:"preview"===e,mock:!0})},initPrinter:function(){for(var e in this.printers=d()([],Object(s.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},clearImgUrl:function(){this.imageUrl=""},querySearch:function(t,e){this.currentSearch=t;var i=Object(f.objectMerge2)([],this.orgLabelList),a=t?i.filter(function(e){return-1!==e.filedName.indexOf(t)}):i;this.formModel.labelList=Object(f.objectMerge2)([],a),e(a)},handleSelect:function(e){console.log("handleSelect item",e)},bindKey:function(){document.addEventListener("mousemove",this.conrightMove,!0),document.addEventListener("mouseup",this.conrightEnd,!0),document.addEventListener("keyup",this.deleteEditIndex,!0),document.addEventListener("keydown",this.controlEditIndex,!0)},unbindKey:function(){document.removeEventListener("mousemove",this.conrightMove),document.removeEventListener("mouseup",this.conrightEnd),document.removeEventListener("keyup",this.deleteEditIndex),document.removeEventListener("keydown",this.controlEditIndex)},startSetBg:function(e){var t=this;clearInterval(this.bgtimer),this.bgtimer=setInterval(function(){t.setBg(e)},100)},stopSetBg:function(e){clearInterval(this.bgtimer)},setBg:function(e){var t=this.bgprop.scale;switch(e){case"zoomOut":t=2<(t+=.05)?2:t,this.bgprop.scale=t;break;case"zoomIn":t=(t-=.05)<.5?.5:t,this.bgprop.scale=t;break;case"moveLeft":this.bgprop.x-=1;break;case"moveRight":this.bgprop.x+=1;break;case"moveUp":this.bgprop.y-=1;break;case"moveDown":this.bgprop.y+=1;break;case"reset":this.bgprop={scale:1,x:0,y:0}}},conrigthStart:function(e,t,i,a){this.isHiddenDragDetail=!1,t.x=e.pageX,t.y=e.pageY,t.orgwidth=Math.round(t.width/this.prxvalue),t.orgheight=Math.round(t.height/this.prxvalue),t.mousetype=a,this.isDrag=t},conrightMove:function(e){if(this.isDrag){var t=this.isDrag,i=t.mousetype,a=e.pageX-t.x,o=e.pageY-t.y;this.calcWH(t,a,o,i)}},calcWH:function(e,t,i,a){var o=e.orgwidth,l=e.orgheight;"right"!==a&&"bottomright"!==a||(o+=t),"bottom"!==a&&"bottomright"!==a||(l+=i),o=o<15?15:1e3<o?1e3:o,l=l<20?20:1e3<l?1e3:l,e.width=Math.round(o*this.prxvalue),e.height=Math.round(l*this.prxvalue)},conrightEnd:function(e){if(this.isDrag){var t=this.isDrag;t.x=e.pageX,t.y=e.pageY,this.isDrag=null}},addItemDrag:function(i,e){var a=this,t=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;"customFields"===i.filedValue&&((i=Object(f.objectMerge2)({},i)).topy=0,i.leftx=0,i.filedName=this.labelSelf,setTimeout(function(){a.labelSelf=""},300));var o=function(){i.isshow=!0,i.fontsize=a.defaultLabelFontSize,a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&a.$set(a.formModel.labelList,t,i)}),console.log("row::::",i);var e=Object(f.objectMerge2)({},i);e._index=a.labelIndex++,e.width=Math.round(a.defaultLabelWidth*a.prxvalue),e.height=Math.round(a.defaultLabelHeight*a.prxvalue),e.fontsize=a.defaultLabelFontSize,e.bold=0,e.alignment=1,a.labelListView.push(Object(f.objectMerge2)({},e)),a.orgLabelList.forEach(function(e,t){e.filedValue===i.filedValue&&a.$set(a.orgLabelList,t,Object(f.objectMerge2)({},i))}),a.editDragItem(e,a.labelListView.length-1)};"customFields"===i.filedValue&&t<this.maxLabelSelf?o():t<this.maxLabel?o():this.$notify.info({title:"消息",message:"【 "+i.filedName+" 】最多添加"+("customFields"===i.filedValue?this.maxLabelSelf:this.maxLabel)+"次"})},clickPanel:function(e){var i=0;e.path.forEach(function(e,t){e.className&&-1!==e.className.indexOf("previewBlock")&&(i+=1)}),i||(this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.isHiddenDragDetail=!0),i=0},editDragItem:function(e,t,i){this.dragDetailInfo={},this.dragDetailInfo=Object(f.objectMerge2)({},e),console.log("编辑显示项:",this.dragDetailInfo,t),this.classItem=[],this.showDragTips=[],this.classItem[t]&&i&&this.isHiddenDragDetail?(this.showDragDetail=!1,this.isHiddenDragDetail=!1):(this.isHiddenDragDetail=!0,this.classItem[t]=!0,this.showDragDetail=!0),this.showDragTips[t]=!0},changeDragDetailInfo:function(e){var i=this;e&&(this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.$set(i.labelListView,t,i.dragDetailInfo)}),this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList,t,i.dragDetailInfo),"setting"===e.filedValue&&(i.$set(i.formModel.labelList,t,i.formModel.paper),console.log("this.formModel.paper:",i.formModel.paper))}))},review:function(){this.showDragDetail=!1,this.viewKey=(new Date).getTime(),this.formModel.labelList=[],this.orgLabelList=[],this.labelListView=[],this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.initPrinter(),this.getCommonSettingLib(),this.dragDetailInfo={},this.isDrag=null},dragStart:function(i,e,t){if(this.showDragTips[t]=!0,this.isDrag)return console.log("dragStart"),!1;this.isDragView=!0;(c=i.currentTarget).getAttribute("data-fileName");var a=Number(c.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e,t){e._index===a&&(e.x=i.pageX,e.y=i.pageY)})},dragEnd:function(t,e,i){if(this.isDrag)return console.log("dragEnd"),!1;console.log(this.showDragTips[i]),this.isDragView=!0;(c=t.currentTarget).getAttribute("data-fileName");var a=Number(c.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e){e._index===a&&(e.leftx+=t.pageX-e.x,e.topy+=t.pageY-e.y)}),this.findOutPage(e,i),this.dragCursor="move",this.showDragTips=[]},findOutPage:function(e,t){console.log(e.leftx,e.width),Math.round(e.leftx*this.prxvalue)+e.width<0||Math.round(e.topy*this.prxvalue)+e.height<0||e.leftx>Math.round(this.formModel.paper.width/this.prxvalue)||e.topy>Math.round(this.formModel.paper.height/this.prxvalue)?(this.dragCursor="not-allowed",this.deleteItemByIndex(e,t)):this.editDragItem(e,t)},deleteItemByIndex:function(i,a){var o=this;i.isshow=!1,this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.labelListView=Object(f.objectMerge2)([],this.labelListView).filter(function(e,t){return t!==a});var e=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;console.log("删除的"+i.filedValue+"还有"+e+"个"),0===e&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.filedValue&&(o.$set(e,"isshow",!1),console.log("labelList上的row",e.filedValue,e.isshow))}),this.orgLabelList=Object(f.objectMerge2)([],this.formModel.labelList))},handleKeyEvent:function(e,t,i){var a=this,o=r.a.getPressedKey(e),l=event.target.tagName||event.srcElement.tagName;if("INPUT"!==l&&"SELECT"!==l&&"TEXTAREA"!==l&&-1!==t.indexOf(o)&&this.dragDetailInfo.filedValue){var n={};this.labelListView.filter(function(e,t){return a.dragDetailInfo._index===e._index&&(n.el=e,n.index=t,!0)}),n.el&&i(n,o,e)}},deleteEditIndex:function(e){var i=this;this.handleKeyEvent(e,["delete","backspace"],function(e,t){i.deleteItemByIndex(e.el,e.index)})},controlEditIndex:function(e){var l=this;this.handleKeyEvent(e,["tab","shift+tab"],function(e,t,i){i.preventDefault();var a=e.index;"tab"===t?a++:a--,a=a>=l.labelListView.length?0:a<0?l.labelListView.length-1:a,l.editDragItem(l.labelListView[a],a,i)}),this.handleKeyEvent(e,["ctrl+up","ctrl+down","ctrl+left","ctrl+right"],function(e,t,i){i.preventDefault();var a=/(up|down)/.test(t)?"height":"width",o=e.el[a];switch(t){case"ctrl+up":case"ctrl+left":o-=1;break;case"ctrl+down":case"ctrl+right":o+=1}o=o<5?5:o>l.formModel.paper.width?l.formModel.paper.width:o,e.el[a]=o}),this.handleKeyEvent(e,["up","down","left","right"],function(e,t){var i=/(up|down)/.test(t)?"topy":"leftx",a=e.el[i],o=0;switch(o=Math.round(a/l.mm2px)*l.mm2px,t){case"up":case"left":o-=l.mm2px;break;case"down":case"right":o+=l.mm2px}e.el[i]=o})},drag:function(e){this.isDragView=!1,this.isMove=!1,c=e.currentTarget},drop:function(t){var i=this;t.preventDefault(),console.log(t.offsetX,t.offsetY,t);var a=c.getAttribute("data-fileName");this.isMove||this.orgLabelList.filter(function(e){e.filedValue!==a||i.isDragView||(e.leftx=t.offsetX,e.topy=t.offsetY,i.addItemDrag(e))})},allowDrop:function(e){e.preventDefault()},sortLabel:function(e,o){return e.sort(function(e,t){var i=e[o],a=t[o];return i.length-a.length})},getCommonSettingLib:function(){var a=this;this.loading=!0,this.commonLabelList=[],Object(u.a)().then(function(e){e&&(Object(f.objectMerge2)([],e).forEach(function(e,t){var i={id:e.id,filedValue:e.fieldValue,filedName:e.fieldName,topy:0,leftx:0,width:0,height:0,companyid:a.otherinfo.companyId,isshow:0,fontsize:10,alignment:1,bold:0,type:e.type};"horizontalLine"===i.filedValue||"verticalLine"===i.filedValue?console.log(i.filedName):a.commonLabelList.push(i)}),a.sortLabel(a.commonLabelList,"filedName"),a.$nextTick(function(){a.getSettingCompanyLi()}))}).catch(function(e){a.loading=!1,a._handlerCatchMsg(e)})},getSettingCompanyLi:function(){var r=this;this.loading=!0,this.labelListView=[],this.orgLabelList=[],this.viewKey=(new Date).getTime();var s=!1,c=!1;Object(u.d)().then(function(a){var o=d()([],a||[]),l=[],n=Object(f.objectMerge2)([],r.commonLabelList);o.forEach(function(i){n.forEach(function(e,t){e.filedValue===i.filedValue&&(i.isshow||"setting"===e.filedValue||"settingRotate"===e.filedValue||(i.width=r.defaultLabelWidth,i.height=r.defaultLabelHeight),"setting"===e.filedValue&&(console.log("纸张设置",r.formModel.labelList[t],i),r.$set(r.formModel.labelList,t,i),r.formModel.labelList[t]=i),r.$set(i,"type",e.type),4===i.type&&("2"===i.filedName.slice(-1)&&(s=!0,r.cargoNum=2),"3"===i.filedName.slice(-1)&&(c=!0,r.cargoNum=3)),n.splice(t,1),l.push(i))})}),console.log("相同字段",l.length,l),console.log("差异字段",n.length,n),r.formModel.labelList=Object(f.objectMerge2)([],l.concat(n)),r.formModel.labelList.forEach(function(t,e){if("settingRotate"===t.filedValue?t.width=Math.round((t.width?t.width:0)*r.prxvalue):(t.width=Math.round((t.width?t.width:r.defaultLabelWidth)*r.prxvalue),t.height=Math.round((t.height?t.height:r.defaultLabelHeight)*r.prxvalue)),"setting"===t.filedValue){var i=d()({},t);a||(i.width=r.defaultPaperWidth,i.height=r.defaultPaperHeight),i.leftx=Math.round(i.leftx*r.prxvalue),i.topy=Math.round(i.topy*r.prxvalue),r.formModel.paper=i}else"settingRotate"===t.filedValue?(console.log("sjkfiwjkeifjsid",t,t.width),r.printRotate=d()({},t)):(o.forEach(function(e){e.filedValue===t.filedValue&&(e.isshow?(e.width=Math.round((e.width?e.width:r.defaultLabelWidth)*r.prxvalue),e.height=Math.round((e.height?e.height:r.defaultLabelHeight)*r.prxvalue),e.fontsize=e.fontsize?e.fontsize:10,e.isshow=1===e.isshow,e.bold=2===e.bold,e.alignment=e.alignment||1,e._index=r.labelIndex++,r.labelListView.push(e)):-1!==e.filedName.indexOf(r.imgNameStr)&&(r.imageUrl=e.filedName.split(",")[1]))}),t.fontsize=t.fontsize?t.fontsize:10,t.isshow=1===t.isshow,t.bold=2===t.bold,t.alignment=t.alignment||1);if(4===t.type)switch(t.showCargo=!1,t.filedName.slice(-1)){case"2":s&&(t.showCargo=!0),r.cargoLabelList[1].push(t);break;case"3":c&&(t.showCargo=!0),r.cargoLabelList[2].push(t);break;default:t.showCargo=!0,r.cargoLabelList[0].push(t)}6===t.type&&(r.modelNameSelf=t.filedName)}),r.orgLabelList=Object(f.objectMerge2)([],r.formModel.labelList),console.log("相同+差异",r.formModel.labelList),r.loading=!1}).catch(function(e){r.loading=!1,r._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},checkNull:function(e){return null!=e&&""!==e&&void 0},resetForm:function(e){var i=this;this.$refs[e].validate(function(e){e&&i.$confirm("此操作将所有设置重置为0,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.formModel.labelList.forEach(function(e,t){"setting"!==e.filedValue&&(e.topy=0,e.leftx=0,e.isshow=0,e.width=Math.round(i.defaultLabelWidth*i.prxvalue),e.height=Math.round(i.defaultLabelHeight*i.prxvalue),e.fontsize=10,e.bold=0,e.alignment=1)}),i.formModel.paper.width=i.defaultPaperWidth,i.formModel.paper.height=i.defaultPaperHeight,i.formModel.paper.topy=0,i.formModel.paper.leftx=0,i.labelListView=[],i.currentSearch="",i.showDragDetail=!1,console.log("cargoNum",i.cargoNum)}).catch(function(e){})})},canDragStart:function(e){},handleSwitch:function(e){var i=this,a=0;this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.labelListView.splice(t,1),e.filedValue===i.dragDetailInfo.filedValue&&(a+=1)}),console.log("len",a),1===a&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList[t],"isshow",!1)}),this.orgLabelList=Object(f.objectMerge2)([],this.formModel.labelList)),this.$nextTick(function(){i.showDragDetail=!1})},changeValue:function(e,t,i){this.viewKey=(new Date).getTime()},savePrinter:function(){this.formInfo.printSetting.label===this.formPrint.printSetting.label&&this.formInfo.printFontSetting.label===this.formPrint.printFontSetting.label||this.$emit("success",{label:this.formPrint.printSetting.label,labelFont:this.formPrint.printFontSetting.label})},submitForm:function(e){var l=this;this.$refs[e].validate(function(e){if(e){l.savePrinter(),l.loading=!0,l.showDragDetail=!1;var i=Object(f.objectMerge2)([],l.labelListView),a={},o={};i.push(Object(f.objectMerge2)({},l.formModel.paper)),l.formModel.labelList.forEach(function(e){if("customFields"===e.filedValue&&l.imageUrl&&((a=Object(f.objectMerge2)({},e)).filedName=l.imgNameStr+l.imageUrl,a.isshow=!1,console.log(" 提交的时候 imageUrl1",l.imageUrl,a)),6===e.type&&((o=Object(f.objectMerge2)({},e)).filedName=l.modelNameSelf+"",o.isshow=!1,i.push(o)),"settingRotate"===e.filedValue){var t=Object(f.objectMerge2)({},e);t.width=l.printRotate.width,t.isshow=!1,i.push(t),console.log("rotate",t,l.printRotate)}}),l.imageUrl&&i.push(a),i=Object(f.objectMerge2)([],i).filter(function(e){var t=function(){e.width=Math.round(e.width/l.prxvalue),e.height=Math.round(e.height/l.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,"setting"===e.filedValue&&(console.log("this.formModel.paper::",l.formModel.paper,e),e.leftx=Math.round(l.formModel.paper.leftx/l.prxvalue),e.topy=Math.round(l.formModel.paper.topy/l.prxvalue))};return"setting"!==e.filedValue&&"modelName"!==e.filedValue&&"settingRotate"!==e.filedValue?!(Math.round(e.leftx*l.prxvalue)+e.width<0||Math.round(e.topy*l.prxvalue)+e.height<0||e.leftx>Math.round(l.formModel.paper.width/l.prxvalue)||e.topy>Math.round(l.formModel.paper.height/l.prxvalue))&&(t(),!0):(t(),!0)}),console.log(" 提交的时候 arr",i),Object(u.g)(i).then(function(e){l.loading=!1,l.$message({type:"success",message:"标签打印设置成功！"}),l.getCommonSettingLib(),l.viewKey=(new Date).getTime()}).catch(function(e){l.loading=!1,l._handlerCatchMsg(e)})}})}}}},rxpl:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("SAxw"),o=i("EvzS"),l=i("VU/8")(a.a,o.a,null,null,null);t.default=l.exports},xhZL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7tLi"),o=i("ybVt");var l=function(e){i("z2pK")},n=i("VU/8")(a.a,o.a,l,null,null);t.default=n.exports},ybVt:function(e,t,i){"use strict";var a={render:function(){var i=this,e=i.$createElement,a=i._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],staticClass:"system-setup-page"},[a("div",{staticClass:"system-setup-table"},[a("el-form",{ref:"ruleForm",attrs:{model:i.form,inline:!0,"label-position":"right",size:"mini"}},[a("el-collapse",{model:{value:i.activeNames,callback:function(e){i.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_SHIPNO",arg:"SETTINGS_SHIPNO"}],attrs:{name:"setup1"}},[a("template",{slot:"title"},[i._v("\n            单号规则\n          ")]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("运单号规则")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio",{attrs:{label:"1"},model:{value:i.shipNo,callback:function(e){i.shipNo=e},expression:"shipNo"}},[i._v("手工输入")])],1),i._v(" "),a("el-form-item",[a("el-radio",{attrs:{label:"2"},model:{value:i.shipNo,callback:function(e){i.shipNo=e},expression:"shipNo"}},[i._v("2位年+2位月+2位日+按公司单号顺序自增")]),i._v(" "),a("el-tooltip",{attrs:{effect:"dark",placement:"top",enterable:!1,manual:!0,value:i.tooltip1,tabindex:"-1"}},[a("div",{attrs:{slot:"content"},slot:"content"},[i._v("运单号至少4位，最多8位。")]),i._v(" "),a("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{disabled:"2"!==i.shipNo,"auto-complete":"off",placeholder:"如：0001"},on:{focus:function(e){i.tooltip1=!0},blur:function(e){i.tooltip1=!1}},model:{value:i.form.shipNo.companyNumberAutoIncrementByTwoYMDValue,callback:function(e){i.$set(i.form.shipNo,"companyNumberAutoIncrementByTwoYMDValue","string"==typeof e?e.trim():e)},expression:"form.shipNo.companyNumberAutoIncrementByTwoYMDValue"}})],1)],1),i._v(" "),a("el-form-item",[a("el-radio",{attrs:{label:"3"},model:{value:i.shipNo,callback:function(e){i.shipNo=e},expression:"shipNo"}},[i._v("2位年+2位月+按公司单号顺序自增")]),i._v(" "),a("el-tooltip",{attrs:{effect:"dark",placement:"top",enterable:!1,manual:!0,value:i.tooltip2,tabindex:"-1"}},[a("div",{attrs:{slot:"content"},slot:"content"},[i._v("运单号至少4位，最多8位。")]),i._v(" "),a("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{disabled:"3"!==i.shipNo,"auto-complete":"off",placeholder:"如：0001"},on:{focus:function(e){i.tooltip2=!0},blur:function(e){i.tooltip2=!1}},model:{value:i.form.shipNo.companyNumberAutoIncrementByTwoYMValue,callback:function(e){i.$set(i.form.shipNo,"companyNumberAutoIncrementByTwoYMValue","string"==typeof e?e.trim():e)},expression:"form.shipNo.companyNumberAutoIncrementByTwoYMValue"}})],1)],1),i._v(" "),a("el-form-item",[a("el-radio",{attrs:{label:"4"},model:{value:i.shipNo,callback:function(e){i.shipNo=e},expression:"shipNo"}},[i._v("按公司单号顺序自增")]),i._v(" "),a("el-tooltip",{attrs:{effect:"dark",placement:"top",enterable:!1,manual:!0,value:i.tooltip3,tabindex:"-1"}},[a("div",{attrs:{slot:"content"},slot:"content"},[i._v("运单号至少6位，最多7位。")]),i._v(" "),a("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{disabled:"4"!==i.shipNo,"auto-complete":"off",placeholder:"如：0001"},on:{focus:function(e){i.tooltip3=!0},blur:function(e){i.tooltip3=!1}},model:{value:i.form.shipNo.companyNumberAutoIncrementValue,callback:function(e){i.$set(i.form.shipNo,"companyNumberAutoIncrementValue","string"==typeof e?e.trim():e)},expression:"form.shipNo.companyNumberAutoIncrementValue"}})],1)],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipNo.systemNumberImmutable,callback:function(e){i.$set(i.form.shipNo,"systemNumberImmutable",e)},expression:"form.shipNo.systemNumberImmutable"}},[i._v("不允许修改系统生成的单号")])],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("货号规则")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio",{attrs:{label:"1"},model:{value:i.cargoNo,callback:function(e){i.cargoNo=e},expression:"cargoNo"}},[i._v("手工输入")])],1),i._v(" "),a("el-form-item",[a("el-radio",{attrs:{label:"2"},model:{value:i.cargoNo,callback:function(e){i.cargoNo=e},expression:"cargoNo"}},[i._v("运单号+件数")])],1),i._v(" "),a("el-form-item",[a("el-radio",{attrs:{label:"3"},model:{value:i.cargoNo,callback:function(e){i.cargoNo=e},expression:"cargoNo"}},[i._v("网点代码+运单号后")]),i._v(" "),a("el-input",{attrs:{disabled:"3"!==i.cargoNo,placeholder:""},model:{value:i.form.cargoNo.orgIdAndShipNoAndNumberOfUnitsValue,callback:function(e){i.$set(i.form.cargoNo,"orgIdAndShipNoAndNumberOfUnitsValue",e)},expression:"form.cargoNo.orgIdAndShipNoAndNumberOfUnitsValue"}}),i._v("位+件数\n              ")],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.cargoNo.systemNumberNotAllowUpdate,callback:function(e){i.$set(i.form.cargoNo,"systemNumberNotAllowUpdate",e)},expression:"form.cargoNo.systemNumberNotAllowUpdate"}},[i._v("不允许修改系统生成的货号")])],1)],1)])],2),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_SHIPFEE",arg:"SETTINGS_SHIPFEE"}],attrs:{name:"setup2",title:"运费合计规则"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("运费合计")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1",disabled:"","false-label":"0"},model:{value:i.form.shipFee.shipFee,callback:function(e){i.$set(i.form.shipFee,"shipFee",e)},expression:"form.shipFee.shipFee"}},[i._v("基本运费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.brokerageFee,callback:function(e){i.$set(i.form.shipFee,"brokerageFee",e)},expression:"form.shipFee.brokerageFee"}},[i._v("回扣")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.deliveryFee,callback:function(e){i.$set(i.form.shipFee,"deliveryFee",e)},expression:"form.shipFee.deliveryFee"}},[i._v("送货费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.pickupFee,callback:function(e){i.$set(i.form.shipFee,"pickupFee",e)},expression:"form.shipFee.pickupFee"}},[i._v("提货费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.goupstairsFee,callback:function(e){i.$set(i.form.shipFee,"goupstairsFee",e)},expression:"form.shipFee.goupstairsFee"}},[i._v("上楼费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.insuranceFee,callback:function(e){i.$set(i.form.shipFee,"insuranceFee",e)},expression:"form.shipFee.insuranceFee"}},[i._v("保险费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.handlingFee,callback:function(e){i.$set(i.form.shipFee,"handlingFee",e)},expression:"form.shipFee.handlingFee"}},[i._v("装卸费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.packageFee,callback:function(e){i.$set(i.form.shipFee,"packageFee",e)},expression:"form.shipFee.packageFee"}},[i._v("包装费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.forkliftFee,callback:function(e){i.$set(i.form.shipFee,"forkliftFee",e)},expression:"form.shipFee.forkliftFee"}},[i._v("叉车费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.customsFee,callback:function(e){i.$set(i.form.shipFee,"customsFee",e)},expression:"form.shipFee.customsFee"}},[i._v("报关费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.commissionFee,callback:function(e){i.$set(i.form.shipFee,"commissionFee",e)},expression:"form.shipFee.commissionFee"}},[i._v("代收款手续费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.taxes,callback:function(e){i.$set(i.form.shipFee,"taxes",e)},expression:"form.shipFee.taxes"}},[i._v("税金")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.housingFee,callback:function(e){i.$set(i.form.shipFee,"housingFee",e)},expression:"form.shipFee.housingFee"}},[i._v("入仓费")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.stampTax,callback:function(e){i.$set(i.form.shipFee,"stampTax",e)},expression:"form.shipFee.stampTax"}},[i._v("印花税")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipFee.otherfeeIn,callback:function(e){i.$set(i.form.shipFee,"otherfeeIn",e)},expression:"form.shipFee.otherfeeIn"}},[i._v("其他费用收入")])],1)],1)])]),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_SHIPFUNC",arg:"SETTINGS_SHIPFUNC"}],attrs:{name:"setup3",title:"运单功能设置"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("运单页面")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[i._v("\n                运单字段设置\n                "),a("el-select",{attrs:{"collapse-tags":"",multiple:"",placeholder:"请选择"},model:{value:i.fieldSetup,callback:function(e){i.fieldSetup=e},expression:"fieldSetup"}},i._l(i.shipField,function(e,t){return a("el-option",{key:e.key,class:{theSelectfirst:0===t},attrs:{label:e.name,value:e.key}},[0===t?a("div",{staticClass:"selectHeader",on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[a("span",{staticStyle:{float:"left"}},[i._v("字典名称")]),i._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[i._v("必填")])]):i._e(),i._v(" "),a("span",{staticStyle:{float:"left"}},[i._v(i._s(e.name))])])}))],1),i._v(" "),a("el-form-item",[i._v("\n                开单时间规则\n                "),a("SelectType",{attrs:{type:"ship_time_rule"},model:{value:i.form.shipPageFunc.shipTimeRule,callback:function(e){i.$set(i.form.shipPageFunc,"shipTimeRule",e)},expression:"form.shipPageFunc.shipTimeRule"}})],1),i._v(" "),a("el-form-item",[i._v("\n                通知放货规则\n                "),a("SelectType",{attrs:{type:"notify_cargo_rule"},model:{value:i.form.shipPageFunc.notifyCargoRule,callback:function(e){i.$set(i.form.shipPageFunc,"notifyCargoRule",e)},expression:"form.shipPageFunc.notifyCargoRule"}})],1),i._v(" "),a("el-form-item",[i._v("\n                运单名称\n                "),a("el-input",{attrs:{maxlength:20},model:{value:i.form.shipPageFunc.orderName,callback:function(e){i.$set(i.form.shipPageFunc,"orderName",e)},expression:"form.shipPageFunc.orderName"}})],1),i._v(" "),a("el-form-item",[i._v("\n                保险费与声明价值比例\n                "),a("el-input",{directives:[{name:"number-only",rawName:"v-number-only"}],staticStyle:{width:"120px"},attrs:{maxlength:3},model:{value:i.form.shipPageFunc.insurancePremiumIsDeclaredValue,callback:function(e){i.$set(i.form.shipPageFunc,"insurancePremiumIsDeclaredValue",e)},expression:"form.shipPageFunc.insurancePremiumIsDeclaredValue"}},[a("template",{slot:"append"},[i._v("‰")])],2),i._v(" "),a("el-popover",{staticStyle:{float:"right","margin-top":"0px","margin-left":"10px"},attrs:{placement:"right",trigger:"hover"}},[a("span",[i._v("保险费为声明价值"+i._s(i.form.shipPageFunc.insurancePremiumIsDeclaredValue)+"‰")]),i._v(" "),a("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),i._v(" "),i._e(),i._v(" "),a("el-form-item",[i._v("\n                开单打印标签是否默认件数\n                  "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:i.form.shipPageFunc.printLabelIsAmount,callback:function(e){i.$set(i.form.shipPageFunc,"printLabelIsAmount",e)},expression:"form.shipPageFunc.printLabelIsAmount"}},[a("el-option",{attrs:{label:"是",value:"1"}}),i._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("运单权限")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipPermission.onlyUpdateOwnShip,callback:function(e){i.$set(i.form.shipPermission,"onlyUpdateOwnShip",e)},expression:"form.shipPermission.onlyUpdateOwnShip"}},[i._v("只能修改自己开的运单")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipPermission.onlyInvalidOwnShip,callback:function(e){i.$set(i.form.shipPermission,"onlyInvalidOwnShip",e)},expression:"form.shipPermission.onlyInvalidOwnShip"}},[i._v("只能作废自己开的运单")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipPermission.onlyDeleteOwnShip,callback:function(e){i.$set(i.form.shipPermission,"onlyDeleteOwnShip",e)},expression:"form.shipPermission.onlyDeleteOwnShip"}},[i._v("只能删除自己开的运单")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipPermission.selectOrderSetting,callback:function(e){i.$set(i.form.shipPermission,"selectOrderSetting",e)},expression:"form.shipPermission.selectOrderSetting"}},[i._v("可查询全公司运单")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.shipPermission.controlgoodsVisibleRule,callback:function(e){i.$set(i.form.shipPermission,"controlgoodsVisibleRule",e)},expression:"form.shipPermission.controlgoodsVisibleRule"}},[i._v("其他网点可看控货信息")])],1)],1)])]),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_FINANCE",arg:"SETTINGS_FINANCE"}],attrs:{name:"setup7",title:"财务设置"}},[a("div",{staticClass:"clearfix setup-table setup-table-finance"},[a("div",{staticClass:"setup-left"},[i._v("财务凭证")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},model:{value:i.form.financeSetting.voucher,callback:function(e){i.$set(i.form.financeSetting,"voucher",e)},expression:"form.financeSetting.voucher"}},i._l(i.vouchers,function(e,t){return a("el-radio",{key:t,attrs:{label:e.value}},[i._v(i._s(e.label))])}))],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table setup-table-finance"},[a("div",{staticClass:"setup-left"},[i._v("毛利")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[i._v("\n                运费合计\n              ")]),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.grossMargin.brokerageFee,callback:function(e){i.$set(i.form.grossMargin,"brokerageFee",e)},expression:"form.grossMargin.brokerageFee"}},[i._v("- 回扣")])],1),i._v(" "),a("el-form-item",[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:i.form.grossMargin.shipFeeAmount,callback:function(e){i.$set(i.form.grossMargin,"shipFeeAmount",e)},expression:"form.grossMargin.shipFeeAmount"}},[i._v("- 车费合计")]),i._v(" "),a("el-popover",{staticStyle:{float:"right","margin-top":"0px","margin-left":"10px"},attrs:{placement:"right",trigger:"hover"}},[a("span",[i._v("计算公式：毛利 = 运费合计"+i._s(("1"===i.form.grossMargin.brokerageFee?" - 回扣":"")+("1"===i.form.grossMargin.shipFeeAmount?" - 车费合计":"")))]),i._v(" "),a("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1)],1)])]),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_LOAD",arg:"SETTINGS_LOAD"}],attrs:{name:"setup8",title:"配载设置"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("发车合同承运方")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},model:{value:i.form.loadSetting.carrier,callback:function(e){i.$set(i.form.loadSetting,"carrier",e)},expression:"form.loadSetting.carrier"}},i._l(i.deliverContacts,function(e,t){return a("el-radio",{key:t,attrs:{label:e.value}},[i._v(i._s(e.label))])}))],1)],1)])]),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_PRINT",arg:"SETTINGS_PRINT"}],attrs:{name:"setup4",title:"打印设置"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("打印机设置")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[i._v("\n                运单\n                "),a("el-select",{model:{value:i.form.printSetting.ship,callback:function(e){i.$set(i.form.printSetting,"ship",e)},expression:"form.printSetting.ship"}},i._l(i.printers,function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})}))],1),i._v(" "),a("el-form-item",[i._v("\n                标签\n                "),a("el-select",{model:{value:i.form.printSetting.label,callback:function(e){i.$set(i.form.printSetting,"label",e)},expression:"form.printSetting.label"}},i._l(i.printers,function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})}))],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("列表模板设置")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},model:{value:i.form.listTemplate.templateSign,callback:function(e){i.$set(i.form.listTemplate,"templateSign",e)},expression:"form.listTemplate.templateSign"}},[a("el-radio",{attrs:{label:"0"}},[i._v("使用网点模板")]),i._v(" "),a("el-radio",{attrs:{label:"1"}},[i._v("使用公司模板")])],1)],1)],1)])]),i._v(" "),a("el-collapse-item",{directives:[{name:"has",rawName:"v-has:SETTINGS_TEMPLATE",arg:"SETTINGS_TEMPLATE"}],attrs:{name:"setup5",title:"打印模板设置"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("运单标签设置")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-tickets",type:"primary",plain:""},on:{click:function(e){i.doAction("printSetOrder")}}},[i._v("运单-打印设置")])],1),i._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-news",type:"success",plain:""},on:{click:function(e){i.doAction("printSetLi")}}},[i._v("标签-打印设置")])],1),i._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-date",type:"primary",plain:""},on:{click:function(e){i.doAction("printLoadInfo")}}},[i._v("配载单-打印设置")])],1),i._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-document",type:"success",plain:""},on:{click:function(e){i.doAction("printContract")}}},[i._v("合同-打印设置")])],1)],1)])]),i._v(" "),a("el-collapse-item",{attrs:{name:"setup6",title:"常用插件下载"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("下载地址")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-download",type:"primary",plain:""},on:{click:function(e){i.downloadFile("lodop")}}},[i._v("LODOP云打印插件下载")])],1),i._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-download",type:"success",plain:""},on:{click:function(e){i.downloadFile("supcan")}}},[i._v("硕正报表插件下载")])],1)],1)])]),i._v(" "),a("el-collapse-item",{attrs:{name:"setup9",title:"基础设置"}},[a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("切换其他网点")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},model:{value:i.form.switchUser.canSwitch,callback:function(e){i.$set(i.form.switchUser,"canSwitch",e)},expression:"form.switchUser.canSwitch"}},i._l(i.canSwitchs,function(e,t){return a("el-radio",{key:t,attrs:{label:e.value}},[i._v(i._s(e.label))])}))],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("轨迹跟踪来源")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},model:{value:i.form.track.trackSign,callback:function(e){i.$set(i.form.track,"trackSign",e)},expression:"form.track.trackSign"}},i._l(i.trackSigns,function(e,t){return a("el-radio",{key:t,attrs:{label:e.value}},[i._v(i._s(e.label))])}))],1)],1)]),i._v(" "),a("div",{staticClass:"clearfix setup-table"},[a("div",{staticClass:"setup-left"},[i._v("系统LOGO")]),i._v(" "),a("div",{staticClass:"setup-right"},[a("el-form-item",[a("upload",{attrs:{title:"本地上传"},model:{value:i.form.uploadLogo.logoUrl,callback:function(e){i.$set(i.form.uploadLogo,"logoUrl",e)},expression:"form.uploadLogo.logoUrl"}})],1)],1)])])],1)],1)],1),i._v(" "),a("div",{staticClass:"system-setup-footer"},[a("el-button",{attrs:{type:"primary",disabled:i.nochange},on:{click:i.saveData}},[i._v("保存")])],1),i._v(" "),a("printSetOrder",{attrs:{popVisible:i.printSetOrderVisible,formInfo:i.form},on:{close:i.closePrintSetOrder,success:i.changeSystem}}),i._v(" "),a("printSetLi",{attrs:{popVisible:i.printSetLiVisible,formInfo:i.form},on:{close:i.closePrintSetLi,success:i.changeSystem}}),i._v(" "),a("printLoadInfo",{attrs:{popVisible:i.printLoadInfoVisible,formInfo:i.form},on:{close:function(e){i.printLoadInfoVisible=!1},success:i.changeSystem}}),i._v(" "),a("printContract",{attrs:{popVisible:i.printContractVisible,formInfo:i.form},on:{close:function(e){i.printContractVisible=!1},success:i.changeSystem}})],1)},staticRenderFns:[]};t.a=a},z2pK:function(e,t){},zsRk:function(e,t,i){"use strict";var a=i("woOf"),o=i.n(a),l=i("UQm2"),n=i("6ThG"),r=i("0xDb");t.a={components:{},props:{popVisible:{type:Boolean,default:!1},formInfo:{type:[Object,Array],default:function(){}}},data:function(){return{btnsize:"mini",formModel:{heading_content:"",heading_word_size:"",content_word_size:"",print_page_num:"",content_wrap:"",printer:"",paper_width:"",left_distance:"",printing_direction:"",paper_height:"",top_distance:"",printing_date:"",printing_person:""},formPrint:{printFontSetting:{load:""}},printers:[],fontSizes:[12,13,14,15,16,18,20,22,24,26,28,32,40,60],orgData:[]}},watch:{popVisible:function(){this.popVisible?(this.dialogVisible=!0,this.getPrintSetting(),this.formPrint=Object(r.objectMerge2)({},this.formInfo),console.log("formPrint",this.formPrint)):this.dialogVisible=!1}},computed:{dialogVisible:{get:function(){return this.popVisible},set:function(){}}},mounted:function(){this.getPrintSetting(),this.initPrinter()},methods:{initPrinter:function(){for(var e in this.printers=o()([],Object(l.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},savePrinter:function(){this.formInfo.printFontSetting.load!==this.formPrint.printFontSetting.load&&this.$emit("success",{loadFont:this.formPrint.printFontSetting.load})},getPrintSetting:function(){var i=this;this.orgData=[],Object(n.c)({companyId:this.otherinfo.companyId,printType:0}).then(function(e){var t=e.data;t?(i.orgData=t).forEach(function(e){void 0!==i.formModel[e.fieldName]&&(i.formModel[e.fieldName]=e.fieldValue||"")}):i._handlerCatchMsg(e)}).catch(function(e){i._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},submitForm:function(e){var t=this,i=[];this.savePrinter(),this.orgData.forEach(function(e){void 0!==t.formModel[e.fieldName]&&(e.fieldValue=t.formModel[e.fieldName]),i.push(e)}),Object(n.f)({companyId:this.otherinfo.companyId,printType:0,settingList:i}).then(function(e){t.$message({type:"success",message:"打印设置成功！"}),t.closeMe()}).catch(function(e){t._handlerCatchMsg(e)})}}}}});