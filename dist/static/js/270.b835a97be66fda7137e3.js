webpackJsonp([270],{fY6L:function(e,t,r){"use strict";var i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("pop-right",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"addPickUpPop",attrs:{title:t.popTitle,isShow:t.popVisible},on:{close:t.closeMe}},[r("template",{staticClass:"addPickUpPop-content",slot:"content"},[r("el-form",{key:t.valkey,ref:"ruleForm",staticClass:"pickup_lrl",attrs:{model:t.form,rules:t.rules,"label-width":"90px","show-message":t.checkShowMessage,inline:!0,"label-position":"right",size:"mini"}},[r("div",{staticClass:"info_date",staticStyle:{"margin-top":"10px"}},[t._v("提货信息")]),t._v(" "),r("div",{staticClass:"pickUp-top"},[r("el-form-item",{attrs:{label:"提货批次",prop:"customerUnit"}},[r("el-input",{attrs:{"auto-complete":"off",disabled:""},model:{value:t.pickupBatchNumber,callback:function(e){t.pickupBatchNumber=e},expression:"pickupBatchNumber"}})],1),t._v(" "),r("el-form-item",{staticClass:"senderName_lrl",attrs:{label:"发货人",prop:""}},[r("querySelect",{attrs:{search:"customerName",type:"sender",valuekey:"customerName",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.customerName,callback:function(e){t.$set(t.form.tmsCustomer,"customerName",e)},expression:"form.tmsCustomer.customerName"}})],1),t._v(" "),r("el-form-item",{staticClass:"senderName_lrl",attrs:{label:"手机号",prop:"tmsCustomer.customerMobile"}},[r("querySelect",{attrs:{search:"customerMobile",type:"sender",valuekey:"customerMobile",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.customerMobile,callback:function(e){t.$set(t.form.tmsCustomer,"customerMobile",e)},expression:"form.tmsCustomer.customerMobile"}})],1),t._v(" "),r("el-form-item",{staticClass:"senderAddr_lrl",attrs:{label:"提货地址",prop:"tmsCustomer.detailedAddress"}},[r("querySelect",{attrs:{search:"detailedAddress",type:"sender",valuekey:"detailedAddress",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.detailedAddress,callback:function(e){t.$set(t.form.tmsCustomer,"detailedAddress",e)},expression:"form.tmsCustomer.detailedAddress"}})],1)],1),t._v(" "),r("div",{staticClass:"info_date"},[t._v("货物信息")]),t._v(" "),r("div",{staticClass:"pickUp-order"},[r("el-form-item",{attrs:{label:"货品名",prop:"tmsOrderPickup.pickupName"}},[r("querySelect",{attrs:{search:"value",valuekey:"value",maxlength:8,type:"cargoName",remote:!0,disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.pickupName,callback:function(e){t.$set(t.form.tmsOrderPickup,"pickupName",e)},expression:"form.tmsOrderPickup.pickupName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"件数",prop:"tmsOrderPickup.pickupAmount"}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupAmount},on:{change:function(e){t.setInputVal(e.target.value,"pickupAmount")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"体积",prop:""}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupVolume},on:{change:function(e){t.setInputVal(e.target.value,"pickupVolume")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"重量",prop:"tmsOrderPickup.pickupWeight"}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupWeight},on:{change:function(e){t.setInputVal(e.target.value,"pickupWeight")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"运费",prop:"tmsOrderPickup.carriage"}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.carriage},on:{change:function(e){t.setInputVal(e.target.value,"carriage")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"付款方式"}},[r("SelectType",{staticClass:"pickup-way",attrs:{type:"ship_pay_way",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.payMethod,callback:function(e){t.$set(t.form.tmsOrderPickup,"payMethod",e)},expression:"form.tmsOrderPickup.payMethod"}})],1),t._v(" "),r("el-form-item",{staticClass:"order_toCityCode",attrs:{required:"",prop:"tmsOrderPickup.toCityName",label:"到站"}},[r("queryCity",{attrs:{search:"longAddr",type:"city",remote:!0,disabled:t.isDbclick},on:{change:t.selectToCity},model:{value:t.form.tmsOrderPickup.toCityName,callback:function(e){t.$set(t.form.tmsOrderPickup,"toCityName",e)},expression:"form.tmsOrderPickup.toCityName"}})],1),t._v(" "),r("el-form-item",{staticClass:"order_remark",attrs:{label:"备注",prop:"tmsOrderPickup.remark"}},[r("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:t.isDbclick,maxlength:300},model:{value:t.form.tmsOrderPickup.remark,callback:function(e){t.$set(t.form.tmsOrderPickup,"remark",e)},expression:"form.tmsOrderPickup.remark"}})],1)],1),t._v(" "),r("div",{staticClass:"info_date"},[t._v("其他信息")]),t._v(" "),r("div",{staticClass:"pickUp-bottom"},[r("el-form-item",{attrs:{label:"车费",prop:"tmsOrderPickup.truckFee"}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.truckFee},on:{change:function(e){t.setInputVal(e.target.value,"truckFee")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"代收费用",prop:""}},[r("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.collectionFee},on:{change:function(e){t.setInputVal(e.target.value,"collectionFee")}}})]),t._v(" "),r("el-form-item",{attrs:{label:"车牌号",prop:"tmsTruck.truckIdNumber"}},[r("querySelect",{attrs:{search:"truckIdNumber",valuekey:"truckIdNumber",type:"trunk",disabled:t.isDbclick,maxlength:8},on:{change:t.getTrunkName},model:{value:t.form.tmsTruck.truckIdNumber,callback:function(e){t.$set(t.form.tmsTruck,"truckIdNumber",e)},expression:"form.tmsTruck.truckIdNumber"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"司机姓名",prop:"tmsDriver.driverName"}},[r("querySelect",{attrs:{search:"driverName",valuekey:"driverName",type:"driver",remote:!0,disabled:t.isDbclick,maxlength:8},on:{change:t.getdriverName},model:{value:t.form.tmsDriver.driverName,callback:function(e){t.$set(t.form.tmsDriver,"driverName",e)},expression:"form.tmsDriver.driverName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆类型"}},[r("SelectType",{staticClass:"pickup-way",attrs:{type:"truck_type",placeholder:"请选择",disabled:t.isDbclick},model:{value:t.form.tmsTruck.truckType,callback:function(e){t.$set(t.form.tmsTruck,"truckType",e)},expression:"form.tmsTruck.truckType"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"司机手机",prop:"tmsDriver.driverMobile"}},[r("el-input",{attrs:{"auto-complete":"off",disabled:t.isDbclick},model:{value:t.form.tmsDriver.driverMobile,callback:function(e){t.$set(t.form.tmsDriver,"driverMobile",e)},expression:"form.tmsDriver.driverMobile"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"车辆单位",prop:"tmsTruck.truckUnit"}},[r("el-input",{attrs:{"auto-complete":"off",disabled:t.isDbclick,maxlength:18},model:{value:t.form.tmsTruck.truckUnit,callback:function(e){t.$set(t.form.tmsTruck,"truckUnit",e)},expression:"form.tmsTruck.truckUnit"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"提货状态",prop:"tmsOrderPickup.pickupStatus"}},[r("SelectType",{staticClass:"pickup-way",attrs:{filterfn:t.filterfn,type:"pickup_status",placeholder:"请选择",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.pickupStatus,callback:function(e){t.$set(t.form.tmsOrderPickup,"pickupStatus",e)},expression:"form.tmsOrderPickup.pickupStatus"}})],1),t._v(" "),r("el-form-item",{staticClass:"customerunit",attrs:{label:"出车时间"}},[r("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"timestamp","picker-options":t.pickOption,disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.outTime,callback:function(e){t.$set(t.form.tmsOrderPickup,"outTime",e)},expression:"form.tmsOrderPickup.outTime"}})],1),t._v(" "),r("el-form-item",{staticClass:"arrive-time",attrs:{label:"到达时间",prop:"tmsOrderPickup.arriveTime"}},[r("el-date-picker",{attrs:{align:"right",type:"datetime","picker-options":t.pickOption2,placeholder:"选择日期","value-format":"timestamp",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.arriveTime,callback:function(e){t.$set(t.form.tmsOrderPickup,"arriveTime",e)},expression:"form.tmsOrderPickup.arriveTime"}})],1),t._v(" "),r("el-form-item",{staticClass:"checked"},[r("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("发送短信给司机")])],1)],1)])],1),t._v(" "),t.isDbclick?r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.closeMe}},[t._v("关 闭")])],1):r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保 存")]),t._v(" "),r("el-button",{on:{click:t.closeMe}},[t._v("取 消")])],1)],2)},staticRenderFns:[]};t.a=i},gt6D:function(e,t){},nwVq:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("pcyF"),s=r("fY6L");var o=function(e){r("gt6D")},a=r("VU/8")(i.a,s.a,o,null,null);t.default=a.exports},pcyF:function(e,t,r){"use strict";var i=r("woOf"),s=r.n(i),o=r("Dd8w"),a=r.n(o),c=r("E4LH"),m=r("OYTF"),l=r("P5Di"),u=r("QbVN"),d=r("9UCZ"),p=r("66wn"),n=r("pAQG"),k=r("hq98"),f=r("NYxO"),h=r("0xDb");t.a={components:{popRight:l.a,Upload:u.a,querySelect:n.a,SelectType:d.a,queryCity:k.a,SelectCity:p.a},props:{popVisible:{type:Boolean,default:!1},orgid:{required:!0},isModify:{type:Boolean,default:!1},isDbclick:{type:Boolean,default:!1},info:{type:Object,default:function(){}},issender:{type:Boolean,dafault:!1}},computed:a()({},Object(f.mapGetters)(["otherinfo"])),data:function(){var i=this,t=this,e=function(e,t,r){c.a.Number_point.test(t)||!t?r():r(new Error("只能输入数字"))};return{rules:{"tmsOrderPickup.pickupName":[{required:!0,validator:this.validateIsEmpty("货品名不能为空")}],"tmsOrderPickup.pickupAmount":[{validator:function(e,t,r){c.a.ONLY_NUMBER.test(t)||!t?r():r(new Error("只能输入数字"))},trigger:"blur"},{required:!0,validator:this.validateIsEmpty("件数不能为空")}],"tmsOrderPickup.toCityName":[{required:!0,validator:this.validateIsEmpty("到站不能为空")}],"tmsOrderPickup.pickupVolume":[{validator:e,trigger:"blur"}],"tmsOrderPickup.pickupWeight":[{validator:e,trigger:"blur"}],"tmsOrderPickup.carriage":[{validator:e,mtrigger:"blur"}],"tmsOrderPickup.remark":[{max:300,message:"备注最多可输入300个字符",trigger:"blur"}],"tmsOrderPickup.truckFee":[{validator:e,trigger:"blur"}],"tmsOrderPickup.collectionFee":[{validator:e,trigger:"blur"}],"tmsTruck.truckIdNumber":[{required:!0,validator:this.validateIsEmpty("车牌号不能为空")}],"tmsDriver.driverName":[{required:!0,validator:this.validateIsEmpty("司机姓名不能为空")}],"tmsDriver.driverMobile":[{validator:function(e,t,r){c.a.MOBILE.test(t)||!t?r():i.isDbclick?r():r(new Error("请输入正确的手机号码~"))},trigger:"change"}],"tmsTruck.truckUnit":[{max:18,message:"车辆单位最多可输入18个字符",trigger:"blur"}],"tmsOrderPickup.arriveTime":[{required:!0,validator:this.validateIsEmpty("要求到达时间不能为空")}],"tmsCustomer.customerMobile":[{required:!0,validator:this.validateIsEmpty("发货人手机号不能为空")}],"tmsCustomer.detailedAddress":[{required:!0,validator:this.validateIsEmpty("提货地址不能为空")}]},pickOption:{firstDayOfWeek:1,disabledDate:function(e){return!!t.form.tmsOrderPickup.arriveTime&&e.getDate()>t.form.tmsOrderPickup.arriveTime}},pickOption2:{firstDayOfWeek:1,disabledDate:function(e){var t=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate());return!!t&&e.getTime()<t}},form:{tmsCustomer:{customerName:"",customerMobile:"",detailedAddress:"",customerId:""},tmsDriver:{driverName:"",driverMobile:"",driverId:""},tmsTruck:{truckIdNumber:"",truckType:"",truckUnit:"",truckId:""},tmsOrderPickup:{pickupBatchNumber:"",pickupName:"",pickupAmount:"",pickupVolume:"",pickupWeight:"",carriage:"",payMethod:76,toCityCode:"",toCityName:"",remark:"",truckFee:"",pickupStatus:236,collectionFee:"",outTime:"",arriveTime:""}},valkey:"",checked:!0,checkShowMessage:!1,formLabelWidth:"80px",popTitle:"提货派车单",loading:!1,inited:!1,pickupBatchNumber:"",sender:{},isChecked:!1,isCheckedShow:!1}},mounted:function(){this.inited||(this.inited=!0,this.initInfo())},watch:{popVisible:function(e,t){this.inited||(this.inited=!0,this.initInfo())},info:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())},isModify:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())},isDbclick:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())}},methods:{setInputVal:function(e,t){this.$set(this.form.tmsOrderPickup,t,e),this.$refs.ruleForm.validate(function(e){})},watchInfo:function(){this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.newInfoData(),this.fetchGetPickUp(),this.valkey=Math.random())},filterfn:function(e){return 235!==e.id},infoData:function(e){this.form.tmsOrderPickup.pickupName=e.pickupName,this.form.tmsOrderPickup.pickupAmount=e.pickupAmount,this.form.tmsOrderPickup.pickupWeight=e.pickupWeight,this.form.tmsOrderPickup.pickupVolume=e.pickupVolume,this.form.tmsOrderPickup.carriage=e.carriage,this.form.tmsOrderPickup.collectionFee=e.collectionFee,this.form.tmsOrderPickup.payMethod=e.payMethod,this.form.tmsOrderPickup.pickupStatus=e.pickupStatus,this.form.tmsOrderPickup.remark=e.remark,this.form.tmsOrderPickup.arriveTime=+new Date(e.arriveTime),this.form.tmsOrderPickup.outTime=+new Date(e.outTime),this.form.tmsOrderPickup.toCityName=e.toCityName,this.form.tmsOrderPickup.id=e.id,this.form.tmsOrderPickup.truckFee=e.truckFee,console.log("infoData",e),this.form.tmsTruck.truckIdNumber=e.truckIdNumber,this.form.tmsTruck.truckType=e.truckType,this.form.tmsTruck.truckUnit=e.truckUnit,this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.driverMobile,this.form.tmsCustomer.customerName=e.customerName,this.form.tmsCustomer.customerMobile=e.customerMobile,this.form.tmsCustomer.detailedAddress=e.detailedAddress,this.pickupBatchNumber=e.pickupBatchNumber,this.valkey=Math.random()},validateIsEmpty:function(){var i=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"不能为空！";return function(e,t,r){t?r():(i.showMessage(s),r(new Error(s)))}},showMessage:function(e){this.isChecked&&!this.isCheckedShow&&(this.isCheckedShow=!0),this.isCheckedShow?this.checkShowMessage=!0:this.checkShowMessage=!1},setObject:function(e,t){for(var r in e)e[r]=t?t[r]:"";return e},fetchGetPickUp:function(){var t=this;return this.loading=!0,Object(m.b)().then(function(e){t.pickupBatchNumber=e.data,t.loading=!1}).catch(function(e){t._handlerCatchMsg(e)})},setSender:function(e,t){t=t?"customRece":"tmsCustomer",e&&(this.form[t].customerType="tmsCustomer"===t?1:2,this.form[t].customerName=e.customerName,this.form[t].customerMobile=e.customerMobile,this.form[t].detailedAddress=e.detailedAddress,this.form[t].customerId=e.customerId)},selectToCity:function(e,t){e&&(this.form.tmsOrderPickup.toCityCode=e.id,this.form.tmsOrderPickup.toCityName=e.longAddr)},getdriverName:function(e,t){e&&(this.form.tmsDriver.driverMobile?this.form.tmsDriver.driverMobile=s()(this.form.tmsDriver.driverMobile):(this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.driverMobile,this.form.tmsDriver.driverId=e.id))},getTrunkName:function(e){e&&(""===this.form.tmsDriver.driverName||""===this.form.tmsDriver.driverMobile?(this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.dirverMobile,this.form.tmsDriver.driverId=e.driverId):(this.form.tmsDriver.driverName=s()(this.form.tmsDriver.driverName),this.form.tmsDriver.driverMobile=s()(this.form.tmsDriver.driverMobile)),this.form.tmsTruck.truckId=e.truckId,this.form.tmsTruck.truckType=e.truckType,this.form.tmsTruck.truckUnit=e.truckUnit,this.form.tmsTruck.truckIdNumber=e.truckIdNumber)},initInfo:function(){this.loading=!1},submitForm:function(o){var a=this;this.isChecked=!0,this.isCheckedShow=!0,this.checkShowMessage=!0,this.$refs[o].validate(function(e){if(a.isChecked=!1,a.isCheckedShow=!1,!e||a.loading)return!1;a.loading=!0,a.form.tmsOrderPickup.pickupBatchNumber=a.pickupBatchNumber;var t=void 0,r=Object(h.objectMerge2)({},a.form);if(a.loading=!0,a.isModify)t=Object(m.i)(r);else{var i=!1;for(var s in r.tmsCustomer)a.sender[s]!==r.tmsCustomer[s]&&(i=!0);r.tmsCustomer.customerId=i?"":a.form.tmsCustomer.customerId,r.tmsOrderPickup.outTime=+new Date(a.form.tmsOrderPickup.outTime),t=Object(m.e)(r)}t.then(function(e){a.loading=!1,a.$refs[o].resetFields(),a.$emit("success"),a.closeMe(),a.$message.success("保存成功"),a.loading=!1}).catch(function(e){"提货批次已存在"===e.text?a.fetchGetPickUp():a._handlerCatchMsg(e),a.loading=!1})})},newInfoData:function(){this.form={tmsCustomer:{customerName:"",customerMobile:"",detailedAddress:"",customerId:""},tmsDriver:{driverName:"",driverMobile:"",driverId:""},tmsTruck:{truckIdNumber:"",truckType:"",truckUnit:"",truckId:""},tmsOrderPickup:{pickupBatchNumber:"",pickupName:"",pickupAmount:"",pickupVolume:"",pickupWeight:"",carriage:"",payMethod:76,toCityCode:"",toCityName:"",remark:"",truckFee:"",pickupStatus:236,collectionFee:"",outTime:new Date,arriveTime:""}}},reset:function(){this.watchInfo()},closeMe:function(e){this.reset(),this.$emit("update:popVisible",!1),"function"==typeof e&&e()}}}}});