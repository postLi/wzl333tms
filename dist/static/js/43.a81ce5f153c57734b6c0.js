webpackJsonp([43,303,306],{"6PPo":function(e,t,i){"use strict";var n={render:function(){var i=this,e=i.$createElement,n=i._self._c||e;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],staticClass:"receiptDialog",attrs:{title:i.dialogTitle,visible:i.isShow,"close-on-click-modal":!1,"before-close":i.closeMe},on:{"update:visible":function(e){i.isShow=e}}},[n("el-form",{ref:"formModel",attrs:{model:i.formModel,rules:i.rules}},[n("div",{attrs:{id:"settlementWaybill"}},[n("div",{staticClass:"receiptDialog_head"},[n("div",{staticClass:"receiptDialog_head_item"},[n("label",[i._v("单据号")]),i._v(" "),n("el-input",{attrs:{placeholder:"请输入",size:i.btnsize,disabled:""},model:{value:i.formModel.settlementSn,callback:function(e){i.$set(i.formModel,"settlementSn",e)},expression:"formModel.settlementSn"}})],1),i._v(" "),n("div",{staticClass:"receiptDialog_head_item"},[n("label",[i._v("发生时间")]),i._v(" "),n("el-date-picker",{attrs:{size:i.btnsize,"value-format":"yyyy-MM-dd HH:mm:ss",type:"date"},model:{value:i.formModel.settlementTime,callback:function(e){i.$set(i.formModel,"settlementTime",e)},expression:"formModel.settlementTime"}})],1),i._v(" "),n("div",{staticClass:"receiptDialog_head_item"},[n("label",[i._v("经办人")]),i._v(" "),n("querySelect",{attrs:{size:i.btnsize,valuekey:"name",show:"select",search:"name",label:"name"},model:{value:i.formModel.settlementBy,callback:function(e){i.$set(i.formModel,"settlementBy",e)},expression:"formModel.settlementBy"}})],1)]),i._v(" "),n("div",{staticClass:"receiptDialog_table"},[n("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{data:i.formModel.detailDtoList2,height:"100%",stripe:"","show-summary":"","summary-method":i.getSum}},[n("el-table-column",{attrs:{prop:"date",label:"序号",type:"index",width:"70"}}),i._v(" "),n("el-table-column",{attrs:{prop:"dataName",label:"费用项"}}),i._v(" "),n("el-table-column",[n("el-table-column",{attrs:{prop:"tenMillion",label:"千",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"million",label:"百",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"oneHundrenThousand",label:"十",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"tenThousand",label:"万",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"thousand",label:"千",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"hundren",label:"百",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"ten",label:"十",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"yuan",label:"元",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"jiao",label:"角",width:"40"}}),i._v(" "),n("el-table-column",{attrs:{prop:"fen",label:"分",width:"40"}})],1)],1)],1)]),i._v(" "),n("div",{staticClass:"receiptDialog_todo"},[n("el-button",{staticClass:"tableBtnAdd",attrs:{size:"mini"},on:{click:i.plusItem}}),i._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:i.formModel.szDtoList,border:"",height:"100%",stripe:""}},[n("el-table-column",{attrs:{fixed:"",width:"50"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"tableBtnMinus",attrs:{size:"mini"},on:{click:function(e){i.minusItem(t.row,t.$index)}}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"financialWay",label:"收支方式",width:"80"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-autocomplete",{attrs:{"popper-class":"querySelectItem",size:i.btnsize,"fetch-suggestions":i.querySearch,placeholder:"支付方式"},on:{select:function(e){return i.sender(e,t.$index)}},scopedSlots:i._u([{key:"default",fn:function(e){var t=e.item;return i._l(i.BANK_INFO,function(e){return n("span",[i._v(i._s(t[e]))])})}}]),model:{value:t.row.financialWay,callback:function(e){i.$set(t.row,"financialWay",e)},expression:"props.row.financialWay"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"bankName",label:"银行名称"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.bankName,callback:function(e){i.$set(t.row,"bankName",e)},expression:"props.row.bankName"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"bankAccount",label:"银行卡号",width:"200"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.bankAccount,callback:function(e){i.$set(t.row,"bankAccount",e)},expression:"props.row.bankAccount"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"bankAccountName",label:"开户人",width:"80"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.bankAccountName,callback:function(e){i.$set(t.row,"bankAccountName",e)},expression:"props.row.bankAccountName"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"chequeNumber",label:"支票号码"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.chequeNumber,callback:function(e){i.$set(t.row,"chequeNumber",e)},expression:"props.row.chequeNumber"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"receivableNumber",label:"汇款号码"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.receivableNumber,callback:function(e){i.$set(t.row,"receivableNumber",e)},expression:"props.row.receivableNumber"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"wechatAccount",label:"微信号"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.wechatAccount,callback:function(e){i.$set(t.row,"wechatAccount",e)},expression:"props.row.wechatAccount"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"alipayAccount",label:"支付宝号"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:i.btnsize,maxlength:i.maxlength},model:{value:t.row.alipayAccount,callback:function(e){i.$set(t.row,"alipayAccount",e)},expression:"props.row.alipayAccount"}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"agent",label:"经办人",width:"80"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("querySelect",{attrs:{size:i.btnsize,valuekey:"name",show:"select",search:"name",label:"name",maxlength:i.maxlength},model:{value:t.row.agent,callback:function(e){i.$set(t.row,"agent",e)},expression:"props.row.agent"}})]}}])})],1)],1),i._v(" "),n("div",{staticClass:"receiptDialog_remark"},[n("label",[i._v("备注")]),i._v(" "),n("el-input",{attrs:{placeholder:"最多可输入300个字符",size:i.btnsize,maxlength:300},model:{value:i.formModel.remark,callback:function(e){i.$set(i.formModel,"remark",e)},expression:"formModel.remark"}})],1)]),i._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:i.btnsize,icon:"el-icon-document"},on:{click:function(e){i.submitForm("formModel")}}},[i._v("保存")]),i._v(" "),n("el-button",{attrs:{type:"primary",size:i.btnsize,icon:"el-icon-printer"},on:{click:i.print}},[i._v("保存并打印")]),i._v(" "),n("el-button",{attrs:{type:"danger",size:i.btnsize,icon:"el-icon-circle-close-outline"},on:{click:i.closeMe}},[i._v("取 消")])],1)],1)},staticRenderFns:[]};t.a=n},"6f/H":function(e,t,i){"use strict";var n={render:function(){var i=this,e=i.$createElement,n=i._self._c||e;return n("el-autocomplete",{attrs:{size:i.btnsize,"fetch-suggestions":i.querySearch,placeholder:i.placeholderText,"prefix-icon":"el-icon-search"},on:{select:i.handleSelect},scopedSlots:i._u([{key:"default",fn:function(e){var t=e.item;return[t.shipSn?n("div",{staticClass:"name"},[i._v(i._s(t.shipSn))]):n("div",{staticClass:"name"},[i._v(i._s(t.batchNo))])]}}]),model:{value:i.currentSearch,callback:function(e){i.currentSearch=e},expression:"currentSearch"}})},staticRenderFns:[]};t.a=n},"7nIZ":function(e,t,i){"use strict";t.i=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/getBillRecordList/",e).then(function(e){return e.data})},t.h=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecorddetail/v1.3/getBillRecordDetailList/",e).then(function(e){return e.data})},t.j=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/getVerificationBaseInfo/",e).then(function(e){return e.data})},t.g=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/addIncome/",e).then(function(e){return e.data})},t.a=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/cancelVerification/",e).then(function(e){return e.data})},t.f=function(e){return n.b.post("/api-finance/finance/tmsfinanceverification/v1.3/getVeryficationList/",e).then(function(e){return e.data})},t.b=function(e){return n.b.post("/api-finance//finance/tmsfinancebillrecord/v1.3/delBillRecord/",e).then(function(e){return e.data})},t.e=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/getOrderList/",e).then(function(e){return e.data})},t.d=function(e){return n.b.post("/api-finance/finance/tmsfinancesubjects/v1.3/getFinanceSubjects/",e).then(function(e){return e.data})},t.c=function(e){return n.b.post("/api-finance/finance/tmsfinancebillrecord/v1.3/getBillRecordInfo",e).then(function(e){return e.data})};var n=i("Vo7i")},"8Nas":function(e,t,i){"use strict";var s=i("0xDb"),a=i("JW1v");t.a={props:{info:{type:Array,default:[]}},data:function(){return{currentSearch:"",btnsize:"mini",dataList:[]}},computed:{placeholderText:{get:function(){return-1!==this.$route.query.currentPage.indexOf("batch")?"请输入批次号":"请输入运单号"},set:function(){}},getRouteInfo:function(){return JSON.parse(this.$route.query.searchQuery)}},methods:{fetchData:function(e){var t=this,i=Object(s.objectMerge2)({},this.getRouteInfo);i.vo.status="NOSETTLEMENT,PARTSETTLEMENT";var n=void 0,o=this.$route.query.currentPage;return-1!==o.indexOf("batch")?(i.vo.batchNo=e,n=/(batchTruckAll|batchArrivalAll)/.test(o)?a.k:a.j):"handleFee"===o?(i.vo.batchNo=e,n=a.c):(i.vo.shipSn=e,n=a.g),n(i).then(function(e){e&&(t.dataList=Object(s.objectMerge2)([],e.list),console.log("this.dataList",t.dataList))}).catch(function(e){t._handlerCatchMsg(e)})},querySearch:function(n,o){var a=this;this.fetchData(n).then(function(){var e=Object(s.objectMerge2)([],a.dataList);a.currentSearch=n;var t=e||a.info,i=n?t.filter(a.createFilter(n)):t;o(i)})},createFilter:function(t){return function(e){return e.shipSn?-1!==e.shipSn.toLowerCase().indexOf(t.toLowerCase()):e.batchNo?-1!==e.batchNo.toLowerCase().indexOf(t.toLowerCase()):void 0}},handleSelect:function(e){e.shipSn?this.currentSearch=e.shipSn:e.batchNo&&(this.currentSearch=e.batchNo),this.currentSearch="",this.$emit("change",e,0)}}}},A1ZN:function(e,t,i){"use strict";var n=i("bOdI"),s=i.n(n),o=i("woOf"),r=i.n(o),a=i("Dd8w"),l=i.n(a),c=i("NYxO"),u=i("JW1v"),f=i("IcMT"),d=i("0xDb"),h=i("pAQG"),b=i("i5L8"),m=i("1onU"),p=i("DT23"),g=i("0xDb"),v=i("YoB2");t.a={name:"waybillKickback",components:{transferTable:f.a,querySelect:h.a,Receipt:b.default,Pager:m.a,currentSearch:p.default,Voucher:v.a},data:function(){var i=this;return{infoTable:{amount:0,orderList:[]},btnLoading:!1,textChangeDanger:[],currentSearch:"",tablekey:"",truckMessage:"",formModel:{},loading:!0,popVisibleDialog:!1,btnsize:"mini",totalLeft:0,tableReceiptInfo:[],orgLeftTable:[],selectedRight:[],selectedLeft:[],isGoReceipt:!0,leftTable:[],rightTable:[],orgData:{left:[],right:[]},feeType:49,searchQuery:{currentPage:1,pageSize:100,vo:{}},tableColumnLeft:[{label:"运单号",prop:"shipSn",width:"120",fixed:!0},{label:"货号",prop:"shipGoodsSn",width:"120",fixed:!0},{label:"开单网点",prop:"shipFromOrgName",width:"120",fixed:!1},{label:"核销状态",prop:"statusName",width:"120",fixed:!1},{label:"终端送货费",prop:"fee",width:"120",fixed:!1},{label:"已核销终端送货费",prop:"closeFee",width:"100",fixed:!1,slot:function(e){var t=e.row;return i._setTextColor(t.fee,t.closeFee,t.unpaidFee,t.closeFee)}},{label:"未核销终端送货费",prop:"unpaidFee",width:"100",fixed:!1,slot:function(e){var t=e.row;return i._setTextColor(t.fee,t.closeFee,t.unpaidFee,t.unpaidFee)}},{label:"实收送货费",prop:"fee",width:"120",fixed:!1},{label:"实付送货费",prop:"deliveryFeeToPay",width:"120",fixed:!1},{label:"差额",prop:"deliveryFeeDiffer",width:"120",fixed:!1},{label:"货品名",prop:"cargoName",width:"120",fixed:!1},{label:"开单时间",prop:"createTime",width:"120",fixed:!1,slot:function(e){return""+Object(d.parseTime)(e.row.createTime,"{y}-{m}-{d} {h}:{i}:{s}")}},{label:"发站",prop:"shipFromCityName",width:"120",fixed:!1},{label:"到站",prop:"shipToCityName",width:"120",fixed:!1},{label:"件数",prop:"cargoAmount",width:"120",fixed:!1},{label:"重量",prop:"cargoWeight",width:"120",fixed:!1},{label:"体积",prop:"cargoVolume",width:"120",fixed:!1},{label:"运单备注",prop:"shipRemarks",width:"120",fixed:!1}],tableColumnRight:[{label:"运单号",prop:"shipSn",width:"120",fixed:!0},{label:"货号",prop:"shipGoodsSn",width:"120",fixed:!0},{label:"开单网点",prop:"shipFromOrgName",width:"120",fixed:!1},{label:"核销状态",prop:"statusName",width:"120",fixed:!1},{label:"终端送货费",prop:"fee",width:"120",fixed:!1},{label:"已核销终端送货费",prop:"closeFee",width:"100",fixed:!1,slot:function(e){var t=e.row;return i._setTextColor(t.fee,t.closeFee,t.unpaidFee,t.closeFee)}},{label:"未核销终端送货费",prop:"unpaidFee",width:"100",fixed:!1,slot:function(e){var t=e.row;return i._setTextColor(t.fee,t.closeFee,t.unpaidFee,t.unpaidFee)}},{label:"实际核销终端送货费",prop:"deliveryFee",width:"120",fixed:!1,expand:!0,slot:function(e){return e.row.deliveryFee}},{label:"实收送货费",prop:"fee",width:"120",fixed:!1},{label:"实付送货费",prop:"deliveryFeeToPay",width:"120",fixed:!1},{label:"差额",prop:"deliveryFeeDiffer",width:"120",fixed:!1},{label:"货品名",prop:"cargoName",width:"120",fixed:!1},{label:"开单时间",prop:"createTime",width:"180",fixed:!1,slot:function(e){return""+Object(d.parseTime)(e.row.createTime,"{y}-{m}-{d} {h}:{i}:{s}")}},{label:"发站",prop:"shipFromCityName",width:"120",fixed:!1},{label:"到站",prop:"shipToCityName",width:"120",fixed:!1},{label:"件数",prop:"cargoAmount",width:"120",fixed:!1},{label:"重量",prop:"cargoWeight",width:"120",fixed:!1},{label:"体积",prop:"cargoVolume",width:"120",fixed:!1},{label:"运单备注",prop:"shipRemarks",width:"120",fixed:!1}]}},computed:l()({},Object(c.mapGetters)(["otherinfo"]),{getRouteInfo:function(){return console.log("xxxxxxxxxxxxxxxxxx:",this.$route.query,JSON.parse(this.$route.query.searchQuery)),JSON.parse(this.$route.query.searchQuery)},totalRight:function(){return this.rightTable.length}}),created:function(){this.searchQuery=r()({},this.getRouteInfo)},mounted:function(){console.log("xxxxxxxxxxxxxxxxxx333:",this.$route.query,JSON.parse(this.$route.query.searchQuery)),this.getList()},methods:{handlePageChangeLeft:function(e){this.searchQuery.currentPage=e.pageNum,this.searchQuery.pageSize=e.pageSize,console.log(e.pageSize,e.pageNum,e),this.pageGetList()},pageGetList:function(){var i=this,t=Object(d.objectMerge2)([],this.rightTable);this.loading=!0,this.$set(this.searchQuery.vo,"status","NOSETTLEMENT,PARTSETTLEMENT"),Object(u.g)(this.searchQuery).then(function(e){e&&(i.leftTable=r()([],e.list),i.totalLeft=e.total,t.forEach(function(t,e){i.leftTable=i.leftTable.filter(function(e){return e.shipSn!==t.shipSn})})),i.orgLeftTable=r()([],i.leftTable),i.loading=!1}).catch(function(e){i._handlerCatchMsg(e)})},initLeftParams:function(){this.searchQuery=r()({},this.getRouteInfo),0<JSON.parse(this.$route.query.selectListShipSns).length?console.log("111111111111111"):(console.log("22222222222222222"),this.searchQuery.currentPage=1),this.$set(this.searchQuery.vo,"feeType",this.feeType),this.$set(this.searchQuery.vo,"status","NOSETTLEMENT,PARTSETTLEMENT")},getList:function(e){var i=this,t=JSON.parse(this.$route.query.selectListShipSns),n=r()([],t);this.$route.query.selectListShipSns?this.isModify=!0:this.isModify=!1,this.leftTable=this.$options.data().leftTable,this.rightTable=this.$options.data().rightTable,this.infoTable=this.$options.data().infoTable,this.orgLeftTable=this.$options.data().orgLeftTable,e||this.initLeftParams(),Object(u.g)(this.searchQuery).then(function(e){i.leftTable=r()([],e.list),i.totalLeft=e.total,n.forEach(function(t){i.leftTable.forEach(function(e){t===e.shipSn&&i.rightTable.push(e)})}),i.rightTable.length<1?i.isGoReceipt=!0:i.isGoReceipt=!1,i.rightTable.forEach(function(e){e.deliveryFee=e.unpaidFee;var t=i.leftTable.indexOf(e);-1!==t&&i.leftTable.splice(t,1)}),i.orgLeftTable=r()([],i.leftTable),i.loading=!1}).catch(function(e){i.loading=!1,i._handlerCatchMsg(e)})},changLoadData:function(e,t,i){this.rightTable[e][t]=Number(i);var n="unpaidFee",o=Number(this.rightTable[e][n]),a=this.rightTable[e][t];a<0||o<a?(this.$message({type:"warning",message:"实际核销费用不小于0，不大于未核销费用。"}),this.isGoReceipt=!0):(this.isGoReceipt=!1,this.$set(this.rightTable,e,r()(this.rightTable[e],s()({},t,this.rightTable[e][t])))),a!==o?this.$set(this.textChangeDanger,e,!0):this.$set(this.textChangeDanger,e,!1),console.log(e,a,o,n,this.rightTable[e][n],this.rightTable[e][t],this.rightTable[e])},clickDetailsRight:function(e){this.$refs.multipleTableRight.toggleRowSelection(e)},clickDetailsLeft:function(e){this.$refs.multipleTableLeft.toggleRowSelection(e)},getSelectionRight:function(e){this.selectedRight=e},getSelectionLeft:function(e){this.selectedLeft=e},changeTableKey:function(){this.tablekey=(new Date).getTime()},doAction:function(e){switch(e){case"goLeft":this.goLeft();break;case"goRight":this.goRight()}},goLeft:function(){var i=this;0===this.selectedRight.length||(this.selectedRight.forEach(function(t,e){t.deliveryFee=t.unpaidFee,i.rightTable=Object(d.objectMerge2)([],i.rightTable).filter(function(e){return e.shipSn!==t.shipSn}),i.rightTable.push(t),i.leftTable=Object(d.objectMerge2)([],i.leftTable).filter(function(e){return e.shipSn!==t.shipSn}),i.orgLeftTable=Object(d.objectMerge2)([],i.orgLeftTable).filter(function(e){return e.shipSn!==t.shipSn})}),this.selectedRight=[]),this.rightTable.length<1?this.isGoReceipt=!0:this.isGoReceipt=!1},goRight:function(){var i=this;0===this.selectedLeft.length?this.$message({type:"warning",message:"请在右边表格选择数据"}):(this.selectedLeft.forEach(function(t,e){i.leftTable=Object(d.objectMerge2)([],i.leftTable).filter(function(e){return e.shipSn!==t.shipSn}),i.orgLeftTable=Object(d.objectMerge2)([],i.orgLeftTable).filter(function(e){return e.shipSn!==t.shipSn}),i.leftTable.push(t),i.orgLeftTable.push(t),i.rightTable=Object(d.objectMerge2)([],i.rightTable).filter(function(e){return e.shipSn!==t.shipSn})}),this.selectedLeft=[]),this.rightTable.length<1?this.isGoReceipt=!0:this.isGoReceipt=!1},dclickAddItem:function(e,t){this.selectedRight=[],this.selectedRight.push(e),this.doAction("goLeft")},dclickMinusItem:function(e,t){this.selectedLeft=[],this.selectedLeft.push(e),this.doAction("goRight")},selectCurrent:function(e,t){this.addItem(e,t)},addItem:function(e,t){this.selectedRight=[],this.selectedRight[t]=e,this.doAction("goLeft")},minusItem:function(e,t){this.selectedLeft=[],this.selectedLeft[t]=e,this.doAction("goRight")},addALLList:function(){this.selectedRight=r()([],this.leftTable),this.doAction("goLeft")},minusAllList:function(){this.selectedLeft=r()([],this.rightTable),this.doAction("goRight")},closeDialog:function(){this.popVisibleDialog=!1},openDialog:function(){this.popVisibleDialog=!0},goReceipt:function(){var n=this;if(this.infoTable=this.$options.data().infoTable,!this.isGoReceipt){var o=0;this.rightTable.forEach(function(e,t){if(console.log("右边列表",t,e),0<e.deliveryFee&&e.deliveryFee<=e.unpaidFee){var i=s()({shipId:e.shipId,shipSn:e.shipSn,shipGoodsSn:e.shipGoodsSn,createTime:e.createTime,deliveryFee:e.deliveryFee,shipFromCityName:e.shipFromCityName,shipToCityName:e.shipToCityName,shipReceiverName:e.receiverCustomerName,shipSenderName:e.senderCustomerName},"shipGoodsSn",e.shipGoodsSn);o=d.tmsMath._add(o,e.deliveryFee),n.infoTable.orderList.push(i),i={}}}),this.infoTable.amount=o,(o=0)<this.infoTable.orderList.length?this.openDialog():this.$message({type:"warning",message:"暂无可核销项！实际核销费用不小于0，不大于未核销费用。"})}},getSumRight:function(e){return Object(g.getSummaries)(e,["_index|2|单","fee","unpaidFee","closeFee","cargoAmount|","cargoWeight|","cargoVolume|"])},getSumLeft:function(e){return Object(g.getSummaries)(e,["_index|2|单","fee","unpaidFee","closeFee","deliveryFee","cargoAmount|","cargoWeight|","cargoVolume|"])}}}},DT23:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("8Nas"),o=i("6f/H"),a=i("VU/8")(n.a,o.a,null,null,null);t.default=a.exports},DkQc:function(e,t,i){"use strict";var n=i("woOf"),a=i.n(n),s=(i("t5DY"),i("0xDb")),o=i("7nIZ"),r=i("JW1v"),l=i("E4LH");t.a={props:{popVisible:{type:Boolean,default:!1},orgId:{type:[String,Number],default:""},info:{type:[Object,Array],default:function(){return[]}}},watch:{popVisible:{handler:function(e,t){e&&this.init()},immediate:!0},info:{handler:function(e,t){console.log("voucher 接收到的数据::",e)},deep:!0},orgId:{handler:function(e,t){console.log("orgId",e,t)},immediate:!0,deep:!0}},computed:{isShow:{get:function(){return this.popVisible},set:function(){}},currentPage:function(){var e=this.$route.query.currentPage;return e.substr(7,e.length)},dataName:function(){switch(this.$route.query.currentPage){case"waybillKickback":return"回扣";case"waybillTicket":return"单票提货费";case"waybillOther":return"其他费用支出";case"waybillTransfer":return"中转费";case"waybillAbnormal":return"异常理赔";case"waybillUnusual":return"异动费用核销";case"waybillTerminal":return"终端送货费"}},getRouteInfo:function(){return JSON.parse(this.$route.query.searchQuery)},feeId:function(){return JSON.parse(this.$route.query.searchQuery).vo.feeType}},data:function(){var e=function(e,t,i){l.a.ENGLISH_AND_NUMBER.test(t)||""===t?i():i(new Error("只可以输入阿拉伯数字和字母, 最多可输入25位"))};return{btnLoading:!1,dialogTitle:"核销凭证",loading:!0,btnsize:"mini",baseQuery:{orgId:"",amount:0,feeIds:""},formModel:{verificationWay:"",paymentsType:"",amount:"",certTime:"",receiptNo:"",invoiceNo:"",checkNo:"",remark:"",subjectOneName:"",subjectOneId:"",subjectTwoName:"",subjectTwoId:"",subjectThreeName:"",subjectThreeId:"",subjectFourName:"",subjectFourId:""},rules:{verificationId:[{required:!0,message:"请填写记账方向!",trigger:"blur"}],subjectOneId:[{required:!0,message:"请填写一级科目!",trigger:"blur"}],receiptNo:[{validator:e,trigger:"blur"}],invoiceNo:[{validator:e,trigger:"blur"}],checkNo:[{validator:e,trigger:"blur"}],manualCert:[{validator:e,trigger:"blur"}]},veryficationType:{},veryficationList:[],subjectOne:[],subjectTwo:[],subjectThree:[],subjectFour:[],searchQuerySub:{orgId:"",parentId:"",subjectLevel:""}}},methods:{init:function(){this.baseQuery=this.$options.data().baseQuery,this.postVerificationBaseInfo(),this.formModel.amount=this.info.amount||0},postVerificationBaseInfo:function(){var i=this;this.baseQuery.orgId=this.orgId||this.otherinfo.orgid,this.baseQuery.amount=this.info.amount,console.log("getRouteInfo",this.getRouteInfo,this.feeId),this.baseQuery.feeIds=this.feeId+"",this.$set(this.baseQuery,"dataSrc",0),this.$set(this.baseQuery,"companyId",this.otherinfo.companyId),Object(o.j)(this.baseQuery).then(function(e){e&&(i.subjectOne=e.subOneList||[],i.subjectTwo=e.subTwoList||[],i.subjectThree=e.subThreeList||[],i.subjectFour=e.subFourList||[],i.formModel=e,i.loading=!1,e.verificationList&&(i.veryficationList=e.verificationList||[],e.verificationList.forEach(function(e,t){i.veryficationType[e.id]=e.verificationWay})))}).catch(function(e){i.loading=!1,i._handlerCatchMsg(e)})},initSubject:function(){var t=this;this.getFinanceSubjects().then(function(){if(t.formModel.subjectOneId){if(!t.checkSubject(1)){for(var e in t.formModel)/^subject/.test(e)&&(t.formModel[e]="");return}t.getFinanceSubjects(2,t.formModel.subjectOneId).then(function(){if(t.formModel.subjectTwoId){if(!t.checkSubject(2)){for(var e in t.formModel)/(Four|Three|Two)/.test(e)&&(t.formModel[e]="");return}t.getFinanceSubjects(3,t.formModel.subjectTwoId).then(function(){if(t.formModel.subjectThreeId){if(!t.checkSubject(3)){for(var e in t.formModel)/(Four|Three)/.test(e)&&(t.formModel[e]="");return}t.getFinanceSubjects(4,t.formModel.subjectThreeId).then(function(){if(t.formModel.subjectFourId&&!t.checkSubject(4))return t.formModel.subjectFourId="",void(t.formModel.subjectFourName="")})}})}})}})},checkSubjectIsNull:function(){return!(0<this.subjectTwo.length)||(this.formModel.subjectTwoId?!(0<this.subjectThree.length)||(this.formModel.subjectThreeId?!(0<this.subjectFour.length)||(!!this.formModel.subjectFourId||(this.$message.warning("请填写四级科目"),!1)):(this.$message.warning("请填写三级科目"),!1)):(this.$message.warning("请填写二级科目!"),!1))},submitForm:function(e){var o=this;this.checkSubjectIsNull()&&this.$refs[e].validate(function(e){if(e){o.btnLoading=!0;var t=a()({},o.formModel);o.$set(t,"orderList",o.info.orderList),o.$set(t,"dataSrc",0),t.certTime||(t.certTime=new Date),o.$set(t,"certTime",Object(s.parseTime)(t.certTime,"{y}-{m}-{d}")+" 00:00:00"),delete t.verificationList;var i={shipPayableFeeDtos:t.orderList,tmsFinanceBillRecordDto:t};delete i.tmsFinanceBillRecordDto.orderList;var n="";n="中转费"===o.dataName?o.getRouteInfo.vo.transferOrgid:"异常理赔"===o.dataName?o.getRouteInfo.vo.orgid:o.getRouteInfo.vo.shipFromOrgid,Object(r.d)(n,i).then(function(e){o.$message.success("保存成功！"),o.btnLoading=!1,o.popVisibleDialog=!1;var t=o.currentPage.substring(0,1).toLowerCase()+o.currentPage.substring(1);o.$router.push({path:"./accountsPayable/waybill/"+t})}).catch(function(e){o._handlerCatchMsg(e),o.btnLoading=!1})}})},setting:function(){this.$router.push({path:"/finance/financeInfo/subjectInfo"})},checkSubject:function(e){var t=this;switch(e){case 1:if(0<this.subjectOne.length)return 0!==this.subjectOne.filter(function(e){return e.id===t.formModel.subjectOneId}).length||(this.formModel.subjectOneId="",this.formModel.subjectOneName="",!1);break;case 2:if(0<this.subjectTwo.length)return 0!==this.subjectTwo.filter(function(e){return e.id===t.formModel.subjectTwoId}).length||(this.formModel.subjectTwoId="",this.formModel.subjectTwoName="",!1);break;case 3:if(0<this.subjectThree.length)return 0!==this.subjectThree.filter(function(e){return e.id===t.formModel.subjectThreeId}).length||(this.formModel.subjectThreeId="",this.formModel.subjectThreeName="",!1);break;case 4:if(0<this.subjectFour.length)return 0!==this.subjectFour.filter(function(e){return e.id===t.formModel.subjectFourId}).length||(this.formModel.subjectFourId="",this.formModel.subjectFourName="",!1)}},getFinanceSubjects:function(t,e){var i=this;return console.log("接口查询下级科目列表：\n",t,e),this.searchQuerySub.subjectLevel=t||"",this.searchQuerySub.parentId=e||"",this.searchQuerySub.orgId=this.orgId||this.otherinfo.orgid,Object(o.d)(this.searchQuerySub).then(function(e){switch(t){case 2:i.subjectTwo=e,i.subjectTwo.forEach(function(e,t){console.log(t,e.id)}),i.subjectThree=[],i.subjectFour=[],console.log("科目二: ",i.subjectTwo);break;case 3:i.subjectThree=e,i.subjectThree.forEach(function(e,t){console.log(t,e.id)}),i.subjectFour=[],console.log("科目三: ",i.subjectThree);break;case 4:i.subjectFour=e,i.subjectFour.forEach(function(e,t){console.log(t,e.id)}),console.log("科目四: ",i.subjectFour);break;default:i.subjectOne=e,i.subjectTwo=[],i.subjectThree=[],i.subjectFour=[],console.log("科目一: ",i.subjectOne),i.subjectOne.forEach(function(e,t){console.log(t,e.id)})}i.loading=!1,console.log("科目: ",t,e)}).catch(function(e){i.loading=!1,i._handlerCatchMsg(e)})},selectSubject:function(t,e){console.log(t);var i={};switch(e){case 1:for(var n in i=a()({},this.subjectOne.filter(function(e){return e.id===t})[0]),this.getFinanceSubjects(2,i.id),this.formModel)/^subject/.test(n)&&(this.formModel[n]="");this.formModel.subjectOneName=i.subjectName,this.formModel.subjectOneId=i.id,console.log("科目一 选中的值",i);break;case 2:for(var o in i=a()({},this.subjectTwo.filter(function(e){return e.id===t})[0]),this.getFinanceSubjects(3,i.id),this.formModel)/(Four|Three)/.test(o)&&(this.formModel[o]="");this.formModel.subjectTwoName=i.subjectName,console.log("科目二 选中的值",i);break;case 3:i=a()({},this.subjectThree.filter(function(e){return e.id===t})[0]),this.getFinanceSubjects(4,i.id),this.formModel.subjectThreeName=i.subjectName,this.formModel.subjectFourName="",this.formModel.subjectFourId="",console.log("科目三 选中的值",i);break;case 4:i=a()({},this.subjectFour.filter(function(e){return e.id===t})[0]),this.formModel.subjectFourName=i.subjectName}i={},console.log("formModel",this.formModel)},selectVerificationWay:function(t){var e;e=this.formModel.verificationList.filter(function(e){return e.id===t})[0],this.$set(this.formModel,"verificationWay",e.verificationWay),console.log("选中方向：：",e,this.formModel)},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()}}}},IcMT:function(e,t,i){"use strict";var n=i("PI8x"),o=i("QVoP");var a=function(e){i("jCPK")},s=i("VU/8")(n.a,o.a,a,null,null);t.a=s.exports},JW1v:function(e,t,i){"use strict";t.g=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/findListByFeeType/",e).then(function(e){return console.log("postFindListByFeeType22222222222222"),e.data||{list:[],totalCount:0}})},t.h=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/findTransferList/",e).then(function(e){return e.data||{list:[],totalCount:0}})},t.e=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/findAbnormalList/",e).then(function(e){return e.data||{list:[],totalCount:0}})},t.f=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/findChangeList/",e).then(function(e){return e.data||{list:[],totalCount:0}})},t.d=function(e,t){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/create/"+e,t).then(function(e){return e.data})},t.k=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/payListBySummary/",e).then(function(e){return e.data||{list:[],totalCount:0}})},t.j=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/payListByOne/",e).then(function(e){return e.data||{list:[],totalCount:0}})},t.a=function(e,t){return n.b.get("/api-finance/finance/tmsfinancecapitalflow/v1/getFeeInfo/?orgId="+e+"&paymentsType="+t)},t.i=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/loadSettlement/",e).then(function(e){return e.data})},t.b=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/loadVerification",e).then(function(e){return e.data})},t.c=function(e){return n.b.post("/api-finance/finance/tmsfinancefeepayable/v1/payListByHandlingFee",e).then(function(e){return e.data})};var n=i("Vo7i");i("0xDb")},PABe:function(e,t,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"incomeDialog",attrs:{title:t.dialogTitle,visible:t.isShow,"close-on-click-modal":!1,"before-close":t.closeMe},on:{"update:visible":function(e){t.isShow=e}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"formModel",attrs:{model:t.formModel,rules:t.rules,inline:!0,"label-width":"120px"}},[i("div",{staticClass:"income_item"},[i("el-form-item",{staticClass:"formItemTextDanger",attrs:{label:"方向",prop:"verificationId"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择",size:t.btnsize},on:{change:t.selectVerificationWay},model:{value:t.formModel.verificationId,callback:function(e){t.$set(t.formModel,"verificationId",e)},expression:"formModel.verificationId"}},t._l(t.veryficationList,function(e,t){return i("el-option",{key:t,attrs:{value:e.id,label:e.verificationWay}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"发生金额",prop:"amount"}},[i("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],attrs:{placeholder:"发生金额",size:t.btnsize,maxlength:8,disabled:""},model:{value:t.formModel.amount,callback:function(e){t.$set(t.formModel,"amount",t._n(e))},expression:"formModel.amount"}})],1)],1),t._v(" "),i("div",{staticClass:"income_item"},[i("el-form-item",{class:{formItemTextDanger:"1"===t.formModel.isNeededVoucher},attrs:{label:"一级科目",prop:"1"===t.formModel.isNeededVoucher?"subjectOneId":""}},[i("el-select",{attrs:{filterable:"",placeholder:"无数据",size:t.btnsize,disabled:"1"!==t.formModel.isNeededVoucher,size:"mini"},on:{change:function(e){return t.selectSubject(e,1)},clear:t.initSubject},model:{value:t.formModel.subjectOneId,callback:function(e){t.$set(t.formModel,"subjectOneId",e)},expression:"formModel.subjectOneId"}},t._l(t.subjectOne,function(e,t){return i("el-option",{key:t,attrs:{label:e.subjectName,value:e.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"凭证日期",prop:"certTime"}},[i("el-date-picker",{attrs:{type:"date",size:t.btnsize,placeholder:"选择日期",clearable:!1},model:{value:t.formModel.certTime,callback:function(e){t.$set(t.formModel,"certTime",e)},expression:"formModel.certTime"}})],1)],1),t._v(" "),i("div",{staticClass:"income_item"},[i("el-form-item",{class:0<t.subjectTwo.length?"formItemTextDanger":"",attrs:{label:"二级科目"}},[i("el-select",{attrs:{filterable:"",placeholder:"无数据",size:t.btnsize,disabled:"1"!==t.formModel.isNeededVoucher,size:"mini"},on:{change:function(e){return t.selectSubject(e,2)}},model:{value:t.formModel.subjectTwoId,callback:function(e){t.$set(t.formModel,"subjectTwoId",e)},expression:"formModel.subjectTwoId"}},t._l(t.subjectTwo,function(e,t){return i("el-option",{key:t,attrs:{label:e.subjectName,value:e.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"收据号码",prop:"receiptNo"}},[i("el-input",{attrs:{placeholder:"收据号码",size:t.btnsize,maxlength:25},model:{value:t.formModel.receiptNo,callback:function(e){t.$set(t.formModel,"receiptNo",e)},expression:"formModel.receiptNo"}})],1)],1),t._v(" "),i("div",{staticClass:"income_item"},[i("el-form-item",{class:0<t.subjectThree.length?"formItemTextDanger":"",attrs:{label:"三级科目"}},[i("el-select",{attrs:{filterable:"",placeholder:"无数据",size:t.btnsize,disabled:"1"!==t.formModel.isNeededVoucher},on:{change:function(e){return t.selectSubject(e,3)}},model:{value:t.formModel.subjectThreeId,callback:function(e){t.$set(t.formModel,"subjectThreeId",e)},expression:"formModel.subjectThreeId"}},t._l(t.subjectThree,function(e,t){return i("el-option",{key:t,attrs:{label:e.subjectName,value:e.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"发票号码",prop:"invoiceNo"}},[i("el-input",{attrs:{placeholder:"发票号码",size:t.btnsize,maxlength:25},model:{value:t.formModel.invoiceNo,callback:function(e){t.$set(t.formModel,"invoiceNo",e)},expression:"formModel.invoiceNo"}})],1)],1),t._v(" "),i("div",{staticClass:"income_item"},[i("el-form-item",{class:0<t.subjectFour.length?"formItemTextDanger":"",attrs:{label:"四级科目"}},[i("el-select",{attrs:{filterable:"",placeholder:"无数据",size:t.btnsize,disabled:"1"!==t.formModel.isNeededVoucher},on:{change:function(e){return t.selectSubject(e,4)}},model:{value:t.formModel.subjectFourId,callback:function(e){t.$set(t.formModel,"subjectFourId",e)},expression:"formModel.subjectFourId"}},t._l(t.subjectFour,function(e,t){return i("el-option",{key:t,attrs:{label:e.subjectName,value:e.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"支票号码",prop:"checkNo"}},[i("el-input",{attrs:{placeholder:"支票号码",size:t.btnsize,maxlength:25},model:{value:t.formModel.checkNo,callback:function(e){t.$set(t.formModel,"checkNo",e)},expression:"formModel.checkNo"}})],1)],1),t._v(" "),i("div",{staticClass:"income_item"},[i("el-form-item",{attrs:{label:"摘要"}},[i("el-input",{attrs:{type:"textarea",placeholder:"摘要",size:t.btnsize,maxlength:50},model:{value:t.formModel.remark,callback:function(e){t.$set(t.formModel,"remark",e)},expression:"formModel.remark"}})],1),t._v(" "),i("el-form-item")],1)]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-document",loading:t.btnLoading},on:{click:function(e){t.submitForm("formModel")}}},[t._v("保存")]),t._v(" "),"1"===t.formModel.isNeededVoucher?i("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-setting"},on:{click:t.setting}},[t._v("设置财务科目")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-circle-close"},on:{click:t.closeMe}},[t._v("取消")])],1)],1)},staticRenderFns:[]};t.a=n},PI8x:function(e,t,i){"use strict";t.a={data:function(){return{isShowLeft:!1,isShowRight:!1,isShowReback:!1,searchForm:""}},methods:{doAction:function(e){switch(e){case"showAllLeft":this.showAllLeft();break;case"showAllRight":this.showAllRight();break;case"showReback":this.showReback()}},showAllLeft:function(){this.isShowLeft=!0,this.isShowRight=!1,this.isShowReback=!0},showAllRight:function(){this.isShowLeft=!1,this.isShowRight=!0,this.isShowReback=!0},showReback:function(){this.isShowReback=!1,this.isShowLeft=!1,this.isShowRight=!1}}}},QVoP:function(e,t,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"transferTable"},[i("div",{staticClass:"transferTable_header"},[i("div",{staticClass:"transferTable_searchs"},[i("div",{staticClass:"transferTable_fresh"},[t._t("tableRefresh")],2),t._v(" "),t._t("tableSearch")],2),t._v(" "),i("div",{staticClass:"transferTable_header_btn_direction"},[i("el-tooltip",{attrs:{effect:"dark",content:"向左侧拉伸",placement:"top-end"}},[i("el-button",{attrs:{icon:"el-icon-arrow-right",type:"primary",circle:"",disabled:t.isShowLeft,size:"mini",plain:""},on:{click:function(e){t.doAction("showAllLeft")}}})],1),t._v(" "),i("el-tooltip",{attrs:{effect:"dark",content:"向右侧拉伸",placement:"top-start"}},[i("el-button",{attrs:{icon:"el-icon-arrow-left",type:"primary",circle:"",disabled:t.isShowRight,size:"mini",plain:""},on:{click:function(e){t.doAction("showAllRight")}}})],1),t._v(" "),i("transition",{attrs:{name:"el-zoom-in-bottom"}},[t.isShowReback?i("el-button",{attrs:{icon:"el-icon-refresh",type:"primary",circle:"",size:"mini",plain:""},on:{click:function(e){t.doAction("showReback")}}}):t._e()],1),t._v(" "),i("div",{staticClass:"transferTable_header_btn_box clearfix"},[t._t("btnsBox")],2)],1)]),t._v(" "),i("div",{staticClass:"transferTable_content"},[i("div",{staticClass:"transferTable_content_table paddingRight",class:[t.isShowLeft?"showTableLeft":t.isShowRight?"shortTableLeft":""]},[t._t("tableLeft",[t._v("左边表格区")])],2),t._v(" "),i("div",{staticClass:"transferTable_content_table",class:[t.isShowRight?"showTableRight":""]},[t._t("tableRight",[t._v("右边表格区")])],2)])])},staticRenderFns:[]};t.a=n},YoB2:function(e,t,i){"use strict";var n=i("DkQc"),o=i("PABe"),a=i("VU/8")(n.a,o.a,null,null,null);t.a=a.exports},bOdI:function(e,t,i){"use strict";t.__esModule=!0;var n,o=i("C4MV"),a=(n=o)&&n.__esModule?n:{default:n};t.default=function(e,t,i){return t in e?(0,a.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},endO:function(e,t,i){"use strict";var n={render:function(){var n=this,e=n.$createElement,o=n._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"accountsLoad_table"},[o("div",{staticClass:"transferTable_search clearfix"},[o("currentSearch",{attrs:{info:n.orgLeftTable},on:{change:n.selectCurrent}})],1),n._v(" "),o("transferTable",{staticStyle:{height:"calc(100% - 40px)",padding:"10px"}},[o("div",{attrs:{slot:"btnsBox"},slot:"btnsBox"},[o("el-button",{attrs:{type:n.isGoReceipt?"info":"success",size:"mini",icon:"el-icon-sort",disabled:n.isGoReceipt},on:{click:n.goReceipt}},[n._v("核销")])],1),n._v(" "),o("div",{staticClass:"tableHeadItemBtn tableHeadItemBtnHeight",attrs:{slot:"tableLeft"},slot:"tableLeft"},[o("el-button",{staticClass:"tableAllBtn",attrs:{size:"mini"},on:{click:n.addALLList}}),n._v(" "),o("el-table",{key:n.tablekey,ref:"multipleTableRight",attrs:{data:n.leftTable,border:"","tooltip-effect":"dark",triped:"",height:"100%","summary-method":n.getSumRight,"default-sort":{prop:"id",order:"ascending"},"show-overflow-tooltip":!0,"show-summary":!0},on:{"row-click":n.clickDetailsRight,"selection-change":n.getSelectionRight,"row-dblclick":n.dclickAddItem}},[o("el-table-column",{attrs:{fixed:"",width:"60",label:"序号"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n            "+n._s(e.$index+1)+"\n          ")]}}])}),n._v(" "),o("el-table-column",{attrs:{fixed:"",width:"50"},scopedSlots:n._u([{key:"default",fn:function(t){return[o("el-button",{staticClass:"tableItemBtn",attrs:{size:"mini"},on:{click:function(e){n.addItem(t.row,t.$index)}}})]}}])}),n._v(" "),n._l(n.tableColumnLeft,function(i){return[i.slot?o("el-table-column",{key:i.id,attrs:{fixed:i.fixed,sortable:"",label:i.label,width:i.width,prop:i.prop},scopedSlots:n._u([{key:"default",fn:function(t){return[i.expand?o("div",[o("el-input",{class:{textChangeDanger:n.textChangeDanger[t.$index]},attrs:{type:"number",size:n.btnsize},on:{change:function(e){return n.changLoadData(t.$index,i.prop,e)}},nativeOn:{dblclick:function(e){e.stopPropagation(),e.preventDefault()}},model:{value:i.slot(t),callback:function(e){n.$set(i,"slot(scope)",n._n(e))},expression:"column.slot(scope)"}})],1):o("div",[i.click?o("span",{staticClass:"clickitem",domProps:{innerHTML:n._s(i.slot(t))},on:{click:function(e){e.stopPropagation(),i.click(t)}}}):o("span",{domProps:{innerHTML:n._s(i.slot(t))}})])]}}])}):o("el-table-column",{key:i.id,attrs:{fixed:i.fixed,sortable:"",label:i.label,prop:i.prop,width:i.width}})]})],2),n._v(" "),o("div",{staticClass:"accountsLoad_table_pager"},[o("b",[n._v("共计:"+n._s(n.totalLeft))]),n._v(" "),o("div",{staticClass:"show_pager"},[o("Pager",{attrs:{total:n.totalLeft,btnsize:"mini",defaultValues:n.searchQuery},on:{change:n.handlePageChangeLeft}})],1)])],1),n._v(" "),o("div",{staticClass:"tableHeadItemBtn tableHeadItemBtnHeight",attrs:{slot:"tableRight"},slot:"tableRight"},[o("el-button",{staticClass:"tableAllBtnMinus",attrs:{size:"mini"},on:{click:n.minusAllList}}),n._v(" "),o("el-table",{key:n.tablekey,ref:"multipleTableLeft",staticStyle:{height:"100%"},attrs:{data:n.rightTable,border:"","tooltip-effect":"dark",triped:"",height:"100%","summary-method":n.getSumLeft,"default-sort":{prop:"id",order:"ascending"},"show-summary":!0},on:{"row-click":n.clickDetailsLeft,"selection-change":n.getSelectionLeft,"row-dblclick":n.dclickMinusItem}},[o("el-table-column",{attrs:{fixed:"",width:"60",label:"序号"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n            "+n._s(e.$index+1)+"\n          ")]}}])}),n._v(" "),o("el-table-column",{attrs:{fixed:"",width:"50"},scopedSlots:n._u([{key:"default",fn:function(t){return[o("el-button",{staticClass:"tableItemBtnMinus",attrs:{size:"mini"},on:{click:function(e){n.minusItem(t.row,t.$index)}}})]}}])}),n._v(" "),n._l(n.tableColumnRight,function(i){return[i.slot?o("el-table-column",{key:i.id,attrs:{fixed:i.fixed,sortable:"",label:i.label,width:i.width,prop:i.prop},scopedSlots:n._u([{key:"default",fn:function(t){return[i.expand?o("div",[o("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],class:{textChangeDanger:n.textChangeDanger[t.$index]},attrs:{type:"number",size:n.btnsize},on:{change:function(e){return n.changLoadData(t.$index,i.prop,e)}},nativeOn:{dblclick:function(e){e.stopPropagation(),e.preventDefault()},click:function(e){e.stopPropagation(),e.preventDefault()}},model:{value:i.slot(t),callback:function(e){n.$set(i,"slot(scope)",n._n(e))},expression:"column.slot(scope)"}})],1):o("div",[i.click?o("span",{staticClass:"clickitem",domProps:{innerHTML:n._s(i.slot(t))},on:{click:function(e){e.stopPropagation(),i.click(t)}}}):o("span",{domProps:{innerHTML:n._s(i.slot(t))}})])]}}])}):o("el-table-column",{key:i.id,attrs:{fixed:i.fixed,sortable:"",label:i.label,prop:i.prop,width:i.width}})]})],2),n._v(" "),o("div",{staticClass:"accountsLoad_table_pager"},[o("b",[n._v("共计:"+n._s(n.totalRight))]),n._v(" "),o("div",{staticClass:"show_pager"})])],1)]),n._v(" "),o("Voucher",{attrs:{popVisible:n.popVisibleDialog,info:n.infoTable,orgId:n.getRouteInfo.vo.shipFromOrgid,btnLoading:n.btnLoading},on:{close:n.closeDialog}})],1)},staticRenderFns:[]};t.a=n},i5L8:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("pH7i"),o=i("6PPo"),a=i("VU/8")(n.a,o.a,null,null,null);t.default=a.exports},jCPK:function(e,t){},pH7i:function(e,t,i){"use strict";var n=i("woOf"),o=i.n(n),a=i("Dd8w"),s=i.n(a),r=(i("E4LH"),i("NYxO")),l=i("JW1v"),c=i("t5DY"),u=i("0xDb"),f=i("Q0Ca"),d=i("pAQG"),h=i("UQm2"),b=i("xAap");t.a={components:{querySelect:d.a},data:function(){return{maxlength:30,amount:0,amountMessage:"",formModel:{detailDtoList2:[],settlementBy:""},loading:!0,financialWalList:[],rules:{},btnsize:"mini",dialogTitle:"结 算 付 款 单",submitData:{},BANK_INFO:["financialWay","bankName","bankAccount","bankAccountName","chequeNumber","receivableNumber","wechatAccount","alipayAccount","agent"],paymentsType:1}},computed:s()({},Object(r.mapGetters)(["otherinfo"]),{isShow:{get:function(){return this.popVisible},set:function(){}},getRouteInfo:function(){return JSON.parse(this.$route.query.searchQuery)},settlementTypeId:function(){switch(this.$route.query.currentPage){case"batchArrivalAll":return 179}},dataName:function(){switch(this.$route.query.currentPage){case"waybillKickback":return"回扣";case"waybillTicket":return"单票提货费";case"waybillOther":return"其他费用支出";case"waybillTransfer":return"中转费";case"waybillAbnormal":return"异常理赔";case"waybillUnusual":return"异动费用核销"}},currentPage:function(){var e=this.$route.query.currentPage;return e.substr(7,e.length)}}),props:{popVisible:{type:Boolean,default:!1},info:{type:Array,default:[]}},watch:{popVisible:function(){this.popVisible?(this.isShow=!0,this.getFeeInfo()):this.isShow=!1},info:function(e){if(e)return this.info}},mounted:function(){var e=this;this.postTmsFfinancialwayList(),this.$nextTick(function(){e.init()})},methods:{valueNumber:function(e){return e.replace(/[^\d]/g,"")},print:function(){var e=o()(this.formModel);this.$set(e,"amountMessage",this.amountMessage),Object(h.f)(e),this.submitForm("formModel")},postTmsFfinancialwayList:function(){var t=this,e={currentPage:1,pageSize:100,vo:{financialWay:"",financialWayTypeId:"",orgId:this.otherinfo.orgid,status:""}};Object(b.b)(e).then(function(e){t.financialWalList=[],e.list.forEach(function(e){"启用"===e.statusStr&&t.financialWalList.push(e)})}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},querySearch:function(e,t){var i=this.financialWalList;t(e?i.filter(this.createFilter(e)):i)},createFilter:function(t){return function(e){return 0===e.financialWay.toLowerCase().indexOf(t.toLowerCase())}},init:function(){this.loading=!1},getFeeInfo:function(){var t=this,e=this.otherinfo.orgid;return Object(l.a)(e,this.paymentsType).then(function(e){t.formModel=e.data,t.formModel.detailDtoList2=[],t.formModel.settlementTime=Object(u.parseTime)(new Date),t.formModel.settlementBy=t.otherinfo.name,t.initDetailDtoList(),t.formModel.szDtoList.forEach(function(e){e.agent=t.otherinfo.name}),t.formModel.szDtoList.length<1&&t.plusItem()}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},initDetailDtoList:function(){var o=this;this.formModel.amount=0,this.formModel.detailDtoList=Object(u.objectMerge2)([],this.info);var t={};for(var e in this.formModel.detailDtoList.map(function(e){t[e.dataName]?t[e.dataName].amount+=e.amount:t[e.dataName]=e}),t)this.formModel.detailDtoList2.push(t[e]);t={},this.formModel.detailDtoList2.forEach(function(e,t){o.formModel.amount+=e.amount;var i=Number(e.amount).toFixed(2).toString().split("").reverse(),n=i.indexOf(".");-1!==n&&i.splice(n,1),e.fen=i[0],e.jiao=i[1],e.yuan=i[2],e.ten=i[3],e.hundren=i[4],e.thousand=i[5],e.tenThousand=i[6],e.oneHundrenThousand=i[7],e.million=i[8],e.tenMillion=i[9]}),this.amountMessage=Object(f.smalltoBIG)(this.formModel.amount),this.amount=this.formModel.amount.toFixed(2).toString().split("").reverse();var i=this.amount.indexOf(".");-1!==i&&this.amount.splice(i,1)},sender:function(e,t){this.$set(this.formModel.szDtoList,t,o()(this.formModel.szDtoList[t],e))},getSystemTime:function(){var t=this;Object(c.k)().then(function(e){t.formModel.settlementTime=new Date(e.trim())}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},setData:function(){var e={},t=[],i=[];"中转费"===this.dataName?this.$set(e,"orgId",this.getRouteInfo.vo.transferOrgid):"异常理赔"===this.dataName?this.$set(e,"orgId",this.getRouteInfo.vo.orgid):this.$set(e,"orgId",this.getRouteInfo.vo.shipFromOrgid),this.$set(e,"settlementSn",this.formModel.settlementSn),this.$set(e,"settlementBy",this.formModel.settlementBy),this.$set(e,"settlementTime",this.formModel.settlementTime),this.$set(e,"remark",this.formModel.remark),this.$set(e,"detailDtoList",this.formModel.detailDtoList),this.$set(e,"szDtoList",this.formModel.szDtoList),t=o()([],this.formModel.szDtoList),i=o()([],this.info),this.$set(this.submitData,"capitalFlow",e),this.$set(this.submitData,"financialWayLogs",t),this.$set(this.submitData,"shipPayableFeeDtos",i),e={},t=[],i=[]},submitForm:function(e){var i=this;this.$refs[e].validate(function(e){if(e){i.setData(),console.log("submitData",i.submitData);var t="";t="中转费"===i.dataName?i.getRouteInfo.vo.transferOrgid:"异常理赔"===i.dataName?i.getRouteInfo.vo.orgid:i.getRouteInfo.vo.shipFromOrgid,Object(l.d)(t,i.submitData).then(function(e){i.$message({type:"success",message:"保存成功"}),i.closeMe();var t=i.currentPage.substring(0,1).toLowerCase()+i.currentPage.substring(1);i.$router.push({path:"./accountsPayable/waybill/"+t})}).catch(function(e){i._handlerCatchMsg(e)})}})},minusItem:function(e,t){var i=this.formModel.szDtoList.indexOf(e);-1!==i&&this.formModel.szDtoList.splice(i,1)},plusItem:function(){var e={agent:this.otherinfo.name,alipayAccount:"",bankAccount:"",bankAccountName:"",bankName:"",chequeNumber:"",financialWay:"",flowId:"",receivableNumber:"",rnum:"",wechatAccount:""};this.formModel.szDtoList.push(e)},getSum:function(e){var a=this,t=e.columns,s=e.data,r=[];return this.$nextTick(function(){}),t.forEach(function(t,e){if(0!==e)if(1!==e){for(var i=-2,n=12;2<n;n--)if(i++,e===n)return void(r[e]=a.amount[i]);var o=s.map(function(e){return Number(e[t.property])});o.every(function(e){return isNaN(e)})?r[e]="":(r[e]=o.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0),r[e]+="")}else r[e]=a.amountMessage;else r[e]="合计"}),r}}}},xzjP:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("A1ZN"),o=i("endO"),a=i("VU/8")(n.a,o.a,null,null,null);t.default=a.exports}});