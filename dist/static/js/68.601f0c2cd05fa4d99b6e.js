webpackJsonp([68,202,305],{"/n+A":function(t,e,s){"use strict";var n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"popRight-center",class:{showPopRight:t.isShow},style:{zIndex:t.zIndex}},[s("div",{staticClass:"popRight-header"},[t._t("title",[t._v(t._s(t.title))]),t._v(" "),s("i",{staticClass:"el-icon-close",attrs:{title:"关闭"},on:{click:t.close}})],2),t._v(" "),t.shouldRender?s("div",{staticClass:"popRight-content"},[t._t("content",[t._v("内容")])],2):t._e(),t._v(" "),s("div",{staticClass:"popRight-footer"},[t._t("footer",[t._v("底部")])],2)])},staticRenderFns:[]};e.a=n},"3EPC":function(t,e,s){"use strict";var n=s("qYK6"),i=s("/n+A");var a=function(t){s("f3wf")},o=s("VU/8")(n.a,i.a,a,null,null);e.a=o.exports},"5lb2":function(t,e,s){"use strict";e.d=function(t){return n.b.post("/api-plugin/system/traderecord/v1.1/",t).then(function(t){return t.data||[]})},e.f=function(t){return n.b.get("/api-plugin/pay/weixin/v1.1/weixin/wx?fee="+t.fee+"&companyId="+t.companyId)},e.a=function(t){return n.b.get("/api-plugin/common/Pay/v1.1/scanPay/ali?fee="+t.fee+"&companyId="+t.companyId)},e.b=function(t){return n.b.get("/api-plugin/common/Pay/v1.1/"+t)},e.e=function(t){return n.b.get("/api-plugin/pay/weixin/v1.1/"+t)},e.c=function(){return n.b.get("/api-plugin/common/Pay/v1.1/findMywallet").then(function(t){return t.data||0})};var n=s("Vo7i");s("TIfe")},"7e1K":function(t,e,s){"use strict";var n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tms_dialog",attrs:{title:e.popTitle,visible:e.isShow,"close-on-click-modal":!1,"before-close":e.closeMe,width:"500px"},on:{"update:visible":function(t){e.isShow=t}}},[s("el-table",{attrs:{data:e.info}},[s("el-table-column",{attrs:{prop:"id",label:"套餐级别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        套餐"+e._s(e.changeNumCN[t.row.id-1])+"\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"amount",label:"短信条数"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fee",label:"金额(元)"}}),e._v(" "),s("el-table-column",{attrs:{prop:"price",label:"单条价格(元/条)",width:"120"}})],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.postBuy}},[e._v("购 买")]),e._v(" "),s("el-button",{on:{click:e.closeMe}},[e._v("取 消")])],1)],1)},staticRenderFns:[]};e.a=n},Hrys:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("Knh+"),i=s("pOL8");var a=function(t){s("wasQ")},o=s("VU/8")(n.a,i.a,a,null,null);e.default=o.exports},Jdmp:function(t,e,s){"use strict";var n={render:function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],attrs:{width:"520px",title:s.popTitle,visible:s.popVisible,"before-close":s.closeMe,"custom-class":"rechargePop","close-on-click-modal":!1,"close-on-press-escape":!1,center:!0}},[n("div",{staticClass:"rechargePop-content"},[s.showcharge?n("div",{staticClass:"recharge-panel"},[n("div",{staticClass:"recharge-fee clearfix"},[n("div",{staticClass:"recharge-label"},[s._v("充值金额"),n("span",[s._v("（元）")])]),s._v(" "),n("div",{staticClass:"chargefee-list"},s._l(s.feelist,function(t,e){return n("span",{key:e,staticClass:"charefee-opt",class:{"select-opt":s.currentIndex===e},on:{click:function(t){s.currentIndex=e}}},[s._v(s._s(t)+" "),n("i",{staticClass:"el-icon-circle-check"})])})),s._v(" "),n("div",{staticClass:"otherrecharge-fee clearfix"},[n("span",{staticClass:"charefee-opt",class:{"select-opt":555===s.currentIndex},on:{click:function(t){s.currentIndex=555}}},[s._v("其它金额"),n("i",{staticClass:"el-icon-circle-check"})]),n("input",{directives:[{name:"numberOnly",rawName:"v-numberOnly:point",arg:"point"}],ref:"otherinp",staticClass:"nativeinput",attrs:{type:"text",maxlength:10,placeholder:"注:每次充值至少1块钱"},domProps:{value:s.otherfee},on:{focus:function(t){s.currentIndex=555},change:function(t){s.otherfee=t.target.value}}}),s._v(" "),s.payerror?n("span",{staticClass:"otherfee-error"},[s._v("至少充值金额1块钱")]):s._e()])]),s._v(" "),n("div",{staticClass:"recharge-payway"},[n("div",{staticClass:"payway-title"},[s._v("支付方式")]),s._v(" "),n("div",{staticClass:"payway-list clearfix"},[n("span",{staticClass:"hyq-wx",class:{active:"wx"===s.payway},on:{click:function(t){s.payway="wx"}}}),s._v(" "),n("span",{staticClass:"hyq-ali",class:{active:"ali"===s.payway},on:{click:function(t){s.payway="ali"}}})])]),s._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:s.submitForm}},[s._v("充值")])],1):n("div",{staticClass:"twocode-panel"},[n("div",{staticClass:"hyq-pay-twocode"},[n("div",{staticClass:"hyq-tc-title"},[s._v("使用"+s._s(s.paywayname)+"扫一扫付款")]),s._v(" "),n("div",{staticClass:"hyq-tc-box"},[s.tcurl?n("img",{staticClass:"hyq-tc-img",attrs:{src:s.tcurl}}):s._e()]),s._v(" "),s.paysuccess?n("div",{staticClass:"hyq-pay-success"},[s._v("充值成功")]):s._e(),s._v(" "),s.payfail?n("div",{staticClass:"hyq-pay-fail"},[s._v("充值失败"+s._s(s.errmsg))]):s._e()])])])])},staticRenderFns:[]};e.a=n},"Knh+":function(t,e,s){"use strict";var n=s("woOf"),i=s.n(n),a=s("pyzt"),o=s("q/t7"),r=s("l1TW");s("0xDb");e.a={name:"smsManageBuy",data:function(){return{isShowData:!0,dataList:[],changeNumCN:[],packageInfo:{},handleBuyItem:{},popVisibleTips:!1,popVisibleRecharge:!1,handleBuyArr:[]}},components:{buyTips:o.default,Recharge:a.default},mounted:function(){this.converToCn(),this.getSmspackages(),this.getSearchSmsSurplus()},methods:{recharge:function(){this.popVisibleRecharge=!0},converToCn:function(){var t=0,e=["十","一","二","三","四","五","六","七","八","九"];for(this.changeNumCN=[];t++<99;){var s=(t+"").split(""),n=s[1]?("1"===s[0]?"":e[s[0]])+"十"+("0"===s[1]?"":e[s[1]]):e[s[0]];10===t&&(n="十"),this.changeNumCN.push(n)}},getSearchSmsSurplus:function(){var e=this;Object(r.b)().then(function(t){t?(e.packageInfo=t,e.isShowData=!0):(e.$message.warning("未获取到数据，请稍后重试~"),e.isShowData=!1)}).catch(function(t){e._handlerCatchMsg(t)})},getSmspackages:function(){var s=this;return Object(r.d)().then(function(t){t&&(s.dataList=t,s.dataList.forEach(function(t){var e;e=(Number(t.fee)/Number(t.amount)).toFixed(2),s.$set(t,"price",e)}))}).catch(function(t){s._handlerCatchMsg(t)})},goBuy:function(t){var e=this;if(this.handleBuyItem=i()({},t),Number(t.fee)<=Number(this.packageInfo.balance))this.handleBuyArr[0]=this.handleBuyItem,this.popVisibleTips=!0;else{this.$createElement;this.$confirm("钱包余额不足，当前余额 "+this.packageInfo.balance+" 元，先充值再购买。","购买失败",{distinguishCancelAndClose:!0,confirmButtonText:"充值",cancelButtonText:"取消"}).then(function(){e.popVisibleRecharge=!0,e.popVisibleTips=!1}).catch(function(){e.popVisibleTips=!1})}},closeTips:function(){this.popVisibleTips=!1}}}},TvB1:function(t,e,s){"use strict";var n=s("l1TW");e.a={props:{popVisible:{type:Boolean,default:!1},info:{}},data:function(){return{popTitle:"短信购买",loading:!0,isShow:!1,changeNumCN:[]}},watch:{popVisible:function(t){(this.isShow=t)&&this.converToCn()}},methods:{converToCn:function(){var t=0,e=["十","一","二","三","四","五","六","七","八","九"];for(this.changeNumCN=[];t++<99;){var s=(t+"").split(""),n=s[1]?("1"===s[0]?"":e[s[0]])+"十"+("0"===s[1]?"":e[s[1]]):e[s[0]];10===t&&(n="十"),this.changeNumCN.push(n)}},postBuy:function(){var e=this;Object(n.e)(this.info[0].id).then(function(t){e.$message.success("已购买成功!"),e.$emit("success"),e.closeMe()}).catch(function(t){e._handlerCatchMsg(t)})},closeMe:function(t){this.$emit("close"),"function"==typeof t&&t()}}}},f3wf:function(t,e){},l1TW:function(t,e,s){"use strict";e.d=function(){return n.b.get("/api-plugin/system/tmssystemsmspackages/v1/all/").then(function(t){return t.data||{}})},e.b=function(t){return n.b.get("/api-plugin/system/tmssystemsmssummary/v1/searchSmsSurplus/",t).then(function(t){return t.data})},e.e=function(t){return n.b.post("/api-plugin/system/tmssystemsmssummary/v1/buy/",{packageId:t}).then(function(t){return t.data})},e.k=function(t){return n.b.post("/api-plugin/system/tmssystemsmstemplatelog/v1.1/getSmsTemplateLogList/",t).then(function(t){return t.data||{}})},e.a=function(t){return n.b.post("/api-plugin/system/tmssystemsmssign/v1.1/updateSmsSign/",t).then(function(t){return t.data||{}})},e.i=function(t){return n.b.post("/api-plugin/system/tmssystemsmssign/v1.1/getSmsSign/",{orgId:t}).then(function(t){return t})},e.m=function(t){return n.b.post("/api-plugin/system/tmssystemsmstemplatelog/v1.1/udpateSmsTemplateLogStatus/",t).then(function(t){return t.data})},e.g=function(t){return n.b.post("/api-plugin/system/tmssystemsmssendlog/v1.1/getSmsSendLogList/",t).then(function(t){return t.data})},e.h=function(t){return n.b.post("/api-plugin/system/tmssystemsmssetcolumns/v1.1/getSmsSetColumnsList/",t).then(function(t){return t.data})},e.f=function(t){return n.b.post("/api-plugin/system/tmssystemsmstemplate/v1.1/getDefaultSmsTemplate/",t).then(function(t){return t.data})},e.j=function(t){return n.b.post("/api-plugin/system/tmssystemsmstemplatelog/v1.1/getSmsTemplateLog/",t).then(function(t){return t.data})},e.l=function(t){return n.b.post("/api-plugin/system/tmssystemsmstemplatelog/v1.1/udpateSmsTemplateLog/",t).then(function(t){return t.data})},e.c=function(t){return n.b.post("/api-plugin/system/tmssystemsmssign/v1.1/getSmsDocText/",{orgId:t}).then(function(t){return t.data})};var n=s("Vo7i")},nlbk:function(t,e,s){"use strict";var n=s("3EPC"),i=s("5lb2"),a=s("t5DY"),o=s("71e1"),r=s.n(o);e.a={props:{popVisible:{type:Boolean,default:!1}},components:{PopFrame:n.a},data:function(){return{loading:!1,popTitle:"充值详情",otherfee:"",feelist:[],payerror:!1,errmsg:"",paysuccess:!1,payfail:!1,payway:"wx",tcurl:"",showcharge:!0,currentIndex:0,payfee:""}},mounted:function(){var e=this;this.loading=!0,Object(a.j)("pay_money",this.otherinfo.orgid).then(function(t){e.loading=!1,e.feelist=t.map(function(t){return t.dictName}).reverse()}).catch(function(t){e.loading=!1,e._handlerCatchMsg(t)})},destroyed:function(){clearTimeout(this.timer)},computed:{paywayname:function(){return{wx:"微信",ali:"支付宝"}[this.payway]||""}},watch:{popVisible:function(t){},currentIndex:function(t){555===t?this.$refs.otherinp.focus():(this.otherfee="",this.payerror=!1)},otherfee:function(t){if(555===this.currentIndex&&t){var e=parseFloat(t,10);this.payerror=e<1}},showcharge:function(t){t||(this.popTitle="支付¥"+this.payfee+"元")}},methods:{reset:function(){this.popTitle="充值详情",this.otherfee="",this.payerror=!1,this.errmsg="",this.paysuccess=!1,this.payfail=!1,this.payway="wx",this.tcurl="",this.showcharge=!0,this.currentIndex=0,this.payfee=""},closeMe:function(t){if(!this.showcharge&&!this.paysuccess)return this.showcharge=!0,this.payfail=!1,this.popTitle="充值详情",void clearTimeout(this.timer);this.paysuccess&&this.$emit("success"),this.$emit("close"),this.$emit("update:popVisible",!1),this.reset(),"function"==typeof t&&t()},submitForm:function(){var e=this;if(""===this.currentIndex)return this.$message.error("需要选择充值金额。"),!1;if(555===this.currentIndex&&(!this.otherfee||this.payerror))return this.$message.error("请填写有效的金额。"),!1;if(""===this.payway)return this.$message.error("请选择支付方式。"),!1;var t={};555!==this.currentIndex?t.fee=this.feelist[this.currentIndex]:t.fee=this.otherfee,t.type=this.payway,this.payfee=t.fee,t.companyId=this.otherinfo.companyId;var s=void 0;s="ali"===t.type?i.a(t):i.f(t),this.loading=!0,s.then(function(t){e.loading=!1,t.data&&(e.id=t.text,e.showcharge=!1,r.a.toDataURL(t.data,{rendererOpts:{margin:0}}).then(function(t){e.tcurl=t,e.startPay()}))}).catch(function(t){e.loading=!1,e._handlerCatchMsg(t)})},startPay:function(){var s=this;clearTimeout(this.timer),this.timer=setTimeout(function(){("wx"===s.payway?i.e(s.id):i.b(s.id)).then(function(t){var e=t.text;"等待充值"===e||"未支付"===e||"支付中"===e?s.startPay():"支付成功"===e||"充值成功"===e?(s.paysuccess=!0,setTimeout(function(){s.closeMe()},2e3)):(s.$emit("fail"),s.payfail=!0)}).catch(function(t){s.$emit("fail"),s.payfail=!0,s._handlerCatchMsg(t)})},3e3)}}}},pOL8:function(t,e,s){"use strict";var n={render:function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"sms"},[s.isShowData?n("div",[n("div",{staticClass:"sms_top"},[n("p",[s._v("尊敬的用户您好：当前剩余可发的短信"),n("b",[s._v(s._s(s.packageInfo.surplusAmount))]),s._v("条。当前账户余额"),n("b",[s._v(s._s(s.packageInfo.balance))]),s._v("元。\n        "),n("el-button",{directives:[{name:"has",rawName:"v-has:SMS_BUY_1",arg:"SMS_BUY_1"}],attrs:{size:"mini",type:"primary",icon:"el-icon-sort"},on:{click:s.recharge}},[s._v("充值")])],1)]),s._v(" "),n("div",{staticClass:"sms_content"},[n("el-row",{attrs:{gutter:10}},s._l(s.dataList,function(e,t){return n("el-col",{key:e.id,attrs:{span:4}},[n("el-card",{staticClass:"smsCard",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[s._v("套餐"+s._s(s.changeNumCN[t]))])]),s._v(" "),n("div",{staticClass:"smsCard_content"},[n("p",[s._v(s._s(e.amount)+"条短信")]),s._v(" "),n("h3",[s._v(s._s(e.fee)+"元")]),s._v(" "),n("h4",[s._v(s._s(e.price)+"元/条")]),s._v(" "),n("el-button",{directives:[{name:"has",rawName:"v-has:SMS_BUY_2",arg:"SMS_BUY_2"}],staticClass:"smsCard_footbtn",attrs:{type:"danger",round:"",icon:"el-icon-goods"},on:{click:function(t){s.goBuy(e)}}},[s._v("立即购买")])],1)])],1)}))],1)]):n("el-alert",{attrs:{title:"未获取到数据，请稍后重试~",type:"warning","show-icon":""}}),s._v(" "),n("buyTips",{attrs:{info:s.handleBuyArr,popVisible:s.popVisibleTips},on:{close:s.closeTips,success:s.getSearchSmsSurplus}}),s._v(" "),n("Recharge",{attrs:{popVisible:s.popVisibleRecharge},on:{"update:popVisible":function(t){s.popVisibleRecharge=t},success:s.getSearchSmsSurplus}})],1)},staticRenderFns:[]};e.a=n},pyzt:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("nlbk"),i=s("Jdmp");var a=function(t){s("xmG7")},o=s("VU/8")(n.a,i.a,a,null,null);e.default=o.exports},"q/t7":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("TvB1"),i=s("7e1K"),a=s("VU/8")(n.a,i.a,null,null,null);e.default=a.exports},qYK6:function(t,e,s){"use strict";e.a={props:{width:{type:String,default:"400"},title:{type:String,default:"标题"},isShow:{type:Boolean,default:!1}},watch:{isShow:{handler:function(){this.isShow&&(this.shouldRender=!0)},immediate:!0}},data:function(){return{zIndex:(window.tmsPopZindex?window.tmsPopZindex+=1:window.tmsPopZindex=1e3,window.tmsPopZindex),shouldRender:!1}},methods:{close:function(){this.$emit("close")}}}},wasQ:function(t,e){},xmG7:function(t,e){}});