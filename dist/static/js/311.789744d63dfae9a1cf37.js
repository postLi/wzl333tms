webpackJsonp([311],{"//Ie":function(e,o,t){"use strict";var i=t("woOf"),s=t.n(i),r=t("Dd8w"),n=t.n(r),a=t("E4LH"),l=t("Vi15"),m=t("P5Di"),c=t("QbVN"),f=t("o9X6"),p=t("NYxO");o.a={components:{popRight:m.a,Upload:c.a,SelectTree:f.a},props:{popVisible:{type:Boolean,default:!1},orgid:{required:!0},isModify:{type:Boolean,default:!1},info:{type:Object,default:function(){}},issender:{type:Boolean,dafault:!1}},computed:n()({},Object(p.mapGetters)(["otherinfo"]),{fixPhone:{get:function(){return this.phoneshort+"-"+this.phonelong},set:function(e){var o=e?e.split("-"):"";o?(this.phoneshort=o[1]?o[0]:"",this.phonelong=o[1]?o[1]:o[0]):(this.phoneshort="",this.phonelong="")}},customphoneisok:function(){}}),data:function(){return{phoneshort:"",phonelong:"",form:{bankCardNumber:"",bankName:"",companyName:"",companyType:2,customerMobile:"",customerName:"",customerType:this.issender?1:2,customerUnit:"",detailedAddress:"",fixPhone:"",idcardPositive:"",idcardVerso:"",idcard:"",legalPersonname:"",licensePicture:"",openBank:"",orgid:0,vipNum:""},formLabelWidth:"90px",tooltip:!1,rules:{companyName:[],orgid:[{required:!0,message:"请选择所属机构"}],customerMobile:[{required:!0,message:"请输入手机号码",trigger:"change"}],customerName:[{required:!0,message:"请输入联系人"},{max:30,message:"不能超过30个字符"}],vipNum:[{pattern:a.a.ONLY_NUMBER_AND_LETTER,trigger:"blur",message:"客户的VIP号只能输入字母和阿拉伯数字"}],idcard:[{pattern:a.a.ONLY_NUMBER_AND_LETTER,trigger:"blur",message:"身份证号码只能输入字母和数字"}]},popTitle:"新增发货人",orgArr:[],rolesArr:[],departmentArr:[],loading:!1,roles:[],departments:[],groups:[],inited:!1,isSaveAndAdd:!0}},mounted:function(){this.form.orgid=this.orgid,this.inited||(this.inited=!0,this.initInfo()),console.log(this.issender),console.log(this.popTitle)},watch:{"form.customerMobile":function(e){this.isSaveAndAdd&&(console.log("33333"),this.$refs.ruleForm.validateField("customerMobile"))},popVisible:function(e,o){this.inited||(this.inited=!0,this.initInfo()),e&&this.setTitle(),console.log(this.popTitle)},orgid:function(e){this.form.orgid=e},info:function(){if(this.isModify){this.popTitle="修改"+(this.issender?"发":"收")+"货人";var e=s()({},this.info);for(var o in this.form)this.form[o]=e[o];this.form.customerId=e.customerId,console.log("this.fixphone",this.fixPhone,this.form.fixPhone,e),this.fixPhone=this.form.fixPhone}else{for(var t in console.log(this.issender),this.popTitle="新增"+(this.issender?"发":"收")+"货人",this.form)this.form[t]="";delete this.form.customerId,this.form.companyType=2,this.form.customerType=this.issender?1:2,this.form.orgid=this.orgid,this.fixPhone=""}}},methods:{setTitle:function(){if(this.isModify){this.popTitle="修改"+(this.issender?"发":"收")+"货人";var e=s()({},this.info);for(var o in this.form)this.form[o]=e[o];this.form.customerId=e.customerId,console.log("this.fixphone",this.fixPhone,this.form.fixPhone,e),this.fixPhone=this.form.fixPhone}else{for(var t in console.log(this.issender),this.popTitle="新增"+(this.issender?"发":"收")+"货人",this.form)this.form[t]="";delete this.form.customerId,this.form.companyType=2,this.form.customerType=this.issender?1:2,this.form.orgid=this.orgid,this.fixPhone=""}},initInfo:function(){this.loading=!1},getOrgid:function(e){this.form.orgid=e},submitForm:function(e,t){var i=this;this.$refs[e].validate(function(e){if(!e)return!1;i.loading=!0;var o=s()({},i.form);o.fixPhone=i.fixPhone;(i.isModify?Object(l.e)(o):Object(l.d)(o)).then(function(e){i.loading=!1,i.$message.success("保存成功"),t||i.closeMe(),i.$emit("success"),i.reset()}).catch(function(e){i._handlerCatchMsg(e),i.loading=!1})})},reset:function(){var e=this;this.isSaveAndAdd=!1;var o=this.form.orgid;this.$refs.ruleForm.resetFields(),this.form.licensePicture="",this.form.idcardPositive="",this.form.idcardVerso="",this.fixPhone="",this.form.fixPhone="",this.form.customerMobile="",this.form.orgid=o,console.log(this.form,"///////////////"),this.$nextTick(function(){e.isSaveAndAdd=!0})},closeMe:function(e){this.reset(),this.$emit("update:popVisible",!1),"function"==typeof e&&e()}}}},XRGj:function(e,o,t){"use strict";var i={render:function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("pop-right",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],staticClass:"addCustomerPop",attrs:{title:o.popTitle,isShow:o.popVisible},on:{close:o.closeMe}},[t("template",{staticClass:"addCustomerPop-content",slot:"content"},[t("el-form",{ref:"ruleForm",attrs:{model:o.form,rules:o.rules,"label-width":o.formLabelWidth,inline:!0,"label-position":"right",size:"mini"}},[o.isModify?o._e():t("el-form-item",{staticClass:"clearfix"},[t("div",{staticClass:"selectType",class:{checked:2===o.form.companyType},on:{click:function(e){e.stopPropagation(),o.form.companyType=2}}},[t("span",{staticClass:"icon"},[t("icon-svg",{attrs:{"icon-class":"qiye"}})],1),o._v(" "),t("strong",[o._v("企业")]),o._v(" "),t("p",[o._v("有合法营业执照等企业")])]),o._v(" "),t("div",{staticClass:"selectType single",class:{checked:1===o.form.companyType},on:{click:function(e){e.stopPropagation(),o.form.companyType=1}}},[t("span",{staticClass:"icon"},[t("icon-svg",{attrs:{"icon-class":"geren"}})],1),o._v(" "),t("strong",[o._v("个人")]),o._v(" "),t("p",[o._v("具备有效身份的自然人")])])]),o._v(" "),2===o.form.companyType?[t("div",{staticClass:"info"},[o._v("公司名称")]),o._v(" "),t("el-form-item",{attrs:{prop:"companyName"}},[t("el-input",{attrs:{maxlength:25,placeholder:"公司全称"},model:{value:o.form.companyName,callback:function(e){o.$set(o.form,"companyName","string"==typeof e?e.trim():e)},expression:"form.companyName"}})],1),o._v(" "),t("el-form-item",[t("upload",{staticClass:"licensePicture",attrs:{twocode:"",tip:"（有年检章，jpg/png。小于5M）"},model:{value:o.form.licensePicture,callback:function(e){o.$set(o.form,"licensePicture",e)},expression:"form.licensePicture"}})],1),o._v(" "),t("div",{staticClass:"info"},[o._v("公司法人信息")]),o._v(" "),t("el-form-item",{attrs:{prop:"legalPersonname"}},[t("el-input",{attrs:{maxlength:25,placeholder:"公司法人名称","auto-complete":"off"},model:{value:o.form.legalPersonname,callback:function(e){o.$set(o.form,"legalPersonname","string"==typeof e?e.trim():e)},expression:"form.legalPersonname"}})],1)]:o._e(),o._v(" "),t("el-form-item",{staticClass:"clearfix"},[t("div",{staticClass:"idcard-pos"},[t("upload",{attrs:{twocode:"",title:1===o.form.companyType?"自然人身份证正面":"法人身份证正面"},model:{value:o.form.idcardPositive,callback:function(e){o.$set(o.form,"idcardPositive",e)},expression:"form.idcardPositive"}})],1),o._v(" "),t("div",{staticClass:"idcard-ver"},[t("upload",{attrs:{twocode:"",title:1===o.form.companyType?"自然人身份证反面":"法人身份证反面"},model:{value:o.form.idcardVerso,callback:function(e){o.$set(o.form,"idcardVerso",e)},expression:"form.idcardVerso"}})],1)]),o._v(" "),t("div",{staticClass:"info"},[o._v(o._s(o.issender?"发":"收")+"货信息")]),o._v(" "),t("el-form-item",{attrs:{label:(o.issender?"发":"收")+"货方",prop:"customerUnit"}},[t("el-input",{attrs:{maxlength:25,"auto-complete":"off"},model:{value:o.form.customerUnit,callback:function(e){o.$set(o.form,"customerUnit",e)},expression:"form.customerUnit"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"联系人",prop:"customerName"}},[t("el-input",{attrs:{maxlength:25,"auto-complete":"off"},model:{value:o.form.customerName,callback:function(e){o.$set(o.form,"customerName",e)},expression:"form.customerName"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[t("input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"},{name:"model",rawName:"v-model.trim",value:o.form.customerMobile,expression:"form.customerMobile",modifiers:{trim:!0}}],staticClass:"nativeinput",attrs:{type:"text","auto-complete":"off",maxlength:"20"},domProps:{value:o.form.customerMobile},on:{input:function(e){e.target.composing||o.$set(o.form,"customerMobile",e.target.value.trim())},blur:function(e){o.$forceUpdate()}}})]),o._v(" "),t("el-form-item",{staticClass:"customerPhone",attrs:{label:"电话",prop:"customerPhone"}},[t("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],staticClass:"phoneshort",attrs:{maxlength:4,"auto-complete":"off"},model:{value:o.phoneshort,callback:function(e){o.phoneshort=e},expression:"phoneshort"}}),o._v(" - "),t("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],staticClass:"phonelong",attrs:{maxlength:8,"auto-complete":"off"},model:{value:o.phonelong,callback:function(e){o.phonelong=e},expression:"phonelong"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"归属网点",prop:"orgid"}},[t("SelectTree",{attrs:{filterable:"",orgid:o.otherinfo.orgid},model:{value:o.form.orgid,callback:function(e){o.$set(o.form,"orgid",e)},expression:"form.orgid"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"客户VIP号",prop:"vipNum"}},[t("el-input",{attrs:{maxlength:25,"auto-complete":"off"},model:{value:o.form.vipNum,callback:function(e){o.$set(o.form,"vipNum",e)},expression:"form.vipNum"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"身份证号码",prop:"idcard"}},[t("el-input",{attrs:{maxlength:18,"auto-complete":"off"},model:{value:o.form.idcard,callback:function(e){o.$set(o.form,"idcard",e)},expression:"form.idcard"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"开户行",prop:"openBank"}},[t("el-input",{attrs:{maxlength:20,"auto-complete":"off"},model:{value:o.form.openBank,callback:function(e){o.$set(o.form,"openBank",e)},expression:"form.openBank"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"银行名称",prop:"bankName"}},[t("el-input",{attrs:{maxlength:20,"auto-complete":"off"},model:{value:o.form.bankName,callback:function(e){o.$set(o.form,"bankName",e)},expression:"form.bankName"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"银行卡号",prop:"bankCardNumber"}},[t("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{maxlength:25,"auto-complete":"off"},model:{value:o.form.bankCardNumber,callback:function(e){o.$set(o.form,"bankCardNumber","string"==typeof e?e.trim():e)},expression:"form.bankCardNumber"}})],1),o._v(" "),t("el-form-item",{attrs:{label:"详细地址",prop:"detailedAddress"}},[t("el-input",{attrs:{type:"textarea",placeholder:"最多输入50个字符",maxlength:50,"auto-complete":"off"},model:{value:o.form.detailedAddress,callback:function(e){o.$set(o.form,"detailedAddress",e)},expression:"form.detailedAddress"}})],1)],2)],1),o._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o.isModify?o._e():t("el-button",{attrs:{type:"primary"},on:{click:function(e){o.submitForm("ruleForm",!0)}}},[o._v("保存并新增")]),o._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){o.submitForm("ruleForm")}}},[o._v("保 存")]),o._v(" "),t("el-button",{on:{click:o.closeMe}},[o._v("取 消")])],1)],2)},staticRenderFns:[]};o.a=i},ftoq:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=t("//Ie"),s=t("XRGj");var r=function(e){t("nveU")},n=t("VU/8")(i.a,s.a,r,null,null);o.default=n.exports},nveU:function(e,o){}});