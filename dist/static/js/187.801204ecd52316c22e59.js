webpackJsonp([187],{"1Gov":function(e,t){},"4g2A":function(e,t){},"71e1":function(e,t,i){e.exports=i("+dzQ")(43)},A2Dm:function(e,t,i){"use strict";var r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("pop-right",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"addPickUpPop",attrs:{title:t.popTitle,isShow:t.popVisible},on:{close:t.closeMe}},[i("template",{staticClass:"addPickUpPop-content",slot:"content"},[i("el-form",{key:t.valkey,ref:"ruleForm",staticClass:"pickup_lrl",attrs:{model:t.form,rules:t.rules,"label-width":"90px","show-message":t.checkShowMessage,inline:!0,"label-position":"right",size:"mini"}},[i("div",{staticClass:"info_date",staticStyle:{"margin-top":"10px"}},[t._v("提货信息")]),t._v(" "),i("div",{staticClass:"pickUp-top"},[i("el-form-item",{attrs:{label:"提货批次",prop:"customerUnit"}},[i("el-input",{attrs:{"auto-complete":"off",disabled:""},model:{value:t.pickupBatchNumber,callback:function(e){t.pickupBatchNumber=e},expression:"pickupBatchNumber"}})],1),t._v(" "),i("el-form-item",{staticClass:"senderName_lrl",attrs:{label:"发货人",prop:""}},[i("querySelect",{attrs:{search:"customerName",type:"sender",valuekey:"customerName",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.customerName,callback:function(e){t.$set(t.form.tmsCustomer,"customerName",e)},expression:"form.tmsCustomer.customerName"}})],1),t._v(" "),i("el-form-item",{staticClass:"senderName_lrl",attrs:{label:"手机号",prop:"tmsCustomer.customerMobile"}},[i("querySelect",{attrs:{search:"customerMobile",type:"sender",valuekey:"customerMobile",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.customerMobile,callback:function(e){t.$set(t.form.tmsCustomer,"customerMobile",e)},expression:"form.tmsCustomer.customerMobile"}})],1),t._v(" "),i("el-form-item",{staticClass:"senderAddr_lrl",attrs:{label:"提货地址",prop:"tmsCustomer.detailedAddress"}},[i("querySelect",{attrs:{search:"detailedAddress",type:"sender",valuekey:"detailedAddress",disabled:t.isDbclick},on:{change:t.setSender},model:{value:t.form.tmsCustomer.detailedAddress,callback:function(e){t.$set(t.form.tmsCustomer,"detailedAddress",e)},expression:"form.tmsCustomer.detailedAddress"}})],1)],1),t._v(" "),i("div",{staticClass:"info_date"},[t._v("货物信息")]),t._v(" "),i("div",{staticClass:"pickUp-order"},[i("el-form-item",{attrs:{label:"货品名",prop:"tmsOrderPickup.pickupName"}},[i("querySelect",{attrs:{search:"value",valuekey:"value",maxlength:8,type:"cargoName",remote:!0,disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.pickupName,callback:function(e){t.$set(t.form.tmsOrderPickup,"pickupName",e)},expression:"form.tmsOrderPickup.pickupName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"件数",prop:"tmsOrderPickup.pickupAmount"}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupAmount},on:{change:function(e){t.setInputVal(e.target.value,"pickupAmount")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"体积",prop:""}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupVolume},on:{change:function(e){t.setInputVal(e.target.value,"pickupVolume")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"重量",prop:"tmsOrderPickup.pickupWeight"}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.pickupWeight},on:{change:function(e){t.setInputVal(e.target.value,"pickupWeight")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"运费",prop:"tmsOrderPickup.carriage"}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.carriage},on:{change:function(e){t.setInputVal(e.target.value,"carriage")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"付款方式"}},[i("SelectType",{staticClass:"pickup-way",attrs:{type:"ship_pay_way",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.payMethod,callback:function(e){t.$set(t.form.tmsOrderPickup,"payMethod",e)},expression:"form.tmsOrderPickup.payMethod"}})],1),t._v(" "),i("el-form-item",{staticClass:"order_toCityCode",attrs:{required:"",prop:"tmsOrderPickup.toCityName",label:"到站"}},[i("queryCity",{attrs:{search:"longAddr",type:"city",remote:!0,disabled:t.isDbclick},on:{change:t.selectToCity},model:{value:t.form.tmsOrderPickup.toCityName,callback:function(e){t.$set(t.form.tmsOrderPickup,"toCityName",e)},expression:"form.tmsOrderPickup.toCityName"}})],1),t._v(" "),i("el-form-item",{staticClass:"order_remark",attrs:{label:"备注",prop:"tmsOrderPickup.remark"}},[i("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:t.isDbclick,maxlength:300},model:{value:t.form.tmsOrderPickup.remark,callback:function(e){t.$set(t.form.tmsOrderPickup,"remark",e)},expression:"form.tmsOrderPickup.remark"}})],1)],1),t._v(" "),i("div",{staticClass:"info_date"},[t._v("其他信息")]),t._v(" "),i("div",{staticClass:"pickUp-bottom"},[i("el-form-item",{attrs:{label:"车费",prop:"tmsOrderPickup.truckFee"}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.truckFee},on:{change:function(e){t.setInputVal(e.target.value,"truckFee")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"代收费用",prop:""}},[i("input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],staticClass:"nativeinput",attrs:{maxlength:8,"auto-complete":"off",clearable:"",disabled:t.isDbclick,type:"text"},domProps:{value:t.form.tmsOrderPickup.collectionFee},on:{change:function(e){t.setInputVal(e.target.value,"collectionFee")}}})]),t._v(" "),i("el-form-item",{attrs:{label:"车牌号",prop:"tmsTruck.truckIdNumber"}},[i("querySelect",{attrs:{search:"truckIdNumber",valuekey:"truckIdNumber",type:"trunk",disabled:t.isDbclick,maxlength:8},on:{change:t.getTrunkName},model:{value:t.form.tmsTruck.truckIdNumber,callback:function(e){t.$set(t.form.tmsTruck,"truckIdNumber",e)},expression:"form.tmsTruck.truckIdNumber"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"司机姓名",prop:"tmsDriver.driverName"}},[i("querySelect",{attrs:{search:"driverName",valuekey:"driverName",type:"driver",remote:!0,disabled:t.isDbclick,maxlength:8},on:{change:t.getdriverName},model:{value:t.form.tmsDriver.driverName,callback:function(e){t.$set(t.form.tmsDriver,"driverName",e)},expression:"form.tmsDriver.driverName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"车辆类型"}},[i("SelectType",{staticClass:"pickup-way",attrs:{type:"truck_type",placeholder:"请选择",disabled:t.isDbclick},model:{value:t.form.tmsTruck.truckType,callback:function(e){t.$set(t.form.tmsTruck,"truckType",e)},expression:"form.tmsTruck.truckType"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"司机手机",prop:"tmsDriver.driverMobile"}},[i("el-input",{attrs:{"auto-complete":"off",disabled:t.isDbclick},model:{value:t.form.tmsDriver.driverMobile,callback:function(e){t.$set(t.form.tmsDriver,"driverMobile",e)},expression:"form.tmsDriver.driverMobile"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"车辆单位",prop:"tmsTruck.truckUnit"}},[i("el-input",{attrs:{"auto-complete":"off",disabled:t.isDbclick,maxlength:18},model:{value:t.form.tmsTruck.truckUnit,callback:function(e){t.$set(t.form.tmsTruck,"truckUnit",e)},expression:"form.tmsTruck.truckUnit"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"提货状态",prop:"tmsOrderPickup.pickupStatus"}},[i("SelectType",{staticClass:"pickup-way",attrs:{filterfn:t.filterfn,type:"pickup_status",placeholder:"请选择",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.pickupStatus,callback:function(e){t.$set(t.form.tmsOrderPickup,"pickupStatus",e)},expression:"form.tmsOrderPickup.pickupStatus"}})],1),t._v(" "),i("el-form-item",{staticClass:"customerunit",attrs:{label:"出车时间"}},[i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"timestamp","picker-options":t.pickOption,disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.outTime,callback:function(e){t.$set(t.form.tmsOrderPickup,"outTime",e)},expression:"form.tmsOrderPickup.outTime"}})],1),t._v(" "),i("el-form-item",{staticClass:"arrive-time",attrs:{label:"到达时间",prop:"tmsOrderPickup.arriveTime"}},[i("el-date-picker",{attrs:{align:"right",type:"date","picker-options":t.pickOption2,placeholder:"选择日期","value-format":"timestamp",disabled:t.isDbclick},model:{value:t.form.tmsOrderPickup.arriveTime,callback:function(e){t.$set(t.form.tmsOrderPickup,"arriveTime",e)},expression:"form.tmsOrderPickup.arriveTime"}})],1),t._v(" "),i("el-form-item",{staticClass:"checked"},[i("el-checkbox",{attrs:{disabled:""},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("发送短信给司机")])],1)],1)])],1),t._v(" "),t.isDbclick?i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeMe}},[t._v("关 闭")])],1):i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保 存")]),t._v(" "),i("el-button",{on:{click:t.closeMe}},[t._v("取 消")])],1)],2)},staticRenderFns:[]};t.a=r},EPeO:function(e,t,i){"use strict";var r=i("//Fk"),a=i.n(r),s=i("mvHQ"),o=i.n(s),c=(i("UDRQ"),i("t5DY")),l=i("0xDb"),m=i("71e1"),u=i.n(m),n=i("Vo7i");t.a={name:"singleImageUpload",props:{value:[String,Array],title:{type:String,default:""},tip:{type:String,default:"（jpg/png。小于5M）"},size:{type:String,default:"mini"},showFileList:{type:Boolean,default:!1},limit:{type:Number,default:1},listtype:{type:String,default:"picture",enum:["text","picture","picture-card"]},disabled:{type:Boolean,default:!1},twocode:{type:Boolean,default:!1}},computed:{imageUrl:function(){return this.value}},data:function(){return{tempUrl:"",dataObj:{token:"",key:""},upload:{key:"",policy:"",OSSAccessKeyId:"",success_action_status:"201",signature:""},uploadUrl:"",dir:"",filelist:[],showtc:!1,showtwocdetip:!0,twocodeurl:""}},watch:{showtc:function(){this.showtc?this.changeTwocode():clearInterval(this.uptimer)},value:{handler:function(e){if(this.showFileList){var t=Array.isArray(e)?e:e?e.split(","):[];t=t.filter(function(e){return e}),this.filelist=[],this.filelist=t.map(function(e){var t={};return t.url=e,t})}else this.filelist=e?[{url:e}]:[]},immediate:!0}},mounted:function(){},updated:function(){console.log("single image updated~~~")},beforeDestroy:function(){console.log("beforeDestroy"),clearInterval(this.uptimer)},methods:{init:function(){var t=this;return Object(c.m)().then(function(e){t.upload.OSSAccessKeyId=e.accessid,t.upload.policy=e.policy,t.upload.signature=e.signature,t.uploadUrl=e.host,t.dir=e.dir}).catch(function(){})},rmImage:function(t){this.filelist=this.filelist.filter(function(e){return e.url!==t}),this.emitInput(""),this.showtc=!1},onexceed:function(e,t){this.$message.error("最多上传 "+this.limit+" 张!")},handleRemove:function(e,t){console.log("handleRemove:",e,t),this.filelist=t,this.emitInput()},random_string:function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=t.length,r="",s=0;s<e;s++)r+=t.charAt(Math.floor(Math.random()*i));return r},emitInput:function(e){e&&this.filelist.push({url:e}),this.$emit("input",this.showFileList?this.filelist.map(function(e){return e.url}).join(","):e)},handleImageScucess:function(e){var t="";-1!==e.indexOf("Location")&&(t=(t=e.match(/<Location>([^<]+)<\/Location>/m))?t[1]:""),this.emitInput(t)},handleError:function(e){this.$message.error("上传错误："+o()(e)),this.$emit("error",e)},handleUpload:function(e){var o=this;return new a.a(function(r,s){lrz(e.file,{width:1024}).then(function(e){var t=new FormData,i=o.uploadUrl;t.append("key",o.upload.key),t.append("success_action_status","201"),t.append("OSSAccessKeyId",o.upload.OSSAccessKeyId),t.append("policy",o.upload.policy),t.append("signature",o.upload.signature),t.append("file",e.file),n.b.post(i,t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){r(e)}).catch(function(e){s(e),o._handlerCatchMsg(e,"上传失败:")})}).catch(function(e){s(e),o._handlerCatchMsg(e,"上传失败：")})})},beforeUpload:function(e){var i=this,r=/image\/\w+/.test(e.type)&&/(jpe?g|png)/i.test(e.type),s=e.size/1024/1024<5,o=e.name.match(/([^\.]+)$/);return o=o?"."+o[1]:"",new a.a(function(t,e){r?s?i.init().then(function(e){i.upload.key=i.dir+Object(l.parseTime)(new Date,"{y}{m}{d}")+"/"+i.random_string()+o,t(!0)}).catch(function(e){i._handlerCatchMsg(e),t(!1)}):(i.$message.error("上传头像图片大小不能超过 5MB!"),e(!1)):(i.$message.error("上传头像图片只能是 JPG/PNG 格式!"),e(!1))})},changeTwocode:function(){var i=this;clearInterval(this.uptimer),Object(c.k)().then(function(e){i.upid=e.data,i.startFetchData();var t="http://"+location.host+"/static/upload.html?len=1&access_token="+i.access_token+"&id="+e.data+"&url="+(window.tms_testapiurl||"");console.log("url:",t),u.a.toDataURL(t,{rendererOpts:{margin:0}}).then(function(e){i.twocodeurl=e})}).catch(function(e){i.$message.error("生成二维码出错了~")})},startFetchData:function(){var i=this;clearInterval(this.uptimer);var e=0;this.uptimer=setInterval(function(){if(57e4<(e+=5e3))return i.$message.info("二维码过期了，已重新生成~"),i.changeTwocode(),!1;Object(c.l)(i.upid).then(function(e){var t=e.data;t&&t.id===i.upid&&t.url&&(clearInterval(i.uptimer),i.showtc=!1,i.emitInput(decodeURIComponent(t.url)))}).catch(function(e){i.$message.info("二维码过期了，请重新扫描上传~")})},5e3)}}}},GZnJ:function(e,t,i){"use strict";var r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container",class:{uploadlist:t.showFileList}},[i("el-upload",{staticClass:"image-uploader",attrs:{data:t.upload,action:t.uploadUrl,multiple:!1,drag:!t.showFileList,"show-file-list":t.showFileList,"file-list":t.filelist,limit:t.limit,"before-upload":t.beforeUpload,"list-type":t.listtype,"on-exceed":t.onexceed,disabled:t.disabled,"on-remove":t.handleRemove,"on-error":t.handleError,"http-request":t.handleUpload,"on-success":t.handleImageScucess}},[t._t("content",[t.showtc?i("div",{staticClass:"twocodebox",on:{click:function(e){e.stopPropagation(),e.preventDefault()},mouseover:function(e){t.showtwocdetip=!0},mouseout:function(e){t.showtwocdetip=!1}}},[i("div",[i("img",{attrs:{src:t.twocodeurl,alt:""}})]),t._v(" "),i("el-button",{attrs:{size:t.size,type:"primary"},on:{click:function(e){t.showtc=!1}}},[t._v("本地上传")]),t._v(" "),i("el-button",{attrs:{size:t.size,type:"primary"},on:{click:t.changeTwocode}},[t._v("更换二维码")])],1):i("div",[t.title&&!t.showFileList?i("div",{staticClass:"upload__title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),i("el-button",{attrs:{size:t.size,type:"primary"}},[t._v("点击上传")]),t._v(" "),t.twocode?i("el-button",{staticClass:"uploadtwocode",attrs:{size:t.size,type:"primary"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.showtc=!0}}},[t._v("二维码上传")]):t._e(),t._v(" "),t.showFileList?t._e():i("div",{staticClass:"el-upload__text"},[t._v("将文件拖拽到此区域")]),t._v(" "),t.tip?i("div",{staticClass:"upload__tip"},[t._v(t._s(t.tip))]):t._e()],1)])],2),t._v(" "),t.imageUrl&&!t.showFileList?i("div",{staticClass:"image-preview"},[i("div",{staticClass:"image-preview-wrapper"},[i("img",{attrs:{src:t.imageUrl}}),t._v(" "),i("div",{staticClass:"image-preview-action"},[i("i",{staticClass:"el-icon-delete",on:{click:function(e){t.rmImage(t.imageUrl)}}})])])]):t._e()],1)},staticRenderFns:[]};t.a=r},QbVN:function(e,t,i){"use strict";var r=i("EPeO"),s=i("GZnJ");var o=function(e){i("4g2A"),i("V9ir")},a=i("VU/8")(r.a,s.a,o,"data-v-6d858db4",null);t.a=a.exports},V9ir:function(e,t){},nwVq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("pcyF"),s=i("A2Dm");var o=function(e){i("1Gov")},a=i("VU/8")(r.a,s.a,o,null,null);t.default=a.exports},pcyF:function(e,t,i){"use strict";var r=i("woOf"),s=i.n(r),o=i("Dd8w"),a=i.n(o),c=i("E4LH"),l=i("OYTF"),m=i("P5Di"),u=i("QbVN"),n=i("9UCZ"),d=i("66wn"),p=i("pAQG"),f=i("hq98"),h=i("NYxO"),k=i("0xDb");t.a={components:{popRight:m.a,Upload:u.a,querySelect:p.a,SelectType:n.a,queryCity:f.a,SelectCity:d.a},props:{popVisible:{type:Boolean,default:!1},orgid:{required:!0},isModify:{type:Boolean,default:!1},isDbclick:{type:Boolean,default:!1},info:{type:Object,default:function(){}},issender:{type:Boolean,dafault:!1}},computed:a()({},Object(h.mapGetters)(["otherinfo"])),data:function(){var r=this,t=this,e=function(e,t,i){c.a.Number_point.test(t)||!t?i():i(new Error("只能输入数字"))};return{rules:{"tmsOrderPickup.pickupName":[{required:!0,validator:this.validateIsEmpty("货品名不能为空")}],"tmsOrderPickup.pickupAmount":[{validator:function(e,t,i){c.a.ONLY_NUMBER.test(t)||!t?i():i(new Error("只能输入数字"))},trigger:"blur"},{required:!0,validator:this.validateIsEmpty("件数不能为空")}],"tmsOrderPickup.toCityName":[{required:!0,validator:this.validateIsEmpty("到站不能为空")}],"tmsOrderPickup.pickupVolume":[{validator:e,trigger:"blur"}],"tmsOrderPickup.pickupWeight":[{validator:e,trigger:"blur"}],"tmsOrderPickup.carriage":[{validator:e,mtrigger:"blur"}],"tmsOrderPickup.remark":[{max:300,message:"备注最多可输入300个字符",trigger:"blur"}],"tmsOrderPickup.truckFee":[{validator:e,trigger:"blur"}],"tmsOrderPickup.collectionFee":[{validator:e,trigger:"blur"}],"tmsTruck.truckIdNumber":[{required:!0,validator:this.validateIsEmpty("车牌号不能为空")}],"tmsDriver.driverName":[{required:!0,validator:this.validateIsEmpty("司机姓名不能为空")}],"tmsDriver.driverMobile":[{validator:function(e,t,i){c.a.MOBILE.test(t)||!t?i():r.isDbclick?i():i(new Error("请输入正确的手机号码~"))},trigger:"change"}],"tmsTruck.truckUnit":[{max:18,message:"车辆单位最多可输入18个字符",trigger:"blur"}],"tmsOrderPickup.arriveTime":[{required:!0,validator:this.validateIsEmpty("要求到达时间不能为空")}],"tmsCustomer.customerMobile":[{required:!0,validator:this.validateIsEmpty("发货人手机号不能为空")}],"tmsCustomer.detailedAddress":[{required:!0,validator:this.validateIsEmpty("提货地址不能为空")}]},pickOption:{firstDayOfWeek:1,disabledDate:function(e){return!!t.form.tmsOrderPickup.arriveTime&&e.getTime()>t.form.tmsOrderPickup.arriveTime}},pickOption2:{firstDayOfWeek:1,disabledDate:function(e){return!!t.form.tmsOrderPickup.outTime&&e.getTime()<t.form.tmsOrderPickup.outTime}},form:{tmsCustomer:{customerName:"",customerMobile:"",detailedAddress:"",customerId:""},tmsDriver:{driverName:"",driverMobile:"",driverId:""},tmsTruck:{truckIdNumber:"",truckType:"",truckUnit:"",truckId:""},tmsOrderPickup:{pickupBatchNumber:"",pickupName:"",pickupAmount:"",pickupVolume:"",pickupWeight:"",carriage:"",payMethod:76,toCityCode:"",toCityName:"",remark:"",truckFee:"",pickupStatus:236,collectionFee:"",outTime:"",arriveTime:""}},valkey:"",checked:!0,checkShowMessage:!1,formLabelWidth:"80px",popTitle:"提货派车单",loading:!1,inited:!1,pickupBatchNumber:"",sender:{},isChecked:!1,isCheckedShow:!1}},mounted:function(){this.inited||(this.inited=!0,this.initInfo())},watch:{popVisible:function(e,t){this.inited||(this.inited=!0,this.initInfo())},info:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())},isModify:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())},isDbclick:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.checkShowMessage=!1,this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.reset(),this.fetchGetPickUp())}},methods:{setInputVal:function(e,t){this.$set(this.form.tmsOrderPickup,t,e)},watchInfo:function(){this.isModify?(this.popTitle="修改派车单",this.infoData(this.info)):this.isDbclick?(this.popTitle="查看派车单",this.infoData(this.info)):(this.popTitle="提货派车单",this.newInfoData(),this.fetchGetPickUp(),this.valkey=Math.random())},filterfn:function(e){return 235!==e.id},infoData:function(e){this.form.tmsOrderPickup.pickupName=e.pickupName,this.form.tmsOrderPickup.pickupAmount=e.pickupAmount,this.form.tmsOrderPickup.pickupWeight=e.pickupWeight,this.form.tmsOrderPickup.pickupVolume=e.pickupVolume,this.form.tmsOrderPickup.carriage=e.carriage,this.form.tmsOrderPickup.collectionFee=e.collectionFee,this.form.tmsOrderPickup.payMethod=e.payMethod,this.form.tmsOrderPickup.pickupStatus=e.pickupStatus,this.form.tmsOrderPickup.remark=e.remark,this.form.tmsOrderPickup.arriveTime=+new Date(e.arriveTime),this.form.tmsOrderPickup.outTime=+new Date(e.outTime),this.form.tmsOrderPickup.toCityName=e.toCityName,this.form.tmsOrderPickup.id=e.id,this.form.tmsOrderPickup.truckFee=e.truckFee,console.log("infoData",e),this.form.tmsTruck.truckIdNumber=e.truckIdNumber,this.form.tmsTruck.truckType=e.truckType,this.form.tmsTruck.truckUnit=e.truckUnit,this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.driverMobile,this.form.tmsCustomer.customerName=e.customerName,this.form.tmsCustomer.customerMobile=e.customerMobile,this.form.tmsCustomer.detailedAddress=e.detailedAddress,this.pickupBatchNumber=e.pickupBatchNumber,this.valkey=Math.random()},validateIsEmpty:function(){var r=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"不能为空！";return function(e,t,i){t?i():(r.showMessage(s),i(new Error(s)))}},showMessage:function(e){this.isChecked&&!this.isCheckedShow&&(this.isCheckedShow=!0),this.isCheckedShow?this.checkShowMessage=!0:this.checkShowMessage=!1},setObject:function(e,t){for(var i in e)e[i]=t?t[i]:"";return e},fetchGetPickUp:function(){var t=this;return this.loading=!0,Object(l.b)().then(function(e){t.pickupBatchNumber=e.data,t.loading=!1}).catch(function(e){t._handlerCatchMsg(e)})},setSender:function(e,t){t=t?"customRece":"tmsCustomer",e&&(this.form[t].customerType="tmsCustomer"===t?1:2,this.form[t].customerName=e.customerName,this.form[t].customerMobile=e.customerMobile,this.form[t].detailedAddress=e.detailedAddress,this.form[t].customerId=e.customerId)},selectToCity:function(e,t){e&&(this.form.tmsOrderPickup.toCityCode=e.id,this.form.tmsOrderPickup.toCityName=e.longAddr)},getdriverName:function(e,t){e&&(this.form.tmsDriver.driverMobile?this.form.tmsDriver.driverMobile=s()(this.form.tmsDriver.driverMobile):(this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.driverMobile,this.form.tmsDriver.driverId=e.id))},getTrunkName:function(e){e&&(""===this.form.tmsDriver.driverName||""===this.form.tmsDriver.driverMobile?(this.form.tmsDriver.driverName=e.driverName,this.form.tmsDriver.driverMobile=e.dirverMobile,this.form.tmsDriver.driverId=e.driverId):(this.form.tmsDriver.driverName=s()(this.form.tmsDriver.driverName),this.form.tmsDriver.driverMobile=s()(this.form.tmsDriver.driverMobile)),this.form.tmsTruck.truckId=e.truckId,this.form.tmsTruck.truckType=e.truckType,this.form.tmsTruck.truckUnit=e.truckUnit,this.form.tmsTruck.truckIdNumber=e.truckIdNumber)},initInfo:function(){this.loading=!1},submitForm:function(o){var a=this;this.isChecked=!0,this.isCheckedShow=!0,this.checkShowMessage=!0,this.$refs[o].validate(function(e){if(a.isChecked=!1,a.isCheckedShow=!1,!e||a.loading)return!1;a.loading=!0,a.form.tmsOrderPickup.pickupBatchNumber=a.pickupBatchNumber;var t=void 0,i=Object(k.objectMerge2)({},a.form);if(a.loading=!0,a.isModify)t=Object(l.i)(i);else{var r=!1;for(var s in i.tmsCustomer)a.sender[s]!==i.tmsCustomer[s]&&(r=!0);i.tmsCustomer.customerId=r?"":a.form.tmsCustomer.customerId,i.tmsOrderPickup.outTime=+new Date(a.form.tmsOrderPickup.outTime),t=Object(l.e)(i)}t.then(function(e){a.loading=!1,a.$refs[o].resetFields(),a.$emit("success"),a.closeMe(),a.$message.success("保存成功"),a.loading=!1}).catch(function(e){"提货批次已存在"===e.text?a.fetchGetPickUp():a._handlerCatchMsg(e),a.loading=!1})})},newInfoData:function(){this.form={tmsCustomer:{customerName:"",customerMobile:"",detailedAddress:"",customerId:""},tmsDriver:{driverName:"",driverMobile:"",driverId:""},tmsTruck:{truckIdNumber:"",truckType:"",truckUnit:"",truckId:""},tmsOrderPickup:{pickupBatchNumber:"",pickupName:"",pickupAmount:"",pickupVolume:"",pickupWeight:"",carriage:"",payMethod:76,toCityCode:"",toCityName:"",remark:"",truckFee:"",pickupStatus:236,collectionFee:"",outTime:new Date,arriveTime:""}}},reset:function(){this.watchInfo()},closeMe:function(e){this.reset(),this.$emit("update:popVisible",!1),"function"==typeof e&&e()}}}}});