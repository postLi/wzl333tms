webpackJsonp([381],{"5O09":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("94yS"),l=i("d/fn"),n=i("VU/8")(a.a,l.a,null,null,null);t.default=n.exports},"94yS":function(e,t,i){"use strict";var a=i("//Fk"),l=i.n(a),n=i("mvHQ"),o=i.n(n),r=i("woOf"),s=i.n(r),c=i("DAYN"),d=i.n(c),h=i("oagj"),u=i("0xDb"),f=i("Zjyc"),p=i("UQm2"),g=(i("i7Ou"),i("6ThG")),m="";t.a={components:{draggable:d.a,Upload:f.a},props:{popVisible:{type:Boolean,default:!1},formInfo:{type:[Object,Array],default:function(){}}},data:function(){return{modelTableKey:0,currentModel:{},maxModelSize:5,isSaveNewModel:!0,modelData:[],tagSize:"mini",formPrint:{printSetting:{label:""},printFontSetting:{label:""}},printRotate:{width:0,filedValue:"settingRotate",filedName:"打印方向"},printRotateRule:[{value:0,label:"还原"},{value:180,label:"旋转180°"}],cargoLabelList:[[],[],[]],cargoNum:1,maxCargo:3,printers:[],currentSearch:"",labelSelf:"",labelIndex:0,loading:!0,imageUrl:"",btnsize:"mini",bgprop:{scale:1,x:0,y:0},formModel:{labelList:[],paper:{width:0,height:0,leftx:0,topy:0}},defaultLabelWidth:150,defaultLabelHeight:30,defaultLabelFontSize:12,defaultPaperWidth:80,defaultPaperHeight:80,imgNameStr:"预览图片lyy,",prxvalue:.264,mm2px:3.779,maxLabel:3,maxLabelSelf:19,classItem:[],orgLabelList:[],labelListView:[],rules:{},viewKey:0,flags:!1,isDragView:!1,isMove:!1,showDragDetail:!1,showDragTips:[],isShowDragTips:!0,isHiddenDragDetail:!0,isDrag:null,dragDetailInfo:{},dragCursor:"move",alignmentValue:["","left","center","right"],alignmentOptions:[{value:1,label:"文字靠左"},{value:2,label:"文字居中"},{value:3,label:"文字靠右"}],dialogVisible:!1,commonLabelList:[],cargoKey:0,modelNameSelf:"",preoldData:[],prenewData:[]}},watch:{imageUrl:{handler:function(e,t){console.log("图片",e,t)},deep:!0},formInfo:{handler:function(e,t){},deep:!0},popVisible:function(){this.popVisible?(this.dialogVisible=!0,this.init(),this.bindKey()):(this.dialogVisible=!1,this.unbindKey())}},computed:{printPreviewContent:function(){var e=300,t=150,i=this.imageUrl;return this.formModel&&(e=this.formModel.paper.width,t=this.formModel.paper.height),{width:e/this.prxvalue+"px",height:t/this.prxvalue+"px",backgroundImage:"url("+i+")",backgroundRepeat:"no-repeat",backgroundSize:100*this.bgprop.scale+"% auto",backgroundPosition:this.bgprop.x+"px "+this.bgprop.y+"px"}},printPreviewPaper:function(){},isActiveDrag:function(){return{}}},mounted:function(){},beforeDestroy:function(){this.unbindKey()},destroyed:function(){this.closeMe()},methods:{init:function(){var e=this;this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.isSaveNewModel=!0,this.loading=!0,this.getModel().then(function(){e.initPrinter(),e.formPrint=Object(u.objectMerge2)({},e.formInfo),e.getCommonSettingLib()}),this.loading=!1},handleSelectModel:function(e,i,a,l){var n=this,o=Object(u.objectMerge2)({},i),r=function(){n.modelData.forEach(function(e,t){e[l]=!1})},t=function(){if(n.modelData.filter(function(e){return!0===e[l]}).length){r(),i[l]=!0;var e={id:o.id,type:l,companyId:n.otherinfo.companyId};return Object(g.h)(e).then(function(e){n.$message.success("设置模板模板成功！"),n.modelData[a][l]=!0}).catch(function(e){n._handlerCatchMsg(e)})}i[l]=!i[l];var t="web"===l?"Web网页版":"app"===l?"App移动端":"提货";n.$message.warning("必须要选择一个模板作为"+t+"的默认模板！")};i.id?t():(i[l]=!i[l],this.$confirm("设置新增的模板为默认模板需要先保存，是否保存?","提示",{confirmButtonText:"确定",cancelButtonText:"放弃",type:"warning"}).then(function(){n.submitForm("formModel","allsave").then(function(){r(),n.modelData[a][l]=!0,console.log("updatemodel::::",o,a,l,n.modelData[a]),o.id=n.modelData[a].id,t()})}).catch(function(){o[l]=!o[l]}))},changeModelName:function(e,t,i){console.log(e,t,i),this.currentModel.modelName=e},getModel:function(){var t=this;return Object(g.d)().then(function(e){e.forEach(function(e){e.app=1===e.app,e.web=1===e.web,e.pickUp=1===e.pickUp}),t.modelTableKey=(new Date).getTime(),t.modelData=e||[],t.currentModel=t.modelData.filter(function(e){return!0===e.web})[0]}).catch(function(e){t._handlerCatchMsg(e)})},addModel:function(){var t=this;this.modelData.length>=this.maxModelSize?this.$message.warning("最多只能添加5个模板"):(this.isSaveNewModel=!1,this.submitForm().then(function(){t.getModel().then(function(){t.preoldData=[];var e={app:0,companyId:t.otherinfo.companyId,modelName:"模版名称"+Object(u.parseTime)(new Date,"{y}{m}{d}-{h}{i}{s}"),web:0};t.modelNameSelf=e.modelName,t.modelData.push(e),t.currentModel=e,t.loading=!1,t.resetForm(),console.log("isSaveNewModel add ",t.isSaveNewModel)})}))},deleteModel:function(t,e){var i=this;if(console.log("deleteModel",t,e,this.currentModel),t.app||t.web||t.pickUp)return this.$message.warning("不能删除默认模板~"),!1;this.$confirm("此操作将永久删除该模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"放弃",type:"warning"}).then(function(){if(t.id)if(i.currentModel.id===t.id)Object(g.a)(t.id).then(function(){i.getModel().then(function(){i.currentModel=i.modelData.filter(function(e){return!0===e.web})[0],i.viewModel(i.currentModel,0,"nosave"),i.$message.success("模板删除成功~")})}).catch(function(e){i._handlerCatchMsg(e)});else{var e=Object(u.objectMerge2)({},i.currentModel);Object(g.a)(t.id).then(function(){i.getModel().then(function(){e.id||i.modelData.push(e),i.currentModel=e}),i.$message.success("模板删除成功~")}).catch(function(e){i._handlerCatchMsg(e)})}else i.modelData.splice(-1,1),i.isSaveNewModel=!0,i.currentModel=i.modelData.filter(function(e){return!0===e.web})[0],i.viewModel(i.currentModel,0,"nosave"),i.$message.success("新增的模板删除成功~")}).catch(function(){})},viewModel:function(t,e,i){var a=this;if(console.log("viewModel",t,e,i),this.currentModel.id){if(t.id===this.currentModel.id&&"nosave"!==i)return!1}else if(!t.id)return!1;var l=function(){if(t.id)return Object(g.m)(t.id).then(function(e){e&&(a.currentModel=t,a.$message.success("模板切换成功~"),a.formatData(e))}).catch(function(e){a._handlerCatchMsg(e)})};"nosave"!==i?this.checkOldData()?l():this.submitForm().then(function(){l()}):l()},changePrintRotate:function(e){this.printRotate.width=e,console.log(e,this.printRotate)},showCargoPlus:function(){var a=this;this.cargoNum<this.maxCargo?(this.cargoNum=this.cargoNum+1,this.cargoLabelList[this.cargoNum-1].forEach(function(i){a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&(i.showCargo=!0,a.$set(a.formModel.labelList,t,i))})}),this.cargoKey=(new Date).getTime()):this.$message({type:"warning",message:"最多添加"+this.maxCargo+"套货物信息"})},print:function(e){var t=this,i=Object(u.objectMerge2)([],this.labelListView);i.push(Object(u.objectMerge2)({},this.formModel.paper)),i.push(Object(u.objectMerge2)({},this.printRotate)),i.forEach(function(e){e.width=Math.round(e.width/t.prxvalue),e.height=Math.round(e.height/t.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,e.isshow=e.isshow?1:0,e.value=e.filedName,"setting"===e.filedValue&&(e.bold=0,e.fontsize=null,e.alignment=null,e.value="")}),Object(p.a)({orderdata:i,number:1,printer:this.formPrint.printSetting.label,printSetup:i,type:"order",fontFamily:this.formPrint.printFontSetting.label,preview:"preview"===e,mock:!0})},initPrinter:function(){for(var e in this.printers=s()([],Object(p.b)()),this.printers)this.printers[e]=this.printers[e].replace(/%^/g,"\\")},clearImgUrl:function(){this.imageUrl=""},querySearch:function(t,e){this.currentSearch=t;var i=Object(u.objectMerge2)([],this.orgLabelList),a=t?i.filter(function(e){return-1!==e.filedName.indexOf(t)}):i;this.formModel.labelList=Object(u.objectMerge2)([],a),e(a)},handleSelect:function(e){console.log("handleSelect item",e)},bindKey:function(){document.addEventListener("mousemove",this.conrightMove,!0),document.addEventListener("mouseup",this.conrightEnd,!0),document.addEventListener("keyup",this.deleteEditIndex,!0),document.addEventListener("keydown",this.controlEditIndex,!0)},unbindKey:function(){document.removeEventListener("mousemove",this.conrightMove),document.removeEventListener("mouseup",this.conrightEnd),document.removeEventListener("keyup",this.deleteEditIndex),document.removeEventListener("keydown",this.controlEditIndex)},startSetBg:function(e){var t=this;clearInterval(this.bgtimer),this.bgtimer=setInterval(function(){t.setBg(e)},100)},stopSetBg:function(e){clearInterval(this.bgtimer)},setBg:function(e){var t=this.bgprop.scale;switch(e){case"zoomOut":t=2<(t+=.05)?2:t,this.bgprop.scale=t;break;case"zoomIn":t=(t-=.05)<.5?.5:t,this.bgprop.scale=t;break;case"moveLeft":this.bgprop.x-=1;break;case"moveRight":this.bgprop.x+=1;break;case"moveUp":this.bgprop.y-=1;break;case"moveDown":this.bgprop.y+=1;break;case"reset":this.bgprop={scale:1,x:0,y:0}}},conrigthStart:function(e,t,i,a){this.isHiddenDragDetail=!1,t.x=e.pageX,t.y=e.pageY,t.orgwidth=Math.round(t.width/this.prxvalue),t.orgheight=Math.round(t.height/this.prxvalue),t.mousetype=a,this.isDrag=t},conrightMove:function(e){if(this.isDrag){var t=this.isDrag,i=t.mousetype,a=e.pageX-t.x,l=e.pageY-t.y;this.calcWH(t,a,l,i)}},calcWH:function(e,t,i,a){var l=e.orgwidth,n=e.orgheight;"right"!==a&&"bottomright"!==a||(l+=t),"bottom"!==a&&"bottomright"!==a||(n+=i),l=l<15?15:1e3<l?1e3:l,n=n<20?20:1e3<n?1e3:n,e.width=Math.round(l*this.prxvalue),e.height=Math.round(n*this.prxvalue)},conrightEnd:function(e){if(this.isDrag){var t=this.isDrag;t.x=e.pageX,t.y=e.pageY,this.isDrag=null}},addItemDrag:function(i,e){var a=this;console.log(i,e);var t=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;"customFields"===i.filedValue&&((i=Object(u.objectMerge2)({},i)).topy=0,i.leftx=0,i.filedName=this.labelSelf,setTimeout(function(){a.labelSelf=""},300));var l=function(){i.isshow=!0,i.fontsize=a.defaultLabelFontSize,a.formModel.labelList.forEach(function(e,t){i.filedValue===e.filedValue&&a.$set(a.formModel.labelList,t,i)}),console.log("row::::",i);var e=Object(u.objectMerge2)({},i);e._index=a.labelIndex++,e.width=Math.round(a.defaultLabelWidth*a.prxvalue),e.height=Math.round(a.defaultLabelHeight*a.prxvalue),e.fontsize=a.defaultLabelFontSize,e.bold=0,e.alignment=1,a.labelListView.push(Object(u.objectMerge2)({},e)),a.orgLabelList.forEach(function(e,t){e.filedValue===i.filedValue&&a.$set(a.orgLabelList,t,Object(u.objectMerge2)({},i))}),a.editDragItem(e,a.labelListView.length-1)};"customFields"===i.filedValue&&t<this.maxLabelSelf?l():t<this.maxLabel?l():this.$notify.info({title:"消息",message:"【 "+i.filedName+" 】最多添加"+("customFields"===i.filedValue?this.maxLabelSelf:this.maxLabel)+"次"})},clickPanel:function(e){var i=0;e.path.forEach(function(e,t){e.className&&-1!==e.className.indexOf("previewBlock")&&(i+=1)}),i||(this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.isHiddenDragDetail=!0),i=0},editDragItem:function(e,t,i){this.dragDetailInfo={},this.dragDetailInfo=Object(u.objectMerge2)({},e),console.log("编辑显示项:",this.dragDetailInfo,t),this.classItem=[],this.showDragTips=[],this.classItem[t]&&i&&this.isHiddenDragDetail?(this.showDragDetail=!1,this.isHiddenDragDetail=!1):(this.isHiddenDragDetail=!0,this.classItem[t]=!0,this.showDragDetail=!0),this.showDragTips[t]=!0},changeDragDetailInfo:function(e){var i=this;e&&(this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.$set(i.labelListView,t,i.dragDetailInfo)}),this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList,t,i.dragDetailInfo),"setting"===e.filedValue&&(i.$set(i.formModel.labelList,t,i.formModel.paper),console.log("this.formModel.paper:",i.formModel.paper))}))},review:function(){var e=this,t=Object(u.objectMerge2)({},this.currentModel);this.showDragDetail=!1,this.viewKey=(new Date).getTime(),this.formModel.labelList=[],this.orgLabelList=[],this.labelListView=[],this.cargoNum=this.$options.data().cargoNum,this.cargoKey=(new Date).getTime(),this.currentSearch="",this.initPrinter(),this.getModel().then(function(){t.id?e.viewModel(t,0,"nosave"):e.resetForm()}),this.dragDetailInfo={},this.isDrag=null},dragStart:function(i,e,t){if(this.showDragTips[t]=!0,this.isDrag)return console.log("dragStart"),!1;this.isDragView=!0;(m=i.currentTarget).getAttribute("data-fileName");var a=Number(m.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e,t){e._index===a&&(e.x=i.pageX,e.y=i.pageY)})},dragEnd:function(t,e,i){if(this.isDrag)return console.log("dragEnd"),!1;console.log(this.showDragTips[i]),this.isDragView=!0;(m=t.currentTarget).getAttribute("data-fileName");var a=Number(m.getAttribute("data-index"));this.isMove=!0,this.labelListView.forEach(function(e){e._index===a&&(e.leftx+=t.pageX-e.x,e.topy+=t.pageY-e.y)}),this.findOutPage(e,i),this.dragCursor="move",this.showDragTips=[]},findOutPage:function(e,t){console.log(e.leftx,e.width),Math.round(e.leftx*this.prxvalue)+e.width<0||Math.round(e.topy*this.prxvalue)+e.height<0||e.leftx>Math.round(this.formModel.paper.width/this.prxvalue)||e.topy>Math.round(this.formModel.paper.height/this.prxvalue)?(this.dragCursor="not-allowed",this.deleteItemByIndex(e,t)):this.editDragItem(e,t)},deleteItemByIndex:function(i,a){var l=this;i.isshow=!1,this.dragDetailInfo={},this.classItem=[],this.showDragTips=[],this.showDragDetail=!1,this.labelListView=Object(u.objectMerge2)([],this.labelListView).filter(function(e,t){return t!==a});var e=this.labelListView.filter(function(e){return e.filedValue===i.filedValue}).length;console.log("删除的"+i.filedValue+"还有"+e+"个"),0===e&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.filedValue&&(l.$set(e,"isshow",!1),console.log("labelList上的row",e.filedValue,e.isshow))}),this.orgLabelList=Object(u.objectMerge2)([],this.formModel.labelList))},handleKeyEvent:function(e,t,i){var a=this,l=h.a.getPressedKey(e),n=event.target.tagName||event.srcElement.tagName;if("INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&-1!==t.indexOf(l)&&this.dragDetailInfo.filedValue){var o={};this.labelListView.filter(function(e,t){return a.dragDetailInfo._index===e._index&&(o.el=e,o.index=t,!0)}),o.el&&i(o,l,e)}},deleteEditIndex:function(e){var i=this;this.handleKeyEvent(e,["delete","backspace"],function(e,t){i.deleteItemByIndex(e.el,e.index)})},controlEditIndex:function(e){var n=this;this.handleKeyEvent(e,["tab","shift+tab"],function(e,t,i){i.preventDefault();var a=e.index;"tab"===t?a++:a--,a=a>=n.labelListView.length?0:a<0?n.labelListView.length-1:a,n.editDragItem(n.labelListView[a],a,i)}),this.handleKeyEvent(e,["ctrl+up","ctrl+down","ctrl+left","ctrl+right"],function(e,t,i){i.preventDefault();var a=/(up|down)/.test(t)?"height":"width",l=e.el[a];switch(t){case"ctrl+up":case"ctrl+left":l-=1;break;case"ctrl+down":case"ctrl+right":l+=1}l=l<5?5:l>n.formModel.paper.width?n.formModel.paper.width:l,e.el[a]=l}),this.handleKeyEvent(e,["up","down","left","right"],function(e,t){var i=/(up|down)/.test(t)?"topy":"leftx",a=e.el[i],l=0;switch(l=Math.round(a/n.mm2px)*n.mm2px,t){case"up":case"left":l-=n.mm2px;break;case"down":case"right":l+=n.mm2px}e.el[i]=l})},drag:function(e){this.isDragView=!1,this.isMove=!1,m=e.currentTarget},drop:function(t){var i=this;t.preventDefault(),console.log(t.offsetX,t.offsetY,t);var a=m.getAttribute("data-fileName");this.isMove||this.orgLabelList.filter(function(e){e.filedValue!==a||i.isDragView||(e.leftx=t.offsetX,e.topy=t.offsetY,i.addItemDrag(e))})},allowDrop:function(e){e.preventDefault()},sortLabel:function(e,l){return e.sort(function(e,t){var i=e[l],a=t[l];return i.length-a.length})},getCommonSettingLib:function(){var a=this;this.loading=!0,this.commonLabelList=[],Object(g.b)().then(function(e){e&&(Object(u.objectMerge2)([],e).forEach(function(e,t){var i={id:e.id,filedValue:e.fieldValue,filedName:e.fieldName,topy:0,leftx:0,width:0,height:0,companyid:a.otherinfo.companyId,modelId:"",isshow:0,fontsize:10,alignment:1,bold:0,type:e.type};"horizontalLine"===i.filedValue||"verticalLine"===i.filedValue||a.commonLabelList.push(i)}),a.sortLabel(a.commonLabelList,"filedName"),a.$nextTick(function(){a.getSettingCompanyLi()}))}).catch(function(e){a.loading=!1,a._handlerCatchMsg(e)})},getSettingCompanyLi:function(){var t=this;this.loading=!0,this.labelListView=[],this.orgLabelList=[],this.viewKey=(new Date).getTime();Object(g.f)().then(function(e){t.formatData(e)}).catch(function(e){t.loading=!1,t._handlerCatchMsg(e)})},closeMe:function(e){this.$emit("close"),"function"==typeof e&&e()},checkNull:function(e){return null!=e&&""!==e&&void 0},resetForm:function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"formModel",a=arguments[1];this.$refs[e].validate(function(e){if(e){var t=function(){i.formModel.labelList.forEach(function(e,t){i.isSaveNewModel||(e.id="",e.modelId=""),"setting"!==e.filedValue&&(e.topy=0,e.leftx=0,e.isshow=0,e.width=Math.round(i.defaultLabelWidth*i.prxvalue),e.height=Math.round(i.defaultLabelHeight*i.prxvalue),e.fontsize=10,e.bold=0,e.alignment=1)}),i.formModel.paper.width=i.defaultPaperWidth,i.formModel.paper.height=i.defaultPaperHeight,i.formModel.paper.topy=0,i.formModel.paper.leftx=0,i.labelListView=[],i.currentSearch="",i.showDragDetail=!1,console.log("cargoNum",i.cargoNum),console.log("formModel",i.formModel)};"allclear"===a?i.$confirm("此操作将所有设置重置为0,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t()}).catch(function(e){}):t()}})},canDragStart:function(e){},handleSwitch:function(e){var i=this,a=0;this.labelListView.forEach(function(e,t){e._index===i.dragDetailInfo._index&&i.labelListView.splice(t,1),e.filedValue===i.dragDetailInfo.filedValue&&(a+=1)}),1===a&&(this.formModel.labelList.forEach(function(e,t){e.filedValue===i.dragDetailInfo.filedValue&&i.$set(i.formModel.labelList[t],"isshow",!1)}),this.orgLabelList=Object(u.objectMerge2)([],this.formModel.labelList)),this.$nextTick(function(){i.showDragDetail=!1})},changeValue:function(e,t,i){this.viewKey=(new Date).getTime()},savePrinter:function(){this.formInfo.printSetting.label===this.formPrint.printSetting.label&&this.formInfo.printFontSetting.label===this.formPrint.printFontSetting.label||this.$emit("success",{label:this.formPrint.printSetting.label,labelFont:this.formPrint.printFontSetting.label})},formatData:function(a){var l=this,n=s()([],a||[]),o=[],r=Object(u.objectMerge2)([],this.commonLabelList);this.labelListView=[],n.forEach(function(i){r.forEach(function(e,t){e.filedValue===i.filedValue&&(i.isshow||"setting"===e.filedValue||"settingRotate"===e.filedValue||(i.width=l.defaultLabelWidth,i.height=l.defaultLabelHeight),"setting"===e.filedValue&&(console.log("纸张设置",l.formModel.labelList[t],i),l.$set(l.formModel.labelList,t,i),l.formModel.labelList[t]=i),l.$set(i,"type",e.type),4===i.type&&("2"===i.filedName.slice(-1)&&(cargoShow2=!0,l.cargoNum=2),"3"===i.filedName.slice(-1)&&(cargoShow3=!0,l.cargoNum=3)),r.splice(t,1),o.push(i))})}),this.formModel.labelList=Object(u.objectMerge2)([],o.concat(r)),this.formModel.labelList.forEach(function(t,e){if(t.modelId=t.modelId||"","settingRotate"===t.filedValue?(t.width=Math.round((t.width?t.width:0)*l.prxvalue),t.height=1,console.log("settingRotate",t.width)):(t.width=Math.round((t.width?t.width:l.defaultLabelWidth)*l.prxvalue),t.height=Math.round((t.height?t.height:l.defaultLabelHeight)*l.prxvalue)),"setting"===t.filedValue){var i=s()({},t);a||(i.width=l.defaultPaperWidth,i.height=l.defaultPaperHeight),i.leftx=Math.round(i.leftx*l.prxvalue),i.topy=Math.round(i.topy*l.prxvalue),l.formModel.paper=i}else"settingRotate"===t.filedValue?l.printRotate=s()({},t):(n.forEach(function(e){e.filedValue===t.filedValue&&(e.isshow?(e.width=Math.round((e.width?e.width:l.defaultLabelWidth)*l.prxvalue),e.height=Math.round((e.height?e.height:l.defaultLabelHeight)*l.prxvalue),e.fontsize=e.fontsize?e.fontsize:10,e.isshow=1===e.isshow,e.bold=2===e.bold,e.alignment=e.alignment||1,e._index=l.labelIndex++,"setting"!==e.filedValue&&l.labelListView.push(e)):-1!==e.filedName.indexOf(l.imgNameStr)&&(l.imageUrl=e.filedName.split(",")[1]))}),t.fontsize=t.fontsize?t.fontsize:10,t.isshow=1===t.isshow,t.bold=2===t.bold,t.alignment=t.alignment||1);if(4===t.type)switch(t.showCargo=!1,t.filedName.slice(-1)){case"2":cargoShow2&&(t.showCargo=!0),l.cargoLabelList[1].push(t);break;case"3":cargoShow3&&(t.showCargo=!0),l.cargoLabelList[2].push(t);break;default:t.showCargo=!0,l.cargoLabelList[0].push(t)}6===t.type&&(l.modelNameSelf=t.filedName)}),this.$nextTick(function(){l.orgLabelList=Object(u.objectMerge2)([],l.formModel.labelList),l.preoldData=Object(u.objectMerge2)([],l.labelListView.concat([l.formModel.paper],[l.printRotate],[l.modelNameSelf])),l.loading=!1})},checkOldData:function(){var e=Object(u.objectMerge2)([],this.labelListView);return e.push(Object(u.objectMerge2)({},this.formModel.paper)),this.prenewData=Object(u.objectMerge2)([],e.concat([this.printRotate],[this.modelNameSelf])),o()(this.preoldData)===o()(this.prenewData)},setData:function(){},validate:function(){return console.log("this.modelNameSelf",this.modelNameSelf),""!==this.modelNameSelf||(this.$message.warning("请填写模板名称"),!1)},submitForm:function(){var s=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"formModel",c=arguments[1];return new l.a(function(o,r){s.$refs[e].validate(function(e){if(e){if(!s.validate())return console.log(11111111),!1;s.savePrinter(),s.loading=!0,s.showDragDetail=!1;var i=Object(u.objectMerge2)({},s.currentModel),a=Object(u.objectMerge2)([],s.labelListView);console.log("arr",a);var l={},n={};a.push(Object(u.objectMerge2)({},s.formModel.paper));var t=function(){s.formModel.labelList.forEach(function(e){if("customFields"===e.filedValue&&s.imageUrl&&((l=Object(u.objectMerge2)({},e)).filedName=s.imgNameStr+s.imageUrl,l.isshow=!1,console.log(" 提交的时候 imageUrl1",s.imageUrl,l)),6===e.type&&((n=Object(u.objectMerge2)({},e)).filedName=s.modelNameSelf+"",n.isshow=!1,a.push(n)),"settingRotate"===e.filedValue){var t=Object(u.objectMerge2)({},e);t.width=s.printRotate.width,t.isshow=!1,a.push(t)}}),s.imageUrl&&a.push(l),a=Object(u.objectMerge2)([],a).filter(function(e){var t=function(){e.width=Math.round(e.width/s.prxvalue),e.height=Math.round(e.height/s.prxvalue),e.isshow=e.isshow?1:0,e.bold=e.bold?2:1,"setting"===e.filedValue&&(console.log("this.formModel.paper::",s.formModel.paper,e),e.leftx=Math.round(s.formModel.paper.leftx/s.prxvalue),e.topy=Math.round(s.formModel.paper.topy/s.prxvalue))};return"setting"!==e.filedValue&&"modelName"!==e.filedValue&&"settingRotate"!==e.filedValue?!(Math.round(e.leftx*s.prxvalue)+e.width<0||Math.round(e.topy*s.prxvalue)+e.height<0||e.leftx>Math.round(s.formModel.paper.width/s.prxvalue)||e.topy>Math.round(s.formModel.paper.height/s.prxvalue))&&(t(),!0):(t(),!0)}),console.log(" 提交的时候 arr",a,s.currentModel);var t=Object(u.objectMerge2)([],s.modelData);t.forEach(function(e){e.app=e.app?1:0,e.web=e.web?1:0,e.pickUp=e.pickUp?1:0});var e={currentModelId:s.currentModel.id||null,currentModelName:s.currentModel.modelName||"",tmsCommonModelLibDtoList:t,tmsSettingLibList:a};return Object(g.i)(e).then(function(e){s.$message({type:"success",message:"标签打印设置成功！"}),s.isSaveNewModel?(s.getCommonSettingLib(),s.getModel().then(function(){"allsave"===c&&(i.id||(i=s.modelData[s.modelData.length-1]),s.viewModel(i,"0","nosave")),t=[],s.prenewData=[],s.isSaveNewModel=!0,s.loading=!1,s.viewKey=(new Date).getTime(),o()})):(t=[],s.prenewData=[],s.isSaveNewModel=!0,s.loading=!1,s.viewKey=(new Date).getTime(),o())}).catch(function(e){s.loading=!1,s._handlerCatchMsg(e),r()})};s.checkOldData()||"allsave"===c?t():s.$confirm("当前模板未保存，是否保存?","提示",{confirmButtonText:"保存",cancelButtonText:"放弃",type:"warning"}).then(function(){t()}).catch(function(){s.currentModel.id||s.modelData.splice(s.modelData.length-1,1),s.loading=!1,o()})}})})}}}},"d/fn":function(e,t,i){"use strict";var a={render:function(){var l=this,e=l.$createElement,n=l._self._c||e;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:l.loading,expression:"loading"}],staticClass:"tms_dialog_print_drag",attrs:{title:"打印标签设置 (单位:毫米mm)",visible:l.dialogVisible,fullscreen:"","before-close":l.closeMe,"close-on-press-escape":!1},on:{"update:visible":function(e){l.dialogVisible=e}}},[n("div",{key:l.viewKey,staticClass:"print_aside"},[n("div",{staticClass:"print_aside_head"},[n("span",[n("i",{staticClass:"el-icon-menu"}),l._v(" 字段列表 "+l._s(l.formModel.labelList.length)+" ")]),l._v(" "),n("el-popover",{staticStyle:{float:"right","margin-top":"0px","margin-left":"10px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[n("span",[l._v("可将信息项手动拖拽到右边纸张中显示及设置位置和宽高；"),n("br"),l._v("(单位：毫米mm)")]),l._v(" "),n("br"),l._v(" "),n("span",[l._v("【快捷键：】")]),l._v(" "),n("br"),l._v(" "),n("span",[l._v("按↑ ↓ ← →移动编辑项，")]),l._v(" "),n("br"),n("span",[l._v("按ctrl+↑↓控制高度变化，")]),l._v(" "),n("br"),n("span",[l._v("按ctrl+←→控制宽度变化 ")]),l._v(" "),n("br"),l._v(" "),n("span",[l._v("按tab键切换编辑项，")]),l._v(" "),n("br"),n("span",[l._v("shift+tab切换回上一个编辑项")]),l._v(" "),n("i",{staticClass:"el-icon-warning",attrs:{slot:"reference"},slot:"reference"})]),l._v(" "),n("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"success",icon:"el-icon-document",size:l.btnsize},on:{click:function(e){l.submitForm("formModel","allsave")}}},[l._v("保存")]),l._v(" "),n("el-button",{staticStyle:{float:"right","margin-top":"10px","margin-right":"10px"},attrs:{icon:"el-icon-refresh",size:l.btnsize},on:{click:l.review}},[l._v("复原")])],1),l._v(" "),n("div",{staticClass:"print_aside_search"},[n("el-autocomplete",{attrs:{"fetch-suggestions":l.querySearch,placeholder:"查找非自定义字段","popper-class":"popperHide",size:"mini",clearable:""},on:{select:l.handleSelect},model:{value:l.currentSearch,callback:function(e){l.currentSearch=e},expression:"currentSearch"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),l._v(" "),n("el-form",{ref:"formModel",attrs:{model:l.formModel,rules:l.rules,"label-width":"0px"}},[n("div",{staticClass:"print_aside_content_form"},[n("label",[l._v("模板名称")]),l._v(" "),n("ul",{staticClass:"print_aside_content"},l._l(l.formModel.labelList,function(t,i){return 6===t.type?n("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[n("el-input",{staticStyle:{width:"70%"},attrs:{size:"mini",placeholder:"请输入模板名称(最多128个字符)",clearable:"",maxlength:128},on:{change:function(e){return l.changeModelName(e,t,i)}},nativeOn:{keyup:function(e){if(!("button"in e)&&l._k(e.keyCode,"enter",13,e.key,"Enter"))return null;l.addItemDrag(t,i)}},model:{value:l.modelNameSelf,callback:function(e){l.modelNameSelf=e},expression:"modelNameSelf"}}),l._v(" "),n("el-popover",{attrs:{placement:"bottom",width:"800",trigger:"click","popper-class":"printModelPop"}},[n("el-button",{attrs:{size:l.btnsize,type:"success",icon:"el-icon-plus"},on:{click:l.addModel}},[l._v("添加模板")]),l._v(" "),n("el-table",{key:l.modelTableKey,staticClass:"printModelTable",attrs:{data:l.modelData,border:""}},[n("el-table-column",{attrs:{width:"60",property:"date",label:"序号",type:"index"}}),l._v(" "),n("el-table-column",{attrs:{property:"modelName",label:"模板名称"}}),l._v(" "),n("el-table-column",{attrs:{property:"address",label:"使用类型"}},[n("el-table-column",{attrs:{property:"app",width:"100",label:"App移动端"},scopedSlots:l._u([{key:"default",fn:function(t){return[n("el-checkbox",{on:{change:function(e){return l.handleSelectModel(e,t.row,t.$index,"app")}},model:{value:t.row.app,callback:function(e){l.$set(t.row,"app",e)},expression:"scope.row.app"}},[l._v("选择")])]}}])}),l._v(" "),n("el-table-column",{attrs:{property:"web",width:"100",label:"Web网页版"},scopedSlots:l._u([{key:"default",fn:function(t){return[n("el-checkbox",{on:{change:function(e){return l.handleSelectModel(e,t.row,t.$index,"web")}},model:{value:t.row.web,callback:function(e){l.$set(t.row,"web",e)},expression:"scope.row.web"}},[l._v("选择")])]}}])}),l._v(" "),n("el-table-column",{attrs:{property:"pickUp",width:"100",label:"提货"},scopedSlots:l._u([{key:"default",fn:function(t){return[n("el-checkbox",{on:{change:function(e){return l.handleSelectModel(e,t.row,t.$index,"pickUp")}},model:{value:t.row.pickUp,callback:function(e){l.$set(t.row,"pickUp",e)},expression:"scope.row.pickUp"}},[l._v("选择")])]}}])})],1),l._v(" "),n("el-table-column",{attrs:{width:"150",property:"address",label:"其他操作"},scopedSlots:l._u([{key:"default",fn:function(t){return[n("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:l.btnsize,icon:"el-icon-delete"},on:{click:function(e){l.deleteModel(t.row,t.$index)}}},[l._v("删除")]),l._v(" "),n("el-button",{attrs:{type:"text",size:l.btnsize,icon:"el-icon-edit"},on:{click:function(e){l.viewModel(t.row,t.$index)}}},[l._v("编辑")])]}}])})],1),l._v(" "),n("div",{staticClass:"printModelPopTips"},[n("p",[n("i",{staticClass:"el-icon-question"}),l._v(" "),n("span",[l._v("操作指南：")])]),l._v(" "),n("p",[l._v("温馨提示：修改完当前模板，请注意保存哦~")]),l._v(" "),n("ol",[n("li",[l._v("1、每次本页面打开默认显示“Web网页版”的默认模板，若要查看其他模板请点击“\n                    "),n("el-button",{attrs:{type:"text",size:l.btnsize,icon:"el-icon-edit"}},[l._v("编辑")]),l._v("”后查看；")],1),l._v(" "),n("li",[l._v("2、只能为一个类型选择一份默认使用模板，同一个模板可以设置为多个类型的默认模板，新增未保存的模板不可以设置为默认模板；")]),l._v(" "),n("li",[l._v("3、当前页面只能编辑一份模板，若要编辑其他模板，请选择该模板点击“\n                    "),n("el-button",{attrs:{type:"text",size:l.btnsize,icon:"el-icon-edit"}},[l._v("编辑")]),l._v("”；")],1),l._v(" "),n("li",[l._v("4、点击“\n                    "),n("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:l.btnsize,icon:"el-icon-delete"}},[l._v("删除")]),l._v("”删除模板数据后不能恢复，一次只能删除一份模板，请谨慎操作；")],1),l._v(" "),n("li",[l._v("5、模板列表当前最多可以添加"+l._s(l.maxModelSize)+"份模板。")])])]),l._v(" "),n("el-button",{attrs:{slot:"reference",size:l.btnsize,type:"primary",icon:"el-icon-date"},slot:"reference"},[l._v("模板列表")])],1),l._v(" "),n("br"),l._v(" "),n("i",[l._v("默认模板设置：")]),l._v(" "),l.currentModel.web?n("el-tag",{attrs:{type:"success",size:l.btnsize}},[l._v("web网页版")]):l._e(),l._v(" "),l.currentModel.app?n("el-tag",{attrs:{type:"success",size:l.btnsize}},[l._v("App移动端")]):l._e(),l._v(" "),l.currentModel.pickUp?n("el-tag",{attrs:{type:"success",size:l.btnsize}},[l._v("提货")]):l._e(),l._v(" "),l.currentModel.web||l.currentModel.app||l.currentModel.pickUp?l._e():n("i",[l._v("无")])],1):l._e()})),l._v(" "),n("label",[l._v("发货人信息")]),l._v(" "),n("ul",{staticClass:"print_aside_content"},l._l(l.formModel.labelList,function(t,i){return 1===t.type?n("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){l.drag(e)},click:function(e){l.addItemDrag(t,i)}}},[n("el-tag",{attrs:{type:"info",size:l.tagSize}},[t.isshow?n("i",{staticClass:"el-icon-circle-check showLabel"}):l._e(),l._v(" "),n("b",[l._v(l._s(t.filedName))])])],1):l._e()})),l._v(" "),n("label",[l._v("收货人信息")]),l._v(" "),n("ul",{staticClass:"print_aside_content"},l._l(l.formModel.labelList,function(t,i){return 2===t.type?n("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){l.drag(e)},click:function(e){l.addItemDrag(t,i)}}},[n("el-tag",{attrs:{type:"info",size:l.tagSize}},[t.isshow?n("i",{staticClass:"el-icon-circle-check showLabel"}):l._e(),l._v(" "),n("b",[l._v(l._s(t.filedName))])])],1):l._e()})),l._v(" "),n("label",[l._v("标签主要信息")]),l._v(" "),n("ul",{staticClass:"print_aside_content"},l._l(l.formModel.labelList,function(t,i){return 3===t.type?n("li",{key:i,attrs:{draggable:"true","data-fileName":t.filedValue},on:{dragstart:function(e){l.drag(e)},click:function(e){l.addItemDrag(t,i)}}},[n("el-tag",{attrs:{type:"info",size:l.tagSize}},[t.isshow?n("i",{staticClass:"el-icon-circle-check showLabel"}):l._e(),l._v(" "),n("b",[l._v(l._s(t.filedName))])])],1):l._e()})),l._v(" "),n("label",[l._v("自定义信息")]),l._v(" "),n("ul",{staticClass:"print_aside_content"},l._l(l.formModel.labelList,function(t,i){return 5===t.type?n("li",{key:i,staticClass:"print_aside_content_self",staticStyle:{width:"100%"},attrs:{"data-fileName":t.filedValue}},[n("el-input",{attrs:{size:"mini",placeholder:"自定义标签(最多128个字符)",clearable:"",maxlength:128},nativeOn:{keyup:function(e){if(!("button"in e)&&l._k(e.keyCode,"enter",13,e.key,"Enter"))return null;l.addItemDrag(t,i)}},model:{value:l.labelSelf,callback:function(e){l.labelSelf=e},expression:"labelSelf"}}),l._v(" "),n("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(e){l.addItemDrag(t,i)}}},[l._v("添加")])],1):l._e()}))]),l._v(" "),n("div",{staticClass:"prinit_aside_paper"},[n("label",[n("i",{staticClass:"el-icon-edit"}),l._v(" 打印字体")]),l._v(" "),n("el-select",{attrs:{size:"mini"},model:{value:l.formPrint.printFontSetting.label,callback:function(e){l.$set(l.formPrint.printFontSetting,"label",e)},expression:"formPrint.printFontSetting.label"}},l._l(l.$const.PRINT_FONT,function(e,t){return n("el-option",{key:t,attrs:{value:e,label:e}})}))],1),l._v(" "),n("div",{staticClass:"prinit_aside_paper"},[n("span",[n("i",{staticClass:"el-icon-document"}),l._v(" 纸张设置")]),l._v(" "),n("br"),l._v(" "),n("el-form-item",[n("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.formModel.paper.width,callback:function(e){l.$set(l.formModel.paper,"width",e)},expression:"formModel.paper.width"}},[n("template",{slot:"prepend"},[l._v("宽")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1),l._v(" "),n("el-form-item",[n("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.formModel.paper.height,callback:function(e){l.$set(l.formModel.paper,"height",e)},expression:"formModel.paper.height"}},[n("template",{slot:"prepend"},[l._v("高")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1),l._v(" "),n("el-form-item",[n("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.formModel.paper.leftx,callback:function(e){l.$set(l.formModel.paper,"leftx",e)},expression:"formModel.paper.leftx"}},[n("template",{slot:"prepend"},[l._v("左偏移")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1),l._v(" "),n("el-form-item",[n("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.formModel.paper.topy,callback:function(e){l.$set(l.formModel.paper,"topy",e)},expression:"formModel.paper.topy"}},[n("template",{slot:"prepend"},[l._v("上偏移")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1)],1),l._v(" "),n("div",{staticClass:"prinit_aside_rotate"},[n("span",[n("i",{staticClass:"el-icon-refresh"}),l._v(" 内容-打印输出方向")]),l._v(" "),n("br"),l._v(" "),n("el-form-item",[n("el-radio-group",{attrs:{size:"mini"},on:{change:l.changePrintRotate},model:{value:l.printRotate.width,callback:function(e){l.$set(l.printRotate,"width",e)},expression:"printRotate.width"}},l._l(l.printRotateRule,function(e){return n("el-radio-button",{key:e.value,attrs:{label:e.value,border:""}},[l._v(l._s(e.label))])}))],1)],1),l._v(" "),n("el-collapse-transition",[l.showDragDetail?n("div",[n("div",{staticClass:"prinit_aside_detail"},[n("span",[n("i",{staticClass:"el-icon-setting"}),l._v(" "+l._s(l.dragDetailInfo.filedName))]),l._v(" "),n("el-form-item",{staticClass:"print_itemSet_switch"},[n("el-switch",{attrs:{"active-color":"#67c23a","active-text":l.dragDetailInfo.isshow?"显示":"隐藏"},on:{change:l.handleSwitch},model:{value:l.dragDetailInfo.isshow,callback:function(e){l.$set(l.dragDetailInfo,"isshow",e)},expression:"dragDetailInfo.isshow"}})],1),l._v(" "),n("br"),l._v(" "),n("el-form-item",[n("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.dragDetailInfo.width,callback:function(e){l.$set(l.dragDetailInfo,"width",e)},expression:"dragDetailInfo.width"}},[n("template",{slot:"prepend"},[l._v("宽")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1),l._v(" "),n("el-form-item",[n("el-input",{directives:[{name:"number-only",rawName:"v-number-only:point",arg:"point"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.dragDetailInfo.height,callback:function(e){l.$set(l.dragDetailInfo,"height",e)},expression:"dragDetailInfo.height"}},[n("template",{slot:"prepend"},[l._v("高")]),l._v(" "),n("template",{slot:"append"},[l._v("mm")])],2)],1),l._v(" "),n("el-form-item",[n("el-input",{directives:[{name:"numberOnly",rawName:"v-numberOnly"}],attrs:{placeholder:"请输入内容",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.dragDetailInfo.fontsize,callback:function(e){l.$set(l.dragDetailInfo,"fontsize",e)},expression:"dragDetailInfo.fontsize"}},[n("template",{slot:"prepend"},[l._v("字号")])],2)],1),l._v(" "),n("el-form-item",{staticClass:"print_itemSet_col"},[n("el-checkbox",{attrs:{label:"文字加粗",border:"",size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.dragDetailInfo.bold,callback:function(e){l.$set(l.dragDetailInfo,"bold",e)},expression:"dragDetailInfo.bold"}}),l._v(" "),n("el-radio-group",{attrs:{size:"mini"},on:{change:l.changeDragDetailInfo},model:{value:l.dragDetailInfo.alignment,callback:function(e){l.$set(l.dragDetailInfo,"alignment",e)},expression:"dragDetailInfo.alignment"}},l._l(l.alignmentOptions,function(e){return n("el-radio-button",{key:e.value,attrs:{label:e.value,border:""}},[l._v(l._s(e.label))])}))],1)],1)]):l._e()]),l._v(" "),n("div",{staticClass:"prinit_aside_setpreview"},[n("div",{staticClass:"prinit_aside_setpreview_head"},[n("span",[n("i",{staticClass:"el-icon-picture"}),l._v(" 打印背景图片效果预览")]),l._v(" "),l.imageUrl?n("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{icon:"el-icon-delete",size:l.btnsize},on:{click:l.clearImgUrl}},[l._v("清除背景")]):l._e()],1),l._v(" "),n("Upload",{attrs:{title:"本地上传",listtype:"picture"},model:{value:l.imageUrl,callback:function(e){l.imageUrl=e},expression:"imageUrl"}})],1),l._v(" "),n("div",{staticClass:"prinit_aside_info"},[n("el-button",{attrs:{type:"warning",icon:"el-icon-document",size:l.btnsize},on:{click:function(e){l.resetForm("formModel","allclear")}}},[l._v("清空模板")])],1)],1)],1),l._v(" "),n("div",{staticClass:"print_main",on:{click:l.clickPanel}},[n("div",{staticClass:"print_main_head"},[n("b",[l._v("预览展示:")]),l._v(" "),n("span",[l._v(" 纸张(宽×高)："+l._s(this.formModel.paper.width+"(mm) × "+this.formModel.paper.height+"(mm)"))]),l._v(" "),n("div",{staticClass:"print_main_head_btns"},[n("label",{attrs:{for:""}},[l._v("默认打印机：")]),l._v(" "),n("el-select",{attrs:{size:"mini"},model:{value:l.formPrint.printSetting.label,callback:function(e){l.$set(l.formPrint.printSetting,"label",e)},expression:"formPrint.printSetting.label"}},l._l(l.printers,function(e){return n("el-option",{key:e,attrs:{value:e,label:e}})})),l._v(" "),n("el-button",{attrs:{icon:"el-icon-printer",size:"mini",title:"打印测试"},on:{click:function(e){l.print("test")}}}),l._v(" "),n("el-button",{attrs:{icon:"el-icon-view",size:"mini",title:"打印预览"},on:{click:function(e){l.print("preview")}}})],1)]),l._v(" "),n("div",{key:l.viewKey,staticClass:"print_main_content",style:l.printPreviewContent,on:{drop:function(e){l.drop(e)},dragover:function(e){l.allowDrop(e)}}},l._l(l.labelListView,function(i,a){return n("div",{key:a,staticClass:"previewBlock",class:{isActiveDrag:l.classItem[a]},style:{cursor:l.dragCursor,transform:"translate("+i.leftx+"px,"+i.topy+"px)",width:i.width/l.prxvalue+"px",height:i.height/l.prxvalue+"px",fontSize:i.fontsize+"pt",whiteSpace:"nowrap",fontFamily:l.formPrint.printFontSetting.label,fontWeight:i.bold?800:400,textAlign:l.alignmentValue[i.alignment]},attrs:{draggable:"true","data-fileName":i.filedValue,"data-index":i._index},on:{dragstart:function(e){return l.dragStart(e,i,a)},dragend:function(e){return l.dragEnd(e,i,a)},click:function(e){l.editDragItem(i,a,e)}}},[l.showDragTips[a]?n("div",{staticClass:"dragTips"},[l._v("\n          "+l._s("(x :"+Math.round(i.leftx*l.prxvalue)+" mm, y :"+Math.round(i.topy*l.prxvalue)+" mm)")+" "+l._s("(宽: "+i.width+" mm, 高: "+i.height+" mm)")+"\n          ")]):l._e(),l._v(" "),n("div",{staticClass:"dragSizeControler"},[n("span",[l._v(l._s("{ "+i.filedName+" }"))]),l._v(" "),n("div",{staticClass:"conrigth",on:{dragstart:function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,l.conrigthStart(t,i,a,"right");var t}}}),l._v(" "),n("div",{staticClass:"conbottom",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,l.conrigthStart(t,i,a,"bottom");var t}}}),l._v(" "),n("div",{staticClass:"conbottomright",on:{"!dragstart":function(e){e.preventDefault(),e.stopPropagation()},"!mousedown":function(e){return e.preventDefault(),e.stopPropagation(),t=e,l.conrigthStart(t,i,a,"bottomright");var t}}})])])})),l._v(" "),l.classItem.length?n("div",{staticClass:"print_main_foot"},[n("br"),l._v(" 按↑ ↓ ← →移动编辑项，按ctrl+↑↓控制高度变化，按ctrl+←→控制宽度变化\n      "),n("br"),l._v("按tab键切换编辑项，shift+tab切换回上一个编辑项\n    ")]):l._e()])])},staticRenderFns:[]};t.a=a}});