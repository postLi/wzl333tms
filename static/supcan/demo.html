<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Stict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html> 
 <head> 
 <meta http-equiv="Content-Type" content="text/html; charset=GB2312"/>
 <script src="binary/dynaload.js"></script> 
 <script> 

function activeShuoZhengCheck(){

if($B.type == "edge"){
    alert("尚未支持Edge, 请点击右上角的?..(更多), 用Internet Explore打开.");
	}
  else if($B.type == "ie"){
	  //location.href=url + '?110';
	}
  else if($B.npapi || $B.ppapi){
	  //location.href=url + '?110';
	}
  else {
     //插件未安装
    if($B.type == "chrome") {
      if($B.chrome_install_apitype == "npapi")
        window.open("install_chrome.htm");
      else {
        var ofrm=document.getElementById('frm');
        ofrm.height=700;
        ofrm.contentWindow.location.href = 'http://www.supcan.cn/download/clientinstall.htm?110';
        olbl.innerHTML='下载 Chrome 浏览器插件安装包';
      }
    }
    else { //Firefox
      if($B.is64)
        alert("抱歉, 不支持 64位Firefox");
      else
        window.open("binary/supcan.xpi");
    }
  }

}

   function autoResize() 
   { 
       var dv = document.getElementById('main'); 
       var height = (document.documentElement.clientHeight - 100) + 'px'; 
       dv.style.height  = height; 
   } 
   window.onload = function() { 
       autoResize(); 
	   activeShuoZhengCheck();
   } 
   window.onresize = function() { 
       autoResize(); 
   } 


function OnReady(id)
{
    AF.func("Build", "report/report2.xml");
	
    //AF.func("SelectCell", "0\r\n0");
	//指定ds1数据源取数的URL地址 
	var access_token ="3471ea1a-8dcd-4c9f-95e9-258dbcf564cb";
	var startTime = "2018-05-13 11:11:11";
	var endTime = "2018-08-17 11:11:11";
	var orgId = 1;
	var selectType = 1;
	var shipToCityName = "";
	var businessType = "";
	
     AF.func("SetSource", "ds1 \r\n http://192.168.1.157:7010/api-finance/finance/report/v1/findOperationReport?startTime="+startTime+"&endTime="+endTime+"&orgId="+orgId+"&selectType="+selectType+"&shipToCityName="+shipToCityName+"&businessType="+businessType+"&access_token="+access_token);  
                            
   //需要重新计算， 因为SetSource仅仅是相当于更改一个属性?
    AF.func("Calc", "");  
}
function OnEvent(){}
 </script> 
 </head> 
 <body> 
 <div id="main" style="position:relative;width:100%;height:380px"> 
   <script>insertReport('AF','FullScreen; Rebar=Print; print=11, 216,18;TabScrollBar=none;Border=none;LeftRulerWidthPercent=0')</script> <!--Rebar=Print;-->
 </div> 
 </body> 
</html> 

