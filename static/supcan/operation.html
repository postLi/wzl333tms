<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Stict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
  <link rel="stylesheet" type="text/css" href="untils/common.css" />
  <script src="binary/dynaload.js"></script>
  <script src="untils/common.js"></script>
  <script>
  var query = getUrlParams()
  var path = window.location.protocol + '//' + window.location.host
  function OnReady(id) {
    AF.func("Build", "report/operation.xml");

    //AF.func("SelectCell", "0\r\n0");
    //指定ds1数据源取数的URL地址 
    // var access_token ="be87c690-3ca0-4431-8f62-78cf268004e7";
    // var startTime = "2018-07-13 11:11:11";
    // var endTime = "2018-07-28 11:11:11";
    // var orgId = 1;
    // var selectType = 2;
    // var shipToCityName = "";
    // var businessType = "";

    // AF.func("SetSource", "ds1 \r\n http://localhost:7010/api-finance/finance/report/v1/findOperationReport?startTime="+startTime+"&endTime="+endTime+"&orgId="+orgId+"&selectType="+selectType+"&shipToCityName="+shipToCityName+"&businessType="+businessType+"&access_token="+access_token);  
    var url = path  +"/"+(localStorage.tms_testapiurl || 'api')+"/api-finance/finance/report/v1/findOperationReport" + query
    AF.func("SetSource", "ds1 \r\n "+ url);
    console.log(url)

    //需要重新计算， 因为SetSource仅仅是相当于更改一个属性?
    AF.func("Calc", "");
  }

  </script>
</head>

<body>
  <div id="main" style="position:relative;width:100%;height:380px">
    <script>
    // insertReport('AF', 'FullScreen;Rebar=Print; print=11, 216,18;PagesTabPercent=0;Border=none;LeftRulerWidthPercent=0;Ruler=none')
    insertReport('AF', 'FullScreen;PagesTabPercent=0;Border=none;LeftRulerWidthPercent=0;Rebar=none')
    // insertReport('AF', '')

    </script>
    <!--Rebar=Print; print=11, 216,18;TabScrollBar=none;Border=none;LeftRulerWidthPercent=0-->
  </div>
</body>

</html>
